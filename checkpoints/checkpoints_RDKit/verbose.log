Command line
python E:\BIT\codes\chemprop\AIE_ACQ\train.py
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 100,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'E:/BIT/codes/chemprop/data/AIE_ACQ/AIEACQ_train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'prc-auc', 'f1', 'mcc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.00017424185057835588,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0016475184132470895,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.00026550826157806045,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'prc-auc', 'f1', 'mcc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 4,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '20240424_checkpoints_RDKit_best_seed75',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 75,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'E:/BIT/codes/chemprop/data/AIE_ACQ/AIEACQ_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'cv-no-test',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 4.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 75
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.863723
Validation accuracy = 0.887850
Validation prc-auc = 0.932106
Validation f1 = 0.931034
Validation mcc = 0.684823
Epoch 1
Loss = 2.6516e-01, PNorm = 67.4538, GNorm = 0.3190, lr_0 = 1.1868e-03
Validation auc = 0.874169
Validation accuracy = 0.887850
Validation prc-auc = 0.937860
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 2
Loss = 3.4835e-01, PNorm = 68.0084, GNorm = 0.3455, lr_0 = 8.0296e-04
Validation auc = 0.878917
Validation accuracy = 0.897196
Validation prc-auc = 0.941172
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 3
Loss = 2.5794e-01, PNorm = 68.1770, GNorm = 0.3332, lr_0 = 3.8068e-04
Validation auc = 0.885090
Validation accuracy = 0.897196
Validation prc-auc = 0.944502
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 4
Loss = 2.1446e-01, PNorm = 68.2099, GNorm = 0.2599, lr_0 = 2.6218e-04
Validation auc = 0.889364
Validation accuracy = 0.897196
Validation prc-auc = 0.947047
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 5
Loss = 2.6147e-01, PNorm = 68.2264, GNorm = 0.4867, lr_0 = 2.5751e-04
Validation auc = 0.892688
Validation accuracy = 0.897196
Validation prc-auc = 0.948802
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 6
Loss = 2.4464e-01, PNorm = 68.2392, GNorm = 0.3939, lr_0 = 2.5246e-04
Validation auc = 0.895062
Validation accuracy = 0.897196
Validation prc-auc = 0.950787
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 7
Loss = 2.0054e-01, PNorm = 68.2515, GNorm = 0.2173, lr_0 = 2.4795e-04
Validation auc = 0.896486
Validation accuracy = 0.897196
Validation prc-auc = 0.949791
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 8
Loss = 2.1891e-01, PNorm = 68.2651, GNorm = 0.2442, lr_0 = 2.4309e-04
Validation auc = 0.896961
Validation accuracy = 0.878505
Validation prc-auc = 0.950789
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 9
Loss = 2.4292e-01, PNorm = 68.2765, GNorm = 0.4036, lr_0 = 2.3876e-04
Validation auc = 0.902184
Validation accuracy = 0.878505
Validation prc-auc = 0.953238
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 10
Loss = 1.8984e-01, PNorm = 68.2891, GNorm = 0.9285, lr_0 = 2.3450e-04
Validation auc = 0.904084
Validation accuracy = 0.906542
Validation prc-auc = 0.955249
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 11
Loss = 2.1393e-01, PNorm = 68.3018, GNorm = 0.4043, lr_0 = 2.2990e-04
Validation auc = 0.905508
Validation accuracy = 0.878505
Validation prc-auc = 0.955523
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 12
Loss = 2.4123e-01, PNorm = 68.3143, GNorm = 0.3018, lr_0 = 2.2580e-04
Validation auc = 0.906458
Validation accuracy = 0.906542
Validation prc-auc = 0.956777
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 13
Loss = 2.1539e-01, PNorm = 68.3282, GNorm = 1.5409, lr_0 = 2.2177e-04
Validation auc = 0.908357
Validation accuracy = 0.906542
Validation prc-auc = 0.956585
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 14
Loss = 2.1500e-01, PNorm = 68.3430, GNorm = 0.2783, lr_0 = 2.1742e-04
Validation auc = 0.910731
Validation accuracy = 0.906542
Validation prc-auc = 0.958304
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 15
Loss = 2.0230e-01, PNorm = 68.3572, GNorm = 0.3889, lr_0 = 2.1354e-04
Validation auc = 0.910731
Validation accuracy = 0.906542
Validation prc-auc = 0.958397
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 16
Loss = 2.1309e-01, PNorm = 68.3737, GNorm = 0.3130, lr_0 = 2.0936e-04
Validation auc = 0.910256
Validation accuracy = 0.915888
Validation prc-auc = 0.958435
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 17
Loss = 2.2070e-01, PNorm = 68.3865, GNorm = 1.1964, lr_0 = 2.0562e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.959964
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 18
Loss = 2.0542e-01, PNorm = 68.3993, GNorm = 0.2284, lr_0 = 2.0195e-04
Validation auc = 0.909307
Validation accuracy = 0.878505
Validation prc-auc = 0.958407
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 19
Loss = 2.1166e-01, PNorm = 68.4160, GNorm = 0.7595, lr_0 = 1.9800e-04
Validation auc = 0.912631
Validation accuracy = 0.915888
Validation prc-auc = 0.961214
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 20
Loss = 1.9237e-01, PNorm = 68.4315, GNorm = 1.0355, lr_0 = 1.9446e-04
Validation auc = 0.913580
Validation accuracy = 0.906542
Validation prc-auc = 0.961469
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 21
Loss = 2.0432e-01, PNorm = 68.4458, GNorm = 0.6273, lr_0 = 1.9099e-04
Validation auc = 0.913580
Validation accuracy = 0.915888
Validation prc-auc = 0.961746
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 22
Loss = 1.9134e-01, PNorm = 68.4637, GNorm = 1.0321, lr_0 = 1.8725e-04
Validation auc = 0.912156
Validation accuracy = 0.915888
Validation prc-auc = 0.960623
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 23
Loss = 1.8108e-01, PNorm = 68.4771, GNorm = 0.5488, lr_0 = 1.8391e-04
Loss = 1.9021e-01, PNorm = 68.4786, GNorm = 0.7260, lr_0 = 1.8358e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.960732
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 24
Loss = 1.8403e-01, PNorm = 68.4931, GNorm = 1.0447, lr_0 = 1.8030e-04
Validation auc = 0.909782
Validation accuracy = 0.897196
Validation prc-auc = 0.960233
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 25
Loss = 1.9357e-01, PNorm = 68.5082, GNorm = 1.2130, lr_0 = 1.7709e-04
Validation auc = 0.910256
Validation accuracy = 0.906542
Validation prc-auc = 0.962558
Validation f1 = 0.941860
Validation mcc = 0.740108
Epoch 26
Validation auc = 0.915954
Validation accuracy = 0.915888
Validation prc-auc = 0.965394
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 27
Loss = 1.2156e-01, PNorm = 68.5235, GNorm = 0.3908, lr_0 = 1.7424e-04
Validation auc = 0.914530
Validation accuracy = 0.906542
Validation prc-auc = 0.965010
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 28
Loss = 1.4426e-01, PNorm = 68.5382, GNorm = 0.5806, lr_0 = 1.7424e-04
Validation auc = 0.915954
Validation accuracy = 0.906542
Validation prc-auc = 0.966835
Validation f1 = 0.941860
Validation mcc = 0.740108
Epoch 29
Loss = 1.4312e-01, PNorm = 68.5553, GNorm = 0.7903, lr_0 = 1.7424e-04
Validation auc = 0.916429
Validation accuracy = 0.906542
Validation prc-auc = 0.966531
Validation f1 = 0.941176
Validation mcc = 0.735521
Model 0 best validation auc = 0.916429 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.989362
Model 0 test accuracy = 0.983333
Model 0 test prc-auc = 0.996899
Model 0 test f1 = 0.989474
Model 0 test mcc = 0.950708
Ensemble test auc = 0.989362
Ensemble test accuracy = 0.983333
Ensemble test prc-auc = 0.996899
Ensemble test f1 = 0.989474
Ensemble test mcc = 0.950708
Fold 1
Splitting data with seed 76
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.888426
Validation accuracy = 0.897196
Validation prc-auc = 0.944040
Validation f1 = 0.935673
Validation mcc = 0.721776
Epoch 1
Loss = 2.0379e-01, PNorm = 67.4542, GNorm = 0.3150, lr_0 = 1.1868e-03
Validation auc = 0.902778
Validation accuracy = 0.915888
Validation prc-auc = 0.955899
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 2
Loss = 1.3211e-01, PNorm = 68.0093, GNorm = 0.4931, lr_0 = 8.0296e-04
Validation auc = 0.915278
Validation accuracy = 0.915888
Validation prc-auc = 0.962380
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 3
Loss = 2.5437e-01, PNorm = 68.1761, GNorm = 0.2096, lr_0 = 3.8068e-04
Validation auc = 0.919907
Validation accuracy = 0.915888
Validation prc-auc = 0.965094
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 4
Loss = 2.9696e-01, PNorm = 68.2071, GNorm = 0.2480, lr_0 = 2.6218e-04
Validation auc = 0.926389
Validation accuracy = 0.925234
Validation prc-auc = 0.968141
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 5
Loss = 2.7615e-01, PNorm = 68.2227, GNorm = 0.2461, lr_0 = 2.5751e-04
Validation auc = 0.933333
Validation accuracy = 0.915888
Validation prc-auc = 0.972024
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 6
Loss = 2.3396e-01, PNorm = 68.2364, GNorm = 0.3993, lr_0 = 2.5246e-04
Validation auc = 0.934259
Validation accuracy = 0.915888
Validation prc-auc = 0.972309
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 7
Loss = 2.3848e-01, PNorm = 68.2466, GNorm = 0.4017, lr_0 = 2.4795e-04
Validation auc = 0.940741
Validation accuracy = 0.915888
Validation prc-auc = 0.975670
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 8
Loss = 2.0741e-01, PNorm = 68.2589, GNorm = 0.3133, lr_0 = 2.4309e-04
Validation auc = 0.943519
Validation accuracy = 0.925234
Validation prc-auc = 0.976525
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 9
Loss = 2.2927e-01, PNorm = 68.2707, GNorm = 0.2912, lr_0 = 2.3876e-04
Validation auc = 0.946296
Validation accuracy = 0.925234
Validation prc-auc = 0.977437
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 10
Loss = 2.5684e-01, PNorm = 68.2827, GNorm = 0.2077, lr_0 = 2.3450e-04
Validation auc = 0.948611
Validation accuracy = 0.897196
Validation prc-auc = 0.979162
Validation f1 = 0.932515
Validation mcc = 0.719279
Epoch 11
Loss = 2.3555e-01, PNorm = 68.2984, GNorm = 0.2637, lr_0 = 2.2990e-04
Validation auc = 0.947222
Validation accuracy = 0.906542
Validation prc-auc = 0.977306
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 12
Loss = 2.4325e-01, PNorm = 68.3112, GNorm = 0.9657, lr_0 = 2.2580e-04
Validation auc = 0.950463
Validation accuracy = 0.906542
Validation prc-auc = 0.980111
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 13
Loss = 2.3288e-01, PNorm = 68.3238, GNorm = 0.4754, lr_0 = 2.2177e-04
Validation auc = 0.950463
Validation accuracy = 0.934579
Validation prc-auc = 0.979065
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 14
Loss = 2.1380e-01, PNorm = 68.3404, GNorm = 0.2293, lr_0 = 2.1742e-04
Validation auc = 0.952778
Validation accuracy = 0.906542
Validation prc-auc = 0.980269
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 15
Loss = 2.1883e-01, PNorm = 68.3558, GNorm = 0.3251, lr_0 = 2.1354e-04
Validation auc = 0.953704
Validation accuracy = 0.906542
Validation prc-auc = 0.980785
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 16
Loss = 2.3133e-01, PNorm = 68.3727, GNorm = 0.7771, lr_0 = 2.0936e-04
Validation auc = 0.954630
Validation accuracy = 0.915888
Validation prc-auc = 0.981950
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 17
Loss = 2.1194e-01, PNorm = 68.3884, GNorm = 0.8939, lr_0 = 2.0562e-04
Validation auc = 0.953704
Validation accuracy = 0.915888
Validation prc-auc = 0.981799
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 18
Loss = 2.0433e-01, PNorm = 68.4034, GNorm = 0.3590, lr_0 = 2.0195e-04
Validation auc = 0.954167
Validation accuracy = 0.906542
Validation prc-auc = 0.982024
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 19
Loss = 2.1323e-01, PNorm = 68.4211, GNorm = 0.6950, lr_0 = 1.9800e-04
Validation auc = 0.952315
Validation accuracy = 0.906542
Validation prc-auc = 0.980185
Validation f1 = 0.939759
Validation mcc = 0.742247
Epoch 20
Loss = 2.1621e-01, PNorm = 68.4368, GNorm = 1.0230, lr_0 = 1.9446e-04
Validation auc = 0.957870
Validation accuracy = 0.906542
Validation prc-auc = 0.983578
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 21
Loss = 2.1505e-01, PNorm = 68.4517, GNorm = 0.7864, lr_0 = 1.9099e-04
Validation auc = 0.954630
Validation accuracy = 0.915888
Validation prc-auc = 0.982473
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 22
Loss = 1.9390e-01, PNorm = 68.4687, GNorm = 0.8070, lr_0 = 1.8725e-04
Validation auc = 0.956944
Validation accuracy = 0.906542
Validation prc-auc = 0.982589
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 23
Loss = 1.9452e-01, PNorm = 68.4852, GNorm = 0.3978, lr_0 = 1.8391e-04
Loss = 1.8500e-01, PNorm = 68.4869, GNorm = 1.5806, lr_0 = 1.8358e-04
Validation auc = 0.956481
Validation accuracy = 0.915888
Validation prc-auc = 0.982447
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 24
Loss = 1.9141e-01, PNorm = 68.5044, GNorm = 0.3949, lr_0 = 1.8030e-04
Validation auc = 0.956481
Validation accuracy = 0.915888
Validation prc-auc = 0.983154
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 25
Loss = 1.9449e-01, PNorm = 68.5220, GNorm = 0.4090, lr_0 = 1.7709e-04
Validation auc = 0.956944
Validation accuracy = 0.897196
Validation prc-auc = 0.983068
Validation f1 = 0.934132
Validation mcc = 0.714927
Epoch 26
Validation auc = 0.957407
Validation accuracy = 0.915888
Validation prc-auc = 0.983776
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 27
Loss = 1.6661e-01, PNorm = 68.5393, GNorm = 0.4052, lr_0 = 1.7424e-04
Validation auc = 0.955556
Validation accuracy = 0.915888
Validation prc-auc = 0.982799
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 28
Loss = 3.3293e-01, PNorm = 68.5567, GNorm = 1.2223, lr_0 = 1.7424e-04
Validation auc = 0.955093
Validation accuracy = 0.897196
Validation prc-auc = 0.982110
Validation f1 = 0.933333
Validation mcc = 0.716000
Epoch 29
Loss = 1.7290e-01, PNorm = 68.5761, GNorm = 0.2943, lr_0 = 1.7424e-04
Validation auc = 0.955556
Validation accuracy = 0.906542
Validation prc-auc = 0.982659
Validation f1 = 0.939024
Validation mcc = 0.743579
Model 0 best validation auc = 0.957870 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.992226
Model 0 test accuracy = 0.950000
Model 0 test prc-auc = 0.997793
Model 0 test f1 = 0.969072
Model 0 test mcc = 0.850339
Ensemble test auc = 0.992226
Ensemble test accuracy = 0.950000
Ensemble test prc-auc = 0.997793
Ensemble test f1 = 0.969072
Ensemble test mcc = 0.850339
Fold 2
Splitting data with seed 77
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.872647
Validation accuracy = 0.915888
Validation prc-auc = 0.954167
Validation f1 = 0.949721
Validation mcc = 0.715389
Epoch 1
Loss = 3.0596e-01, PNorm = 67.4416, GNorm = 0.2801, lr_0 = 1.1868e-03
Validation auc = 0.879291
Validation accuracy = 0.906542
Validation prc-auc = 0.957139
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 2
Loss = 1.9433e-01, PNorm = 67.9900, GNorm = 0.3643, lr_0 = 8.0296e-04
Validation auc = 0.883167
Validation accuracy = 0.906542
Validation prc-auc = 0.957460
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 3
Loss = 2.4462e-01, PNorm = 68.1577, GNorm = 0.3069, lr_0 = 3.8068e-04
Validation auc = 0.882060
Validation accuracy = 0.906542
Validation prc-auc = 0.955573
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 4
Loss = 2.5730e-01, PNorm = 68.1892, GNorm = 0.2337, lr_0 = 2.6218e-04
Validation auc = 0.887597
Validation accuracy = 0.925234
Validation prc-auc = 0.957812
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 5
Loss = 3.0011e-01, PNorm = 68.2052, GNorm = 0.2184, lr_0 = 2.5751e-04
Validation auc = 0.890919
Validation accuracy = 0.925234
Validation prc-auc = 0.957976
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 6
Loss = 2.6132e-01, PNorm = 68.2187, GNorm = 0.4319, lr_0 = 2.5246e-04
Validation auc = 0.897010
Validation accuracy = 0.925234
Validation prc-auc = 0.959651
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 7
Loss = 2.4193e-01, PNorm = 68.2302, GNorm = 0.4694, lr_0 = 2.4795e-04
Validation auc = 0.899225
Validation accuracy = 0.915888
Validation prc-auc = 0.960835
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 8
Loss = 2.0391e-01, PNorm = 68.2430, GNorm = 0.2077, lr_0 = 2.4309e-04
Validation auc = 0.900886
Validation accuracy = 0.915888
Validation prc-auc = 0.961282
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 9
Loss = 2.9087e-01, PNorm = 68.2547, GNorm = 0.2492, lr_0 = 2.3876e-04
Validation auc = 0.901440
Validation accuracy = 0.925234
Validation prc-auc = 0.961733
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 10
Loss = 2.4130e-01, PNorm = 68.2657, GNorm = 0.2733, lr_0 = 2.3450e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.960567
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 11
Loss = 2.7048e-01, PNorm = 68.2796, GNorm = 0.3275, lr_0 = 2.2990e-04
Validation auc = 0.898671
Validation accuracy = 0.925234
Validation prc-auc = 0.959295
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 12
Loss = 2.2774e-01, PNorm = 68.2933, GNorm = 0.4299, lr_0 = 2.2580e-04
Validation auc = 0.905316
Validation accuracy = 0.915888
Validation prc-auc = 0.962697
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 13
Loss = 2.4723e-01, PNorm = 68.3085, GNorm = 0.3265, lr_0 = 2.2177e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.960383
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 14
Loss = 2.3369e-01, PNorm = 68.3238, GNorm = 0.3802, lr_0 = 2.1742e-04
Validation auc = 0.903101
Validation accuracy = 0.934579
Validation prc-auc = 0.961062
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 15
Loss = 2.2589e-01, PNorm = 68.3399, GNorm = 0.2655, lr_0 = 2.1354e-04
Validation auc = 0.904208
Validation accuracy = 0.925234
Validation prc-auc = 0.961089
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 16
Loss = 2.0754e-01, PNorm = 68.3565, GNorm = 0.3457, lr_0 = 2.0936e-04
Validation auc = 0.906977
Validation accuracy = 0.934579
Validation prc-auc = 0.963149
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 17
Loss = 2.1674e-01, PNorm = 68.3722, GNorm = 0.7638, lr_0 = 2.0562e-04
Validation auc = 0.905316
Validation accuracy = 0.934579
Validation prc-auc = 0.962093
Validation f1 = 0.960000
Validation mcc = 0.784270
Epoch 18
Loss = 2.1041e-01, PNorm = 68.3864, GNorm = 0.4465, lr_0 = 2.0195e-04
Validation auc = 0.905869
Validation accuracy = 0.953271
Validation prc-auc = 0.961926
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 19
Loss = 2.1745e-01, PNorm = 68.4026, GNorm = 0.3005, lr_0 = 1.9800e-04
Validation auc = 0.907530
Validation accuracy = 0.943925
Validation prc-auc = 0.963335
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 20
Loss = 1.9862e-01, PNorm = 68.4186, GNorm = 0.3457, lr_0 = 1.9446e-04
Validation auc = 0.906977
Validation accuracy = 0.943925
Validation prc-auc = 0.963216
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 21
Loss = 2.1507e-01, PNorm = 68.4325, GNorm = 0.9769, lr_0 = 1.9099e-04
Validation auc = 0.910299
Validation accuracy = 0.943925
Validation prc-auc = 0.965411
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 22
Loss = 2.0461e-01, PNorm = 68.4500, GNorm = 0.3752, lr_0 = 1.8725e-04
Validation auc = 0.910853
Validation accuracy = 0.953271
Validation prc-auc = 0.964937
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 23
Loss = 1.9615e-01, PNorm = 68.4670, GNorm = 0.8995, lr_0 = 1.8391e-04
Loss = 1.0213e-01, PNorm = 68.4687, GNorm = 0.3310, lr_0 = 1.8358e-04
Validation auc = 0.913068
Validation accuracy = 0.943925
Validation prc-auc = 0.965209
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 24
Loss = 2.0195e-01, PNorm = 68.4844, GNorm = 0.3647, lr_0 = 1.8030e-04
Validation auc = 0.913068
Validation accuracy = 0.953271
Validation prc-auc = 0.966364
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 25
Loss = 2.0256e-01, PNorm = 68.5002, GNorm = 0.3146, lr_0 = 1.7709e-04
Validation auc = 0.915282
Validation accuracy = 0.953271
Validation prc-auc = 0.967533
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 26
Validation auc = 0.915836
Validation accuracy = 0.943925
Validation prc-auc = 0.967537
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 27
Loss = 2.0974e-01, PNorm = 68.5187, GNorm = 0.3057, lr_0 = 1.7424e-04
Validation auc = 0.914729
Validation accuracy = 0.953271
Validation prc-auc = 0.967842
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 28
Loss = 9.7906e-02, PNorm = 68.5360, GNorm = 0.2623, lr_0 = 1.7424e-04
Validation auc = 0.916390
Validation accuracy = 0.943925
Validation prc-auc = 0.967664
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 29
Loss = 2.2210e-01, PNorm = 68.5561, GNorm = 0.4067, lr_0 = 1.7424e-04
Validation auc = 0.916944
Validation accuracy = 0.962617
Validation prc-auc = 0.969008
Validation f1 = 0.977011
Validation mcc = 0.878743
Model 0 best validation auc = 0.916944 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.989362
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.996867
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Ensemble test auc = 0.989362
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.996867
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 3
Splitting data with seed 78
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 963 | val size = 106 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.943605
Validation accuracy = 0.962264
Validation prc-auc = 0.982408
Validation f1 = 0.977273
Validation mcc = 0.874325
Epoch 1
Loss = 3.6244e-01, PNorm = 67.4593, GNorm = 0.2583, lr_0 = 1.1868e-03
Validation auc = 0.940116
Validation accuracy = 0.952830
Validation prc-auc = 0.981235
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 2
Loss = 4.1194e-01, PNorm = 68.0198, GNorm = 0.4513, lr_0 = 8.0296e-04
Validation auc = 0.941860
Validation accuracy = 0.952830
Validation prc-auc = 0.981135
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 3
Loss = 2.3413e-01, PNorm = 68.1914, GNorm = 0.2959, lr_0 = 3.8068e-04
Validation auc = 0.940698
Validation accuracy = 0.952830
Validation prc-auc = 0.980562
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 4
Loss = 3.2121e-01, PNorm = 68.2250, GNorm = 0.3440, lr_0 = 2.6218e-04
Validation auc = 0.940698
Validation accuracy = 0.952830
Validation prc-auc = 0.979698
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 5
Loss = 2.4525e-01, PNorm = 68.2412, GNorm = 0.5622, lr_0 = 2.5751e-04
Validation auc = 0.938372
Validation accuracy = 0.943396
Validation prc-auc = 0.977474
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 6
Loss = 3.0214e-01, PNorm = 68.2558, GNorm = 0.2774, lr_0 = 2.5246e-04
Validation auc = 0.942442
Validation accuracy = 0.952830
Validation prc-auc = 0.978692
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 7
Loss = 2.7021e-01, PNorm = 68.2683, GNorm = 0.2483, lr_0 = 2.4795e-04
Validation auc = 0.943023
Validation accuracy = 0.952830
Validation prc-auc = 0.977572
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 8
Loss = 2.8726e-01, PNorm = 68.2818, GNorm = 0.2570, lr_0 = 2.4353e-04
Validation auc = 0.945349
Validation accuracy = 0.943396
Validation prc-auc = 0.977136
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 9
Loss = 2.5129e-01, PNorm = 68.2974, GNorm = 0.3922, lr_0 = 2.3876e-04
Validation auc = 0.944186
Validation accuracy = 0.943396
Validation prc-auc = 0.975641
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 10
Loss = 2.5984e-01, PNorm = 68.3114, GNorm = 0.3880, lr_0 = 2.3450e-04
Validation auc = 0.946512
Validation accuracy = 0.962264
Validation prc-auc = 0.976818
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 11
Loss = 2.2916e-01, PNorm = 68.3262, GNorm = 0.4525, lr_0 = 2.2990e-04
Validation auc = 0.946512
Validation accuracy = 0.943396
Validation prc-auc = 0.976178
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 12
Loss = 2.2270e-01, PNorm = 68.3392, GNorm = 0.4535, lr_0 = 2.2580e-04
Validation auc = 0.946512
Validation accuracy = 0.943396
Validation prc-auc = 0.975436
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 13
Loss = 2.3070e-01, PNorm = 68.3528, GNorm = 0.3002, lr_0 = 2.2177e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.975982
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 14
Loss = 2.3209e-01, PNorm = 68.3694, GNorm = 0.4767, lr_0 = 2.1742e-04
Validation auc = 0.948256
Validation accuracy = 0.943396
Validation prc-auc = 0.975035
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 15
Loss = 1.9908e-01, PNorm = 68.3863, GNorm = 1.1660, lr_0 = 2.1354e-04
Validation auc = 0.946512
Validation accuracy = 0.943396
Validation prc-auc = 0.972762
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 16
Loss = 2.2570e-01, PNorm = 68.3980, GNorm = 0.6681, lr_0 = 2.0974e-04
Validation auc = 0.946512
Validation accuracy = 0.943396
Validation prc-auc = 0.972762
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 17
Loss = 2.2337e-01, PNorm = 68.4151, GNorm = 0.7665, lr_0 = 2.0562e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.973174
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 18
Loss = 2.1912e-01, PNorm = 68.4290, GNorm = 0.6975, lr_0 = 2.0195e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.972912
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 19
Loss = 2.1214e-01, PNorm = 68.4469, GNorm = 0.5254, lr_0 = 1.9800e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.973872
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 20
Loss = 2.0719e-01, PNorm = 68.4663, GNorm = 0.9530, lr_0 = 1.9446e-04
Validation auc = 0.947093
Validation accuracy = 0.943396
Validation prc-auc = 0.971833
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 21
Loss = 1.9026e-01, PNorm = 68.4790, GNorm = 0.2662, lr_0 = 1.9099e-04
Validation auc = 0.946512
Validation accuracy = 0.962264
Validation prc-auc = 0.970460
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 22
Loss = 2.0726e-01, PNorm = 68.4963, GNorm = 0.3934, lr_0 = 1.8725e-04
Validation auc = 0.946512
Validation accuracy = 0.962264
Validation prc-auc = 0.972718
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 23
Loss = 2.0762e-01, PNorm = 68.5125, GNorm = 0.5894, lr_0 = 1.8391e-04
Validation auc = 0.947674
Validation accuracy = 0.962264
Validation prc-auc = 0.973044
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 24
Loss = 1.9365e-01, PNorm = 68.5300, GNorm = 1.7157, lr_0 = 1.8063e-04
Loss = 2.7583e-01, PNorm = 68.5315, GNorm = 1.6817, lr_0 = 1.8030e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.972912
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 25
Loss = 2.0018e-01, PNorm = 68.5481, GNorm = 0.8335, lr_0 = 1.7709e-04
Validation auc = 0.949419
Validation accuracy = 0.962264
Validation prc-auc = 0.975315
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 26
Loss = 1.9814e-01, PNorm = 68.5620, GNorm = 0.4928, lr_0 = 1.7424e-04
Validation auc = 0.947674
Validation accuracy = 0.952830
Validation prc-auc = 0.971979
Validation f1 = 0.970760
Validation mcc = 0.849219
Epoch 27
Validation auc = 0.949419
Validation accuracy = 0.962264
Validation prc-auc = 0.974448
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 28
Loss = 1.8060e-01, PNorm = 68.5786, GNorm = 0.8485, lr_0 = 1.7424e-04
Validation auc = 0.947674
Validation accuracy = 0.962264
Validation prc-auc = 0.973074
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 29
Loss = 2.1653e-01, PNorm = 68.5971, GNorm = 0.3936, lr_0 = 1.7424e-04
Validation auc = 0.950000
Validation accuracy = 0.952830
Validation prc-auc = 0.972527
Validation f1 = 0.970760
Validation mcc = 0.849219
Model 0 best validation auc = 0.950000 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.990998
Model 0 test accuracy = 0.975000
Model 0 test prc-auc = 0.997399
Model 0 test f1 = 0.984127
Model 0 test mcc = 0.925598
Ensemble test auc = 0.990998
Ensemble test accuracy = 0.975000
Ensemble test prc-auc = 0.997399
Ensemble test f1 = 0.984127
Ensemble test mcc = 0.925598
Fold 4
Splitting data with seed 79
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.863872
Validation accuracy = 0.906542
Validation prc-auc = 0.947336
Validation f1 = 0.943820
Validation mcc = 0.710695
Epoch 1
Loss = 3.4317e-01, PNorm = 67.4559, GNorm = 0.3055, lr_0 = 1.1868e-03
Validation auc = 0.860766
Validation accuracy = 0.878505
Validation prc-auc = 0.943560
Validation f1 = 0.923077
Validation mcc = 0.634487
Epoch 2
Loss = 2.7402e-01, PNorm = 68.0134, GNorm = 0.2964, lr_0 = 8.0296e-04
Validation auc = 0.864389
Validation accuracy = 0.906542
Validation prc-auc = 0.946627
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 3
Loss = 2.4789e-01, PNorm = 68.1854, GNorm = 0.2649, lr_0 = 3.8068e-04
Validation auc = 0.859213
Validation accuracy = 0.906542
Validation prc-auc = 0.944326
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 4
Loss = 2.6175e-01, PNorm = 68.2184, GNorm = 0.2220, lr_0 = 2.6218e-04
Validation auc = 0.859213
Validation accuracy = 0.906542
Validation prc-auc = 0.944578
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 5
Loss = 2.5866e-01, PNorm = 68.2343, GNorm = 0.3267, lr_0 = 2.5751e-04
Validation auc = 0.858178
Validation accuracy = 0.897196
Validation prc-auc = 0.944428
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 6
Loss = 2.6503e-01, PNorm = 68.2476, GNorm = 0.3835, lr_0 = 2.5246e-04
Validation auc = 0.857660
Validation accuracy = 0.897196
Validation prc-auc = 0.943385
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 7
Loss = 2.3158e-01, PNorm = 68.2593, GNorm = 0.3581, lr_0 = 2.4795e-04
Validation auc = 0.858178
Validation accuracy = 0.906542
Validation prc-auc = 0.942641
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 8
Loss = 1.9745e-01, PNorm = 68.2727, GNorm = 0.2157, lr_0 = 2.4309e-04
Validation auc = 0.860248
Validation accuracy = 0.897196
Validation prc-auc = 0.945034
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 9
Loss = 2.6703e-01, PNorm = 68.2861, GNorm = 0.2195, lr_0 = 2.3876e-04
Validation auc = 0.865424
Validation accuracy = 0.915888
Validation prc-auc = 0.946286
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 10
Loss = 2.2552e-01, PNorm = 68.2995, GNorm = 0.6978, lr_0 = 2.3450e-04
Validation auc = 0.858696
Validation accuracy = 0.897196
Validation prc-auc = 0.941521
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 11
Loss = 2.2305e-01, PNorm = 68.3147, GNorm = 0.8389, lr_0 = 2.2990e-04
Validation auc = 0.853520
Validation accuracy = 0.887850
Validation prc-auc = 0.939470
Validation f1 = 0.928571
Validation mcc = 0.667702
Epoch 12
Loss = 1.8411e-01, PNorm = 68.3276, GNorm = 0.2659, lr_0 = 2.2580e-04
Validation auc = 0.863354
Validation accuracy = 0.897196
Validation prc-auc = 0.944151
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 13
Loss = 1.9601e-01, PNorm = 68.3403, GNorm = 0.3527, lr_0 = 2.2177e-04
Validation auc = 0.862319
Validation accuracy = 0.897196
Validation prc-auc = 0.946049
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 14
Loss = 2.1119e-01, PNorm = 68.3541, GNorm = 0.2396, lr_0 = 2.1742e-04
Validation auc = 0.862836
Validation accuracy = 0.897196
Validation prc-auc = 0.945670
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 15
Loss = 2.0243e-01, PNorm = 68.3688, GNorm = 0.5089, lr_0 = 2.1354e-04
Validation auc = 0.861801
Validation accuracy = 0.897196
Validation prc-auc = 0.944505
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 16
Loss = 2.1088e-01, PNorm = 68.3864, GNorm = 0.4007, lr_0 = 2.0936e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.944457
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 17
Loss = 1.9387e-01, PNorm = 68.4016, GNorm = 0.2116, lr_0 = 2.0562e-04
Validation auc = 0.860248
Validation accuracy = 0.906542
Validation prc-auc = 0.942548
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 18
Loss = 1.8974e-01, PNorm = 68.4164, GNorm = 0.2996, lr_0 = 2.0195e-04
Validation auc = 0.861284
Validation accuracy = 0.897196
Validation prc-auc = 0.942547
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 19
Loss = 1.8403e-01, PNorm = 68.4330, GNorm = 0.3756, lr_0 = 1.9800e-04
Validation auc = 0.861284
Validation accuracy = 0.897196
Validation prc-auc = 0.942949
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 20
Loss = 1.9003e-01, PNorm = 68.4468, GNorm = 0.2759, lr_0 = 1.9446e-04
Validation auc = 0.862319
Validation accuracy = 0.906542
Validation prc-auc = 0.943821
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 21
Loss = 2.0451e-01, PNorm = 68.4620, GNorm = 2.3492, lr_0 = 1.9099e-04
Validation auc = 0.865424
Validation accuracy = 0.906542
Validation prc-auc = 0.945028
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 22
Loss = 1.9314e-01, PNorm = 68.4772, GNorm = 0.8246, lr_0 = 1.8725e-04
Validation auc = 0.866460
Validation accuracy = 0.915888
Validation prc-auc = 0.946996
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 23
Loss = 1.8893e-01, PNorm = 68.4923, GNorm = 1.5460, lr_0 = 1.8391e-04
Loss = 2.9831e-01, PNorm = 68.4938, GNorm = 0.3437, lr_0 = 1.8358e-04
Validation auc = 0.865942
Validation accuracy = 0.897196
Validation prc-auc = 0.946808
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 24
Loss = 1.9190e-01, PNorm = 68.5095, GNorm = 1.0362, lr_0 = 1.8030e-04
Validation auc = 0.865942
Validation accuracy = 0.906542
Validation prc-auc = 0.946270
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 25
Loss = 1.8713e-01, PNorm = 68.5276, GNorm = 0.8304, lr_0 = 1.7709e-04
Validation auc = 0.857143
Validation accuracy = 0.897196
Validation prc-auc = 0.943037
Validation f1 = 0.934911
Validation mcc = 0.690781
Epoch 26
Validation auc = 0.866977
Validation accuracy = 0.915888
Validation prc-auc = 0.946682
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 27
Loss = 1.6890e-01, PNorm = 68.5455, GNorm = 1.1654, lr_0 = 1.7424e-04
Validation auc = 0.864389
Validation accuracy = 0.906542
Validation prc-auc = 0.945995
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 28
Loss = 2.4565e-01, PNorm = 68.5613, GNorm = 0.7903, lr_0 = 1.7424e-04
Validation auc = 0.863872
Validation accuracy = 0.906542
Validation prc-auc = 0.945028
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 29
Loss = 1.7687e-01, PNorm = 68.5807, GNorm = 0.2632, lr_0 = 1.7424e-04
Validation auc = 0.859731
Validation accuracy = 0.906542
Validation prc-auc = 0.943185
Validation f1 = 0.942529
Validation mcc = 0.706105
Model 0 best validation auc = 0.866977 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.985679
Model 0 test accuracy = 0.950000
Model 0 test prc-auc = 0.995704
Model 0 test f1 = 0.969072
Model 0 test mcc = 0.850339
Ensemble test auc = 0.985679
Ensemble test accuracy = 0.950000
Ensemble test prc-auc = 0.995704
Ensemble test f1 = 0.969072
Ensemble test mcc = 0.850339
Fold 5
Splitting data with seed 80
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.941307
Validation accuracy = 0.887850
Validation prc-auc = 0.965632
Validation f1 = 0.934783
Validation mcc = 0.613264
Epoch 1
Loss = 4.2120e-01, PNorm = 67.4428, GNorm = 0.5500, lr_0 = 1.1868e-03
Validation auc = 0.949059
Validation accuracy = 0.934579
Validation prc-auc = 0.978231
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 2
Loss = 2.7477e-01, PNorm = 67.9953, GNorm = 0.2304, lr_0 = 8.0296e-04
Validation auc = 0.953488
Validation accuracy = 0.953271
Validation prc-auc = 0.980255
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 3
Loss = 2.7223e-01, PNorm = 68.1649, GNorm = 0.4536, lr_0 = 3.8068e-04
Validation auc = 0.955703
Validation accuracy = 0.953271
Validation prc-auc = 0.981673
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 4
Loss = 2.5300e-01, PNorm = 68.1967, GNorm = 0.3021, lr_0 = 2.6218e-04
Validation auc = 0.959025
Validation accuracy = 0.953271
Validation prc-auc = 0.984284
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 5
Loss = 2.1183e-01, PNorm = 68.2130, GNorm = 0.4315, lr_0 = 2.5751e-04
Validation auc = 0.962901
Validation accuracy = 0.953271
Validation prc-auc = 0.986320
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 6
Loss = 2.6027e-01, PNorm = 68.2259, GNorm = 0.1918, lr_0 = 2.5246e-04
Validation auc = 0.966224
Validation accuracy = 0.953271
Validation prc-auc = 0.988233
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 7
Loss = 2.2542e-01, PNorm = 68.2372, GNorm = 0.3953, lr_0 = 2.4795e-04
Validation auc = 0.967331
Validation accuracy = 0.953271
Validation prc-auc = 0.989058
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 8
Loss = 2.3657e-01, PNorm = 68.2512, GNorm = 0.2633, lr_0 = 2.4309e-04
Validation auc = 0.970100
Validation accuracy = 0.953271
Validation prc-auc = 0.990051
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 9
Loss = 2.1554e-01, PNorm = 68.2645, GNorm = 0.3060, lr_0 = 2.3876e-04
Validation auc = 0.975637
Validation accuracy = 0.953271
Validation prc-auc = 0.992542
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 10
Loss = 2.4789e-01, PNorm = 68.2764, GNorm = 0.2628, lr_0 = 2.3450e-04
Validation auc = 0.972868
Validation accuracy = 0.962617
Validation prc-auc = 0.991779
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 11
Loss = 2.4651e-01, PNorm = 68.2914, GNorm = 0.6855, lr_0 = 2.2990e-04
Validation auc = 0.976744
Validation accuracy = 0.943925
Validation prc-auc = 0.993293
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 12
Loss = 2.4445e-01, PNorm = 68.3060, GNorm = 0.7202, lr_0 = 2.2580e-04
Validation auc = 0.979513
Validation accuracy = 0.943925
Validation prc-auc = 0.994254
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 13
Loss = 2.3267e-01, PNorm = 68.3210, GNorm = 0.3722, lr_0 = 2.2177e-04
Validation auc = 0.980066
Validation accuracy = 0.971963
Validation prc-auc = 0.994374
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 14
Loss = 2.5821e-01, PNorm = 68.3359, GNorm = 0.3473, lr_0 = 2.1742e-04
Validation auc = 0.981728
Validation accuracy = 0.971963
Validation prc-auc = 0.994960
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 15
Loss = 2.1289e-01, PNorm = 68.3500, GNorm = 0.4593, lr_0 = 2.1354e-04
Validation auc = 0.986157
Validation accuracy = 0.953271
Validation prc-auc = 0.996322
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 16
Loss = 2.1417e-01, PNorm = 68.3664, GNorm = 0.9063, lr_0 = 2.0936e-04
Validation auc = 0.977298
Validation accuracy = 0.953271
Validation prc-auc = 0.993485
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 17
Loss = 2.1432e-01, PNorm = 68.3810, GNorm = 0.4023, lr_0 = 2.0562e-04
Validation auc = 0.986157
Validation accuracy = 0.943925
Validation prc-auc = 0.996360
Validation f1 = 0.964286
Validation mcc = 0.839338
Epoch 18
Loss = 2.0599e-01, PNorm = 68.3981, GNorm = 0.3500, lr_0 = 2.0195e-04
Validation auc = 0.984496
Validation accuracy = 0.953271
Validation prc-auc = 0.995907
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 19
Loss = 2.2124e-01, PNorm = 68.4159, GNorm = 0.3859, lr_0 = 1.9800e-04
Validation auc = 0.984496
Validation accuracy = 0.962617
Validation prc-auc = 0.995940
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 20
Loss = 2.1145e-01, PNorm = 68.4299, GNorm = 0.4442, lr_0 = 1.9446e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.996980
Validation f1 = 0.976471
Validation mcc = 0.887074
Epoch 21
Loss = 2.1739e-01, PNorm = 68.4461, GNorm = 0.3301, lr_0 = 1.9099e-04
Validation auc = 0.982835
Validation accuracy = 0.953271
Validation prc-auc = 0.995500
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 22
Loss = 2.0966e-01, PNorm = 68.4628, GNorm = 0.2208, lr_0 = 1.8725e-04
Validation auc = 0.988372
Validation accuracy = 0.953271
Validation prc-auc = 0.997011
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 23
Loss = 2.0217e-01, PNorm = 68.4792, GNorm = 0.4290, lr_0 = 1.8391e-04
Loss = 1.9101e-01, PNorm = 68.4809, GNorm = 0.3049, lr_0 = 1.8358e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.997042
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 24
Loss = 2.0057e-01, PNorm = 68.4979, GNorm = 0.3327, lr_0 = 1.8030e-04
Validation auc = 0.984496
Validation accuracy = 0.962617
Validation prc-auc = 0.996037
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 25
Loss = 2.0246e-01, PNorm = 68.5153, GNorm = 0.3776, lr_0 = 1.7709e-04
Validation auc = 0.989480
Validation accuracy = 0.943925
Validation prc-auc = 0.997325
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 26
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.997048
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 27
Loss = 2.4523e-01, PNorm = 68.5341, GNorm = 0.4648, lr_0 = 1.7424e-04
Validation auc = 0.986157
Validation accuracy = 0.962617
Validation prc-auc = 0.996481
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 28
Loss = 1.2256e-01, PNorm = 68.5509, GNorm = 0.3833, lr_0 = 1.7424e-04
Validation auc = 0.988926
Validation accuracy = 0.953271
Validation prc-auc = 0.997178
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 29
Loss = 2.0905e-01, PNorm = 68.5720, GNorm = 0.5680, lr_0 = 1.7424e-04
Validation auc = 0.983942
Validation accuracy = 0.962617
Validation prc-auc = 0.995938
Validation f1 = 0.977011
Validation mcc = 0.878743
Model 0 best validation auc = 0.989480 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.990998
Model 0 test accuracy = 0.975000
Model 0 test prc-auc = 0.997406
Model 0 test f1 = 0.984293
Model 0 test mcc = 0.925881
Ensemble test auc = 0.990998
Ensemble test accuracy = 0.975000
Ensemble test prc-auc = 0.997406
Ensemble test f1 = 0.984293
Ensemble test mcc = 0.925881
Fold 6
Splitting data with seed 81
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.783396
Validation accuracy = 0.887850
Validation prc-auc = 0.931378
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 1
Loss = 3.7054e-01, PNorm = 67.4428, GNorm = 0.3230, lr_0 = 1.1868e-03
Validation auc = 0.794632
Validation accuracy = 0.869159
Validation prc-auc = 0.935353
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 2
Loss = 1.7075e-01, PNorm = 67.9997, GNorm = 0.2408, lr_0 = 8.0296e-04
Validation auc = 0.800874
Validation accuracy = 0.869159
Validation prc-auc = 0.935522
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 3
Loss = 2.8854e-01, PNorm = 68.1706, GNorm = 0.5760, lr_0 = 3.8068e-04
Validation auc = 0.805868
Validation accuracy = 0.869159
Validation prc-auc = 0.936067
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 4
Loss = 2.5220e-01, PNorm = 68.2023, GNorm = 0.7534, lr_0 = 2.6218e-04
Validation auc = 0.813983
Validation accuracy = 0.869159
Validation prc-auc = 0.937692
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 5
Loss = 2.1439e-01, PNorm = 68.2176, GNorm = 0.4448, lr_0 = 2.5751e-04
Validation auc = 0.818352
Validation accuracy = 0.869159
Validation prc-auc = 0.931837
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 6
Loss = 1.7127e-01, PNorm = 68.2309, GNorm = 0.2988, lr_0 = 2.5246e-04
Validation auc = 0.828964
Validation accuracy = 0.869159
Validation prc-auc = 0.930871
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 7
Loss = 2.1316e-01, PNorm = 68.2418, GNorm = 0.2873, lr_0 = 2.4795e-04
Validation auc = 0.835830
Validation accuracy = 0.869159
Validation prc-auc = 0.932553
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 8
Loss = 2.5747e-01, PNorm = 68.2545, GNorm = 0.2942, lr_0 = 2.4309e-04
Validation auc = 0.846442
Validation accuracy = 0.869159
Validation prc-auc = 0.935390
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 9
Loss = 2.3435e-01, PNorm = 68.2664, GNorm = 0.3411, lr_0 = 2.3876e-04
Validation auc = 0.851436
Validation accuracy = 0.869159
Validation prc-auc = 0.936836
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 10
Loss = 2.2974e-01, PNorm = 68.2794, GNorm = 0.2283, lr_0 = 2.3450e-04
Validation auc = 0.856429
Validation accuracy = 0.878505
Validation prc-auc = 0.938109
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 11
Loss = 1.9213e-01, PNorm = 68.2939, GNorm = 0.6126, lr_0 = 2.2990e-04
Validation auc = 0.860799
Validation accuracy = 0.878505
Validation prc-auc = 0.931032
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 12
Loss = 2.2697e-01, PNorm = 68.3073, GNorm = 0.3092, lr_0 = 2.2580e-04
Validation auc = 0.865169
Validation accuracy = 0.878505
Validation prc-auc = 0.932064
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 13
Loss = 2.2869e-01, PNorm = 68.3191, GNorm = 0.2301, lr_0 = 2.2177e-04
Validation auc = 0.863920
Validation accuracy = 0.887850
Validation prc-auc = 0.939882
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 14
Loss = 2.5594e-01, PNorm = 68.3316, GNorm = 0.5188, lr_0 = 2.1742e-04
Validation auc = 0.866417
Validation accuracy = 0.887850
Validation prc-auc = 0.940664
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 15
Loss = 1.8887e-01, PNorm = 68.3449, GNorm = 0.4280, lr_0 = 2.1354e-04
Validation auc = 0.871411
Validation accuracy = 0.887850
Validation prc-auc = 0.941857
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 16
Loss = 1.9950e-01, PNorm = 68.3596, GNorm = 0.2743, lr_0 = 2.0936e-04
Validation auc = 0.873908
Validation accuracy = 0.887850
Validation prc-auc = 0.942436
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 17
Loss = 2.1212e-01, PNorm = 68.3742, GNorm = 0.6299, lr_0 = 2.0562e-04
Validation auc = 0.872035
Validation accuracy = 0.897196
Validation prc-auc = 0.941967
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 18
Loss = 1.9279e-01, PNorm = 68.3888, GNorm = 0.3389, lr_0 = 2.0195e-04
Validation auc = 0.870787
Validation accuracy = 0.897196
Validation prc-auc = 0.941830
Validation f1 = 0.939891
Validation mcc = 0.597502
Epoch 19
Loss = 1.9795e-01, PNorm = 68.4052, GNorm = 0.6066, lr_0 = 1.9800e-04
Validation auc = 0.878277
Validation accuracy = 0.887850
Validation prc-auc = 0.947901
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 20
Loss = 2.0946e-01, PNorm = 68.4189, GNorm = 0.6095, lr_0 = 1.9446e-04
Validation auc = 0.872035
Validation accuracy = 0.906542
Validation prc-auc = 0.946651
Validation f1 = 0.945652
Validation mcc = 0.631938
Epoch 21
Loss = 1.8611e-01, PNorm = 68.4344, GNorm = 0.6899, lr_0 = 1.9099e-04
Validation auc = 0.878277
Validation accuracy = 0.887850
Validation prc-auc = 0.955347
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 22
Loss = 1.9066e-01, PNorm = 68.4476, GNorm = 0.4236, lr_0 = 1.8725e-04
Validation auc = 0.880774
Validation accuracy = 0.897196
Validation prc-auc = 0.957632
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 23
Loss = 1.9201e-01, PNorm = 68.4618, GNorm = 1.8896, lr_0 = 1.8391e-04
Loss = 2.4620e-01, PNorm = 68.4632, GNorm = 0.5079, lr_0 = 1.8358e-04
Validation auc = 0.880150
Validation accuracy = 0.887850
Validation prc-auc = 0.958831
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 24
Loss = 1.8318e-01, PNorm = 68.4778, GNorm = 1.4039, lr_0 = 1.8030e-04
Validation auc = 0.877029
Validation accuracy = 0.897196
Validation prc-auc = 0.956709
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 25
Loss = 1.8405e-01, PNorm = 68.4922, GNorm = 0.6393, lr_0 = 1.7709e-04
Validation auc = 0.878901
Validation accuracy = 0.897196
Validation prc-auc = 0.958385
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 26
Validation auc = 0.882022
Validation accuracy = 0.897196
Validation prc-auc = 0.962184
Validation f1 = 0.941176
Validation mcc = 0.583840
Epoch 27
Loss = 1.9578e-01, PNorm = 68.5088, GNorm = 0.4857, lr_0 = 1.7424e-04
Validation auc = 0.876404
Validation accuracy = 0.906542
Validation prc-auc = 0.961104
Validation f1 = 0.945652
Validation mcc = 0.631938
Epoch 28
Loss = 1.5047e-01, PNorm = 68.5241, GNorm = 1.4521, lr_0 = 1.7424e-04
Validation auc = 0.881398
Validation accuracy = 0.897196
Validation prc-auc = 0.965046
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 29
Loss = 1.3251e-01, PNorm = 68.5410, GNorm = 1.3953, lr_0 = 1.7424e-04
Validation auc = 0.883271
Validation accuracy = 0.897196
Validation prc-auc = 0.965794
Validation f1 = 0.941176
Validation mcc = 0.583840
Model 0 best validation auc = 0.883271 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.989771
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.997030
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Ensemble test auc = 0.989771
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.997030
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 7
Splitting data with seed 82
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.912037
Validation accuracy = 0.878505
Validation prc-auc = 0.955820
Validation f1 = 0.924855
Validation mcc = 0.667860
Epoch 1
Loss = 3.5117e-01, PNorm = 67.4371, GNorm = 0.2729, lr_0 = 1.1868e-03
Validation auc = 0.921296
Validation accuracy = 0.897196
Validation prc-auc = 0.961724
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 2
Loss = 2.6023e-01, PNorm = 67.9876, GNorm = 0.2478, lr_0 = 8.0296e-04
Validation auc = 0.928241
Validation accuracy = 0.906542
Validation prc-auc = 0.965730
Validation f1 = 0.936709
Validation mcc = 0.759135
Epoch 3
Loss = 2.6608e-01, PNorm = 68.1550, GNorm = 0.4955, lr_0 = 3.8068e-04
Validation auc = 0.930093
Validation accuracy = 0.897196
Validation prc-auc = 0.966886
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 4
Loss = 2.3238e-01, PNorm = 68.1872, GNorm = 0.2983, lr_0 = 2.6218e-04
Validation auc = 0.933333
Validation accuracy = 0.897196
Validation prc-auc = 0.969306
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 5
Loss = 2.6021e-01, PNorm = 68.2031, GNorm = 0.2498, lr_0 = 2.5751e-04
Validation auc = 0.935648
Validation accuracy = 0.915888
Validation prc-auc = 0.970851
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 6
Loss = 2.3420e-01, PNorm = 68.2165, GNorm = 0.2378, lr_0 = 2.5246e-04
Validation auc = 0.937037
Validation accuracy = 0.897196
Validation prc-auc = 0.971801
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 7
Loss = 2.1135e-01, PNorm = 68.2284, GNorm = 0.2589, lr_0 = 2.4795e-04
Validation auc = 0.940278
Validation accuracy = 0.906542
Validation prc-auc = 0.973386
Validation f1 = 0.936709
Validation mcc = 0.759135
Epoch 8
Loss = 2.0889e-01, PNorm = 68.2415, GNorm = 0.2890, lr_0 = 2.4309e-04
Validation auc = 0.943519
Validation accuracy = 0.934579
Validation prc-auc = 0.974865
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 9
Loss = 2.2455e-01, PNorm = 68.2532, GNorm = 0.7588, lr_0 = 2.3876e-04
Validation auc = 0.946296
Validation accuracy = 0.943925
Validation prc-auc = 0.975680
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 10
Loss = 2.5261e-01, PNorm = 68.2644, GNorm = 0.5728, lr_0 = 2.3450e-04
Validation auc = 0.944444
Validation accuracy = 0.943925
Validation prc-auc = 0.973676
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 11
Loss = 2.0975e-01, PNorm = 68.2788, GNorm = 0.2119, lr_0 = 2.2990e-04
Validation auc = 0.945370
Validation accuracy = 0.934579
Validation prc-auc = 0.974180
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 12
Loss = 2.4363e-01, PNorm = 68.2938, GNorm = 0.4558, lr_0 = 2.2580e-04
Validation auc = 0.949074
Validation accuracy = 0.953271
Validation prc-auc = 0.975996
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 13
Loss = 2.3512e-01, PNorm = 68.3082, GNorm = 0.8944, lr_0 = 2.2177e-04
Validation auc = 0.948148
Validation accuracy = 0.934579
Validation prc-auc = 0.975008
Validation f1 = 0.955975
Validation mcc = 0.828970
Epoch 14
Loss = 2.4072e-01, PNorm = 68.3236, GNorm = 0.5252, lr_0 = 2.1742e-04
Validation auc = 0.952315
Validation accuracy = 0.953271
Validation prc-auc = 0.978140
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 15
Loss = 1.8682e-01, PNorm = 68.3375, GNorm = 0.9620, lr_0 = 2.1354e-04
Validation auc = 0.950000
Validation accuracy = 0.915888
Validation prc-auc = 0.977019
Validation f1 = 0.942675
Validation mcc = 0.787020
Epoch 16
Loss = 2.3886e-01, PNorm = 68.3460, GNorm = 0.2861, lr_0 = 2.0936e-04
Validation auc = 0.953241
Validation accuracy = 0.962617
Validation prc-auc = 0.979818
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 17
Loss = 2.1616e-01, PNorm = 68.3563, GNorm = 0.3211, lr_0 = 2.0562e-04
Validation auc = 0.952778
Validation accuracy = 0.934579
Validation prc-auc = 0.979221
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 18
Loss = 2.2522e-01, PNorm = 68.3693, GNorm = 0.2564, lr_0 = 2.0195e-04
Validation auc = 0.956019
Validation accuracy = 0.943925
Validation prc-auc = 0.981172
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 19
Loss = 2.3014e-01, PNorm = 68.3853, GNorm = 0.3675, lr_0 = 1.9800e-04
Validation auc = 0.956019
Validation accuracy = 0.934579
Validation prc-auc = 0.980916
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 20
Loss = 2.1861e-01, PNorm = 68.3991, GNorm = 0.2272, lr_0 = 1.9446e-04
Validation auc = 0.956019
Validation accuracy = 0.934579
Validation prc-auc = 0.980916
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 21
Loss = 2.0342e-01, PNorm = 68.4150, GNorm = 0.2842, lr_0 = 1.9099e-04
Validation auc = 0.956019
Validation accuracy = 0.953271
Validation prc-auc = 0.980710
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 22
Loss = 2.0725e-01, PNorm = 68.4313, GNorm = 0.3202, lr_0 = 1.8725e-04
Validation auc = 0.958333
Validation accuracy = 0.962617
Validation prc-auc = 0.981909
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 23
Loss = 1.9155e-01, PNorm = 68.4467, GNorm = 0.4960, lr_0 = 1.8391e-04
Loss = 3.5207e-01, PNorm = 68.4483, GNorm = 1.0490, lr_0 = 1.8358e-04
Validation auc = 0.956944
Validation accuracy = 0.943925
Validation prc-auc = 0.980883
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 24
Loss = 1.9783e-01, PNorm = 68.4644, GNorm = 0.3899, lr_0 = 1.8030e-04
Validation auc = 0.959722
Validation accuracy = 0.971963
Validation prc-auc = 0.982607
Validation f1 = 0.981595
Validation mcc = 0.925614
Epoch 25
Loss = 2.0231e-01, PNorm = 68.4794, GNorm = 0.5098, lr_0 = 1.7709e-04
Validation auc = 0.958333
Validation accuracy = 0.934579
Validation prc-auc = 0.981822
Validation f1 = 0.955975
Validation mcc = 0.828970
Epoch 26
Validation auc = 0.960185
Validation accuracy = 0.962617
Validation prc-auc = 0.983112
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 27
Loss = 1.9409e-01, PNorm = 68.4945, GNorm = 0.3106, lr_0 = 1.7424e-04
Validation auc = 0.962500
Validation accuracy = 0.962617
Validation prc-auc = 0.984367
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 28
Loss = 1.4813e-01, PNorm = 68.5077, GNorm = 0.2280, lr_0 = 1.7424e-04
Validation auc = 0.961111
Validation accuracy = 0.943925
Validation prc-auc = 0.983809
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 29
Loss = 1.7255e-01, PNorm = 68.5244, GNorm = 0.2683, lr_0 = 1.7424e-04
Validation auc = 0.962037
Validation accuracy = 0.953271
Validation prc-auc = 0.983998
Validation f1 = 0.968944
Validation mcc = 0.874894
Model 0 best validation auc = 0.962500 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.988953
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.996729
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Ensemble test auc = 0.988953
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.996729
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 8
Splitting data with seed 83
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.921687
Validation accuracy = 0.850467
Validation prc-auc = 0.964833
Validation f1 = 0.912088
Validation mcc = 0.528641
Epoch 1
Loss = 3.7657e-01, PNorm = 67.4493, GNorm = 0.4605, lr_0 = 1.1868e-03
Validation auc = 0.926707
Validation accuracy = 0.915888
Validation prc-auc = 0.965683
Validation f1 = 0.946746
Validation mcc = 0.749715
Epoch 2
Loss = 2.1764e-01, PNorm = 68.0052, GNorm = 0.2818, lr_0 = 8.0296e-04
Validation auc = 0.930723
Validation accuracy = 0.915888
Validation prc-auc = 0.967753
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 3
Loss = 2.7520e-01, PNorm = 68.1750, GNorm = 0.2083, lr_0 = 3.8068e-04
Validation auc = 0.930723
Validation accuracy = 0.925234
Validation prc-auc = 0.966529
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 4
Loss = 3.0723e-01, PNorm = 68.2084, GNorm = 0.2628, lr_0 = 2.6218e-04
Validation auc = 0.931225
Validation accuracy = 0.925234
Validation prc-auc = 0.966875
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 5
Loss = 2.1461e-01, PNorm = 68.2258, GNorm = 0.2308, lr_0 = 2.5751e-04
Validation auc = 0.932731
Validation accuracy = 0.925234
Validation prc-auc = 0.966998
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 6
Loss = 2.5792e-01, PNorm = 68.2400, GNorm = 0.2725, lr_0 = 2.5246e-04
Validation auc = 0.935743
Validation accuracy = 0.925234
Validation prc-auc = 0.968200
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 7
Loss = 2.5946e-01, PNorm = 68.2530, GNorm = 0.6223, lr_0 = 2.4795e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.968540
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 8
Loss = 2.2240e-01, PNorm = 68.2667, GNorm = 0.2365, lr_0 = 2.4309e-04
Validation auc = 0.938253
Validation accuracy = 0.915888
Validation prc-auc = 0.969079
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 9
Loss = 2.1293e-01, PNorm = 68.2810, GNorm = 0.3059, lr_0 = 2.3876e-04
Validation auc = 0.937751
Validation accuracy = 0.915888
Validation prc-auc = 0.968017
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 10
Loss = 2.6211e-01, PNorm = 68.2959, GNorm = 0.2256, lr_0 = 2.3450e-04
Validation auc = 0.937751
Validation accuracy = 0.915888
Validation prc-auc = 0.965935
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 11
Loss = 2.1444e-01, PNorm = 68.3128, GNorm = 0.2737, lr_0 = 2.2990e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.965476
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 12
Loss = 2.0178e-01, PNorm = 68.3273, GNorm = 0.2643, lr_0 = 2.2580e-04
Validation auc = 0.939759
Validation accuracy = 0.915888
Validation prc-auc = 0.968643
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 13
Loss = 1.9148e-01, PNorm = 68.3410, GNorm = 0.4099, lr_0 = 2.2177e-04
Validation auc = 0.940763
Validation accuracy = 0.925234
Validation prc-auc = 0.969017
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 14
Loss = 2.0312e-01, PNorm = 68.3579, GNorm = 0.5698, lr_0 = 2.1742e-04
Validation auc = 0.940763
Validation accuracy = 0.915888
Validation prc-auc = 0.969039
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 15
Loss = 2.2835e-01, PNorm = 68.3740, GNorm = 0.3098, lr_0 = 2.1354e-04
Validation auc = 0.940261
Validation accuracy = 0.915888
Validation prc-auc = 0.968891
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 16
Loss = 2.2154e-01, PNorm = 68.3899, GNorm = 0.3892, lr_0 = 2.0936e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.969362
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 17
Loss = 1.9006e-01, PNorm = 68.4065, GNorm = 0.4846, lr_0 = 2.0562e-04
Validation auc = 0.942771
Validation accuracy = 0.915888
Validation prc-auc = 0.972063
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 18
Loss = 2.0495e-01, PNorm = 68.4249, GNorm = 0.8840, lr_0 = 2.0195e-04
Validation auc = 0.940763
Validation accuracy = 0.925234
Validation prc-auc = 0.969020
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 19
Loss = 1.9762e-01, PNorm = 68.4441, GNorm = 0.2362, lr_0 = 1.9800e-04
Validation auc = 0.940261
Validation accuracy = 0.915888
Validation prc-auc = 0.969718
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 20
Loss = 1.9932e-01, PNorm = 68.4621, GNorm = 0.3216, lr_0 = 1.9446e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.970550
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 21
Loss = 1.9084e-01, PNorm = 68.4794, GNorm = 0.4711, lr_0 = 1.9099e-04
Validation auc = 0.943775
Validation accuracy = 0.925234
Validation prc-auc = 0.972391
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 22
Loss = 1.9359e-01, PNorm = 68.4966, GNorm = 0.3957, lr_0 = 1.8725e-04
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.973520
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 23
Loss = 1.9756e-01, PNorm = 68.5138, GNorm = 0.7620, lr_0 = 1.8391e-04
Loss = 1.4926e-01, PNorm = 68.5155, GNorm = 0.5518, lr_0 = 1.8358e-04
Validation auc = 0.944277
Validation accuracy = 0.925234
Validation prc-auc = 0.973218
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 24
Loss = 1.8551e-01, PNorm = 68.5326, GNorm = 0.2673, lr_0 = 1.8030e-04
Validation auc = 0.944779
Validation accuracy = 0.915888
Validation prc-auc = 0.973970
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 25
Loss = 1.9399e-01, PNorm = 68.5473, GNorm = 0.3508, lr_0 = 1.7709e-04
Validation auc = 0.946285
Validation accuracy = 0.925234
Validation prc-auc = 0.975001
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 26
Validation auc = 0.945783
Validation accuracy = 0.925234
Validation prc-auc = 0.975373
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 27
Loss = 3.9141e-01, PNorm = 68.5685, GNorm = 0.7332, lr_0 = 1.7424e-04
Validation auc = 0.945783
Validation accuracy = 0.915888
Validation prc-auc = 0.977193
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 28
Loss = 1.1222e-01, PNorm = 68.5868, GNorm = 0.6186, lr_0 = 1.7424e-04
Validation auc = 0.943775
Validation accuracy = 0.925234
Validation prc-auc = 0.974300
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 29
Loss = 2.2766e-01, PNorm = 68.6059, GNorm = 1.1014, lr_0 = 1.7424e-04
Validation auc = 0.947289
Validation accuracy = 0.925234
Validation prc-auc = 0.977297
Validation f1 = 0.954023
Validation mcc = 0.779781
Model 0 best validation auc = 0.947289 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.986498
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.995988
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Ensemble test auc = 0.986498
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.995988
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 9
Splitting data with seed 84
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.912299
Validation accuracy = 0.943925
Validation prc-auc = 0.960502
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 1
Loss = 3.7785e-01, PNorm = 67.4368, GNorm = 0.2828, lr_0 = 1.1868e-03
Validation auc = 0.913904
Validation accuracy = 0.934579
Validation prc-auc = 0.962519
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 2
Loss = 2.2409e-01, PNorm = 67.9821, GNorm = 0.3030, lr_0 = 8.0296e-04
Validation auc = 0.914439
Validation accuracy = 0.943925
Validation prc-auc = 0.962934
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 3
Loss = 2.8728e-01, PNorm = 68.1456, GNorm = 0.2425, lr_0 = 3.8068e-04
Validation auc = 0.916043
Validation accuracy = 0.953271
Validation prc-auc = 0.964613
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 4
Loss = 2.3917e-01, PNorm = 68.1769, GNorm = 0.2165, lr_0 = 2.6218e-04
Validation auc = 0.920856
Validation accuracy = 0.925234
Validation prc-auc = 0.967707
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 5
Loss = 2.7336e-01, PNorm = 68.1931, GNorm = 0.2663, lr_0 = 2.5751e-04
Validation auc = 0.921925
Validation accuracy = 0.925234
Validation prc-auc = 0.967468
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 6
Loss = 3.1061e-01, PNorm = 68.2055, GNorm = 0.2690, lr_0 = 2.5246e-04
Validation auc = 0.924599
Validation accuracy = 0.943925
Validation prc-auc = 0.968673
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 7
Loss = 2.7253e-01, PNorm = 68.2162, GNorm = 0.2162, lr_0 = 2.4795e-04
Validation auc = 0.926203
Validation accuracy = 0.925234
Validation prc-auc = 0.969004
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 8
Loss = 2.5573e-01, PNorm = 68.2297, GNorm = 0.2484, lr_0 = 2.4309e-04
Validation auc = 0.927273
Validation accuracy = 0.934579
Validation prc-auc = 0.969386
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 9
Loss = 2.4878e-01, PNorm = 68.2428, GNorm = 0.3987, lr_0 = 2.3876e-04
Validation auc = 0.930481
Validation accuracy = 0.934579
Validation prc-auc = 0.969992
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 10
Loss = 2.1612e-01, PNorm = 68.2563, GNorm = 0.3827, lr_0 = 2.3450e-04
Validation auc = 0.931016
Validation accuracy = 0.934579
Validation prc-auc = 0.970173
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 11
Loss = 2.3046e-01, PNorm = 68.2722, GNorm = 0.4114, lr_0 = 2.2990e-04
Validation auc = 0.934759
Validation accuracy = 0.953271
Validation prc-auc = 0.971334
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 12
Loss = 2.3890e-01, PNorm = 68.2863, GNorm = 0.2557, lr_0 = 2.2580e-04
Validation auc = 0.935294
Validation accuracy = 0.953271
Validation prc-auc = 0.971511
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 13
Loss = 2.2683e-01, PNorm = 68.2975, GNorm = 0.4820, lr_0 = 2.2177e-04
Validation auc = 0.935829
Validation accuracy = 0.953271
Validation prc-auc = 0.971732
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 14
Loss = 2.4713e-01, PNorm = 68.3118, GNorm = 0.2589, lr_0 = 2.1742e-04
Validation auc = 0.937968
Validation accuracy = 0.953271
Validation prc-auc = 0.972318
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 15
Loss = 2.2712e-01, PNorm = 68.3268, GNorm = 0.4911, lr_0 = 2.1354e-04
Validation auc = 0.938503
Validation accuracy = 0.953271
Validation prc-auc = 0.973142
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 16
Loss = 2.3008e-01, PNorm = 68.3418, GNorm = 0.2435, lr_0 = 2.0936e-04
Validation auc = 0.937968
Validation accuracy = 0.953271
Validation prc-auc = 0.973566
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 17
Loss = 1.9651e-01, PNorm = 68.3567, GNorm = 0.2411, lr_0 = 2.0562e-04
Validation auc = 0.940642
Validation accuracy = 0.953271
Validation prc-auc = 0.974912
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 18
Loss = 2.2917e-01, PNorm = 68.3722, GNorm = 0.6308, lr_0 = 2.0195e-04
Validation auc = 0.940107
Validation accuracy = 0.962617
Validation prc-auc = 0.974761
Validation f1 = 0.977011
Validation mcc = 0.883974
Epoch 19
Loss = 2.2096e-01, PNorm = 68.3899, GNorm = 0.4952, lr_0 = 1.9800e-04
Validation auc = 0.941176
Validation accuracy = 0.953271
Validation prc-auc = 0.975599
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 20
Loss = 1.9399e-01, PNorm = 68.4068, GNorm = 0.4291, lr_0 = 1.9446e-04
Validation auc = 0.941711
Validation accuracy = 0.953271
Validation prc-auc = 0.975215
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 21
Loss = 2.1722e-01, PNorm = 68.4214, GNorm = 0.6188, lr_0 = 1.9099e-04
Validation auc = 0.943316
Validation accuracy = 0.953271
Validation prc-auc = 0.976214
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 22
Loss = 2.0226e-01, PNorm = 68.4388, GNorm = 0.9379, lr_0 = 1.8725e-04
Validation auc = 0.943316
Validation accuracy = 0.953271
Validation prc-auc = 0.976707
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 23
Loss = 2.0022e-01, PNorm = 68.4521, GNorm = 0.4816, lr_0 = 1.8391e-04
Loss = 2.1625e-01, PNorm = 68.4535, GNorm = 0.6607, lr_0 = 1.8358e-04
Validation auc = 0.944920
Validation accuracy = 0.953271
Validation prc-auc = 0.978035
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 24
Loss = 2.1032e-01, PNorm = 68.4688, GNorm = 0.5760, lr_0 = 1.8030e-04
Validation auc = 0.944385
Validation accuracy = 0.953271
Validation prc-auc = 0.977903
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 25
Loss = 2.1278e-01, PNorm = 68.4836, GNorm = 0.6825, lr_0 = 1.7709e-04
Validation auc = 0.946524
Validation accuracy = 0.953271
Validation prc-auc = 0.979285
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 26
Validation auc = 0.946524
Validation accuracy = 0.953271
Validation prc-auc = 0.979664
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 27
Loss = 2.2342e-01, PNorm = 68.5022, GNorm = 0.5067, lr_0 = 1.7424e-04
Validation auc = 0.947059
Validation accuracy = 0.953271
Validation prc-auc = 0.980129
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 28
Loss = 2.0309e-01, PNorm = 68.5202, GNorm = 0.2678, lr_0 = 1.7424e-04
Validation auc = 0.948128
Validation accuracy = 0.953271
Validation prc-auc = 0.980452
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 29
Loss = 1.8010e-01, PNorm = 68.5383, GNorm = 0.8995, lr_0 = 1.7424e-04
Validation auc = 0.946524
Validation accuracy = 0.943925
Validation prc-auc = 0.980012
Validation f1 = 0.965517
Validation mcc = 0.822153
Model 0 best validation auc = 0.948128 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.993453
Model 0 test accuracy = 0.966667
Model 0 test prc-auc = 0.998149
Model 0 test f1 = 0.979167
Model 0 test mcc = 0.900898
Ensemble test auc = 0.993453
Ensemble test accuracy = 0.966667
Ensemble test prc-auc = 0.998149
Ensemble test f1 = 0.979167
Ensemble test mcc = 0.900898
10-fold cross validation
	Seed 75 ==> test auc = 0.989362
	Seed 75 ==> test accuracy = 0.983333
	Seed 75 ==> test prc-auc = 0.996899
	Seed 75 ==> test f1 = 0.989474
	Seed 75 ==> test mcc = 0.950708
	Seed 76 ==> test auc = 0.992226
	Seed 76 ==> test accuracy = 0.950000
	Seed 76 ==> test prc-auc = 0.997793
	Seed 76 ==> test f1 = 0.969072
	Seed 76 ==> test mcc = 0.850339
	Seed 77 ==> test auc = 0.989362
	Seed 77 ==> test accuracy = 0.958333
	Seed 77 ==> test prc-auc = 0.996867
	Seed 77 ==> test f1 = 0.974093
	Seed 77 ==> test mcc = 0.875728
	Seed 78 ==> test auc = 0.990998
	Seed 78 ==> test accuracy = 0.975000
	Seed 78 ==> test prc-auc = 0.997399
	Seed 78 ==> test f1 = 0.984127
	Seed 78 ==> test mcc = 0.925598
	Seed 79 ==> test auc = 0.985679
	Seed 79 ==> test accuracy = 0.950000
	Seed 79 ==> test prc-auc = 0.995704
	Seed 79 ==> test f1 = 0.969072
	Seed 79 ==> test mcc = 0.850339
	Seed 80 ==> test auc = 0.990998
	Seed 80 ==> test accuracy = 0.975000
	Seed 80 ==> test prc-auc = 0.997406
	Seed 80 ==> test f1 = 0.984293
	Seed 80 ==> test mcc = 0.925881
	Seed 81 ==> test auc = 0.989771
	Seed 81 ==> test accuracy = 0.958333
	Seed 81 ==> test prc-auc = 0.997030
	Seed 81 ==> test f1 = 0.974093
	Seed 81 ==> test mcc = 0.875728
	Seed 82 ==> test auc = 0.988953
	Seed 82 ==> test accuracy = 0.958333
	Seed 82 ==> test prc-auc = 0.996729
	Seed 82 ==> test f1 = 0.974093
	Seed 82 ==> test mcc = 0.875728
	Seed 83 ==> test auc = 0.986498
	Seed 83 ==> test accuracy = 0.958333
	Seed 83 ==> test prc-auc = 0.995988
	Seed 83 ==> test f1 = 0.974093
	Seed 83 ==> test mcc = 0.875728
	Seed 84 ==> test auc = 0.993453
	Seed 84 ==> test accuracy = 0.966667
	Seed 84 ==> test prc-auc = 0.998149
	Seed 84 ==> test f1 = 0.979167
	Seed 84 ==> test mcc = 0.900898
Overall test auc = 0.989730 +/- 0.002259
Overall test accuracy = 0.963333 +/- 0.010672
Overall test prc-auc = 0.996996 +/- 0.000713
Overall test f1 = 0.977158 +/- 0.006508
Overall test mcc = 0.890668 +/- 0.032117
Elapsed time = 0:24:09
