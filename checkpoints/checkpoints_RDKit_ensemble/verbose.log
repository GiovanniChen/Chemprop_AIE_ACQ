Command line
python E:\BIT\codes\chemprop\AIE_ACQ\train.py
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 100,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'E:/BIT/codes/chemprop/data/AIE_ACQ/AIEACQ_train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 5,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.25,
 'empty_cache': False,
 'ensemble_size': 5,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'prc-auc', 'f1', 'mcc'],
 'features_generator': ['rdkit_2d_normalized'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 1400,
 'ffn_num_layers': 2,
 'final_lr': 0.00017424185057835588,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 1300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0016475184132470895,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.00026550826157806045,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'prc-auc', 'f1', 'mcc'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': True,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 4,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '20240424_checkpoints_RDKit_best_ensemble',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': 'E:/BIT/codes/chemprop/data/AIE_ACQ/AIEACQ_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.9, 0.1, 0.0],
 'split_type': 'cv-no-test',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Label'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 4.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.951827
Validation accuracy = 0.953271
Validation prc-auc = 0.982913
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 1
Loss = 3.5112e-01, PNorm = 67.4431, GNorm = 0.2869, lr_0 = 1.1868e-03
Validation auc = 0.955703
Validation accuracy = 0.934579
Validation prc-auc = 0.984665
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 2
Loss = 2.4691e-01, PNorm = 67.9950, GNorm = 0.2228, lr_0 = 8.0296e-04
Validation auc = 0.962348
Validation accuracy = 0.962617
Validation prc-auc = 0.987611
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 3
Loss = 2.5173e-01, PNorm = 68.1677, GNorm = 0.4078, lr_0 = 3.8068e-04
Validation auc = 0.966777
Validation accuracy = 0.953271
Validation prc-auc = 0.988952
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 4
Loss = 2.8825e-01, PNorm = 68.2009, GNorm = 0.4429, lr_0 = 2.6218e-04
Validation auc = 0.969546
Validation accuracy = 0.943925
Validation prc-auc = 0.990233
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 5
Loss = 3.3777e-01, PNorm = 68.2189, GNorm = 0.2400, lr_0 = 2.5751e-04
Validation auc = 0.968439
Validation accuracy = 0.953271
Validation prc-auc = 0.990143
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 6
Loss = 2.6316e-01, PNorm = 68.2344, GNorm = 0.2425, lr_0 = 2.5246e-04
Validation auc = 0.975083
Validation accuracy = 0.962617
Validation prc-auc = 0.992419
Validation f1 = 0.976471
Validation mcc = 0.887074
Epoch 7
Loss = 2.5425e-01, PNorm = 68.2483, GNorm = 0.4298, lr_0 = 2.4795e-04
Validation auc = 0.977298
Validation accuracy = 0.953271
Validation prc-auc = 0.993598
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 8
Loss = 2.5641e-01, PNorm = 68.2634, GNorm = 0.2357, lr_0 = 2.4309e-04
Validation auc = 0.980620
Validation accuracy = 0.953271
Validation prc-auc = 0.994723
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 9
Loss = 2.0615e-01, PNorm = 68.2775, GNorm = 0.6523, lr_0 = 2.3876e-04
Validation auc = 0.983389
Validation accuracy = 0.943925
Validation prc-auc = 0.995486
Validation f1 = 0.964286
Validation mcc = 0.839338
Epoch 10
Loss = 2.1750e-01, PNorm = 68.2909, GNorm = 0.7759, lr_0 = 2.3450e-04
Validation auc = 0.976744
Validation accuracy = 0.962617
Validation prc-auc = 0.993540
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 11
Loss = 2.6321e-01, PNorm = 68.3049, GNorm = 0.4584, lr_0 = 2.2990e-04
Validation auc = 0.981728
Validation accuracy = 0.943925
Validation prc-auc = 0.995151
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 12
Loss = 2.1299e-01, PNorm = 68.3189, GNorm = 0.3385, lr_0 = 2.2580e-04
Validation auc = 0.981728
Validation accuracy = 0.962617
Validation prc-auc = 0.995151
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 13
Loss = 2.3340e-01, PNorm = 68.3339, GNorm = 0.6997, lr_0 = 2.2177e-04
Validation auc = 0.985604
Validation accuracy = 0.962617
Validation prc-auc = 0.996256
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 14
Loss = 2.2910e-01, PNorm = 68.3521, GNorm = 0.7023, lr_0 = 2.1742e-04
Validation auc = 0.985050
Validation accuracy = 0.962617
Validation prc-auc = 0.996104
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 15
Loss = 2.3239e-01, PNorm = 68.3675, GNorm = 0.2687, lr_0 = 2.1354e-04
Validation auc = 0.985604
Validation accuracy = 0.962617
Validation prc-auc = 0.996273
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 16
Loss = 2.2527e-01, PNorm = 68.3863, GNorm = 0.2436, lr_0 = 2.0936e-04
Validation auc = 0.987265
Validation accuracy = 0.962617
Validation prc-auc = 0.996751
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 17
Loss = 2.1725e-01, PNorm = 68.4021, GNorm = 0.3610, lr_0 = 2.0562e-04
Validation auc = 0.989480
Validation accuracy = 0.962617
Validation prc-auc = 0.997343
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 18
Loss = 1.9930e-01, PNorm = 68.4189, GNorm = 0.5300, lr_0 = 2.0195e-04
Validation auc = 0.990587
Validation accuracy = 0.971963
Validation prc-auc = 0.997633
Validation f1 = 0.982456
Validation mcc = 0.913087
Epoch 19
Loss = 2.2490e-01, PNorm = 68.4365, GNorm = 0.3998, lr_0 = 1.9800e-04
Validation auc = 0.986711
Validation accuracy = 0.953271
Validation prc-auc = 0.996593
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 20
Loss = 2.0242e-01, PNorm = 68.4540, GNorm = 0.8544, lr_0 = 1.9446e-04
Validation auc = 0.990587
Validation accuracy = 0.953271
Validation prc-auc = 0.997600
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 21
Loss = 2.1092e-01, PNorm = 68.4699, GNorm = 0.2065, lr_0 = 1.9099e-04
Validation auc = 0.988926
Validation accuracy = 0.962617
Validation prc-auc = 0.997171
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 22
Loss = 2.0851e-01, PNorm = 68.4894, GNorm = 0.2202, lr_0 = 1.8725e-04
Validation auc = 0.987265
Validation accuracy = 0.953271
Validation prc-auc = 0.996734
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 23
Loss = 1.9889e-01, PNorm = 68.5071, GNorm = 0.3567, lr_0 = 1.8391e-04
Loss = 3.0389e-01, PNorm = 68.5087, GNorm = 1.6507, lr_0 = 1.8358e-04
Validation auc = 0.990587
Validation accuracy = 0.953271
Validation prc-auc = 0.997600
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 24
Loss = 2.0322e-01, PNorm = 68.5259, GNorm = 0.2674, lr_0 = 1.8030e-04
Validation auc = 0.983389
Validation accuracy = 0.953271
Validation prc-auc = 0.995802
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 25
Loss = 2.1211e-01, PNorm = 68.5410, GNorm = 0.7765, lr_0 = 1.7709e-04
Validation auc = 0.988926
Validation accuracy = 0.953271
Validation prc-auc = 0.997192
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 26
Validation auc = 0.988372
Validation accuracy = 0.971963
Validation prc-auc = 0.997053
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 27
Loss = 1.7148e-01, PNorm = 68.5605, GNorm = 0.2898, lr_0 = 1.7424e-04
Validation auc = 0.988926
Validation accuracy = 0.962617
Validation prc-auc = 0.997192
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 28
Loss = 3.0141e-01, PNorm = 68.5797, GNorm = 0.6238, lr_0 = 1.7424e-04
Validation auc = 0.989480
Validation accuracy = 0.971963
Validation prc-auc = 0.997348
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 29
Loss = 1.8229e-01, PNorm = 68.6006, GNorm = 0.2922, lr_0 = 1.7424e-04
Validation auc = 0.992248
Validation accuracy = 0.962617
Validation prc-auc = 0.998053
Validation f1 = 0.976471
Validation mcc = 0.887074
Model 0 best validation auc = 0.992248 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.991408
Model 0 test accuracy = 0.983333
Model 0 test prc-auc = 0.997534
Model 0 test f1 = 0.989474
Model 0 test mcc = 0.950708
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.945736
Validation accuracy = 0.906542
Validation prc-auc = 0.969690
Validation f1 = 0.945055
Validation mcc = 0.685015
Epoch 1
Loss = 4.3753e-01, PNorm = 67.4480, GNorm = 0.8035, lr_0 = 1.1868e-03
Validation auc = 0.951274
Validation accuracy = 0.934579
Validation prc-auc = 0.977443
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 2
Loss = 2.4194e-01, PNorm = 68.0004, GNorm = 0.2056, lr_0 = 8.0296e-04
Validation auc = 0.960133
Validation accuracy = 0.934579
Validation prc-auc = 0.984505
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 3
Loss = 3.4247e-01, PNorm = 68.1727, GNorm = 0.3273, lr_0 = 3.8068e-04
Validation auc = 0.960687
Validation accuracy = 0.943925
Validation prc-auc = 0.985516
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 4
Loss = 2.3631e-01, PNorm = 68.2048, GNorm = 0.2170, lr_0 = 2.6218e-04
Validation auc = 0.960133
Validation accuracy = 0.953271
Validation prc-auc = 0.985662
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 5
Loss = 2.1706e-01, PNorm = 68.2215, GNorm = 0.4665, lr_0 = 2.5751e-04
Validation auc = 0.967331
Validation accuracy = 0.934579
Validation prc-auc = 0.989058
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 6
Loss = 3.0882e-01, PNorm = 68.2363, GNorm = 0.2400, lr_0 = 2.5246e-04
Validation auc = 0.967331
Validation accuracy = 0.943925
Validation prc-auc = 0.989058
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 7
Loss = 2.5203e-01, PNorm = 68.2484, GNorm = 0.2900, lr_0 = 2.4795e-04
Validation auc = 0.966224
Validation accuracy = 0.953271
Validation prc-auc = 0.988615
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 8
Loss = 2.4575e-01, PNorm = 68.2633, GNorm = 0.3326, lr_0 = 2.4309e-04
Validation auc = 0.971207
Validation accuracy = 0.943925
Validation prc-auc = 0.991024
Validation f1 = 0.964286
Validation mcc = 0.839338
Epoch 9
Loss = 2.1654e-01, PNorm = 68.2774, GNorm = 0.3644, lr_0 = 2.3876e-04
Validation auc = 0.972315
Validation accuracy = 0.953271
Validation prc-auc = 0.991535
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 10
Loss = 2.0384e-01, PNorm = 68.2938, GNorm = 0.2430, lr_0 = 2.3450e-04
Validation auc = 0.976744
Validation accuracy = 0.953271
Validation prc-auc = 0.993187
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 11
Loss = 2.3898e-01, PNorm = 68.3120, GNorm = 0.4594, lr_0 = 2.2990e-04
Validation auc = 0.975637
Validation accuracy = 0.962617
Validation prc-auc = 0.992944
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 12
Loss = 2.3041e-01, PNorm = 68.3264, GNorm = 0.3463, lr_0 = 2.2580e-04
Validation auc = 0.980066
Validation accuracy = 0.953271
Validation prc-auc = 0.994295
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 13
Loss = 2.3255e-01, PNorm = 68.3416, GNorm = 0.5703, lr_0 = 2.2177e-04
Validation auc = 0.978405
Validation accuracy = 0.962617
Validation prc-auc = 0.993827
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 14
Loss = 2.3556e-01, PNorm = 68.3593, GNorm = 0.4691, lr_0 = 2.1742e-04
Validation auc = 0.983389
Validation accuracy = 0.962617
Validation prc-auc = 0.995404
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 15
Loss = 2.1847e-01, PNorm = 68.3771, GNorm = 0.2238, lr_0 = 2.1354e-04
Validation auc = 0.986157
Validation accuracy = 0.962617
Validation prc-auc = 0.996261
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 16
Loss = 2.0627e-01, PNorm = 68.3969, GNorm = 0.2685, lr_0 = 2.0936e-04
Validation auc = 0.987265
Validation accuracy = 0.962617
Validation prc-auc = 0.996642
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 17
Loss = 2.3329e-01, PNorm = 68.4135, GNorm = 0.6622, lr_0 = 2.0562e-04
Validation auc = 0.985050
Validation accuracy = 0.953271
Validation prc-auc = 0.996070
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 18
Loss = 2.0619e-01, PNorm = 68.4319, GNorm = 0.2666, lr_0 = 2.0195e-04
Validation auc = 0.989480
Validation accuracy = 0.962617
Validation prc-auc = 0.997244
Validation f1 = 0.976471
Validation mcc = 0.887074
Epoch 19
Loss = 2.1101e-01, PNorm = 68.4524, GNorm = 0.4786, lr_0 = 1.9800e-04
Validation auc = 0.987265
Validation accuracy = 0.971963
Validation prc-auc = 0.996683
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 20
Loss = 2.1170e-01, PNorm = 68.4723, GNorm = 0.5694, lr_0 = 1.9446e-04
Validation auc = 0.989480
Validation accuracy = 0.962617
Validation prc-auc = 0.997318
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 21
Loss = 1.9498e-01, PNorm = 68.4914, GNorm = 0.9814, lr_0 = 1.9099e-04
Validation auc = 0.988372
Validation accuracy = 0.953271
Validation prc-auc = 0.997037
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 22
Loss = 1.9813e-01, PNorm = 68.5108, GNorm = 0.6130, lr_0 = 1.8725e-04
Validation auc = 0.988372
Validation accuracy = 0.971963
Validation prc-auc = 0.996999
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 23
Loss = 2.0362e-01, PNorm = 68.5298, GNorm = 0.7424, lr_0 = 1.8391e-04
Loss = 1.3295e-01, PNorm = 68.5319, GNorm = 0.8698, lr_0 = 1.8358e-04
Validation auc = 0.990033
Validation accuracy = 0.953271
Validation prc-auc = 0.997446
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 24
Loss = 1.9730e-01, PNorm = 68.5519, GNorm = 0.9286, lr_0 = 1.8030e-04
Validation auc = 0.989480
Validation accuracy = 0.962617
Validation prc-auc = 0.997307
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 25
Loss = 1.9218e-01, PNorm = 68.5709, GNorm = 0.4088, lr_0 = 1.7709e-04
Validation auc = 0.988926
Validation accuracy = 0.971963
Validation prc-auc = 0.997166
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 26
Validation auc = 0.989480
Validation accuracy = 0.953271
Validation prc-auc = 0.997322
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 27
Loss = 1.5493e-01, PNorm = 68.5927, GNorm = 0.7028, lr_0 = 1.7424e-04
Validation auc = 0.987818
Validation accuracy = 0.962617
Validation prc-auc = 0.996906
Validation f1 = 0.977273
Validation mcc = 0.879514
Epoch 28
Loss = 2.1562e-01, PNorm = 68.6134, GNorm = 1.3243, lr_0 = 1.7424e-04
Validation auc = 0.991141
Validation accuracy = 0.953271
Validation prc-auc = 0.997756
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 29
Loss = 1.7853e-01, PNorm = 68.6325, GNorm = 0.3212, lr_0 = 1.7424e-04
Validation auc = 0.992248
Validation accuracy = 0.953271
Validation prc-auc = 0.998046
Validation f1 = 0.970760
Validation mcc = 0.854863
Model 1 best validation auc = 0.992248 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.992226
Model 1 test accuracy = 0.983333
Model 1 test prc-auc = 0.997775
Model 1 test f1 = 0.989474
Model 1 test mcc = 0.950708
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.947398
Validation accuracy = 0.887850
Validation prc-auc = 0.975138
Validation f1 = 0.934783
Validation mcc = 0.613264
Epoch 1
Loss = 3.6282e-01, PNorm = 67.3890, GNorm = 0.4984, lr_0 = 1.1868e-03
Validation auc = 0.957364
Validation accuracy = 0.934579
Validation prc-auc = 0.984200
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 2
Loss = 2.7963e-01, PNorm = 67.9443, GNorm = 0.4616, lr_0 = 8.0296e-04
Validation auc = 0.956257
Validation accuracy = 0.943925
Validation prc-auc = 0.983933
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 3
Loss = 2.9586e-01, PNorm = 68.1142, GNorm = 0.2203, lr_0 = 3.8068e-04
Validation auc = 0.960133
Validation accuracy = 0.943925
Validation prc-auc = 0.985913
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 4
Loss = 2.5887e-01, PNorm = 68.1469, GNorm = 0.2252, lr_0 = 2.6218e-04
Validation auc = 0.963455
Validation accuracy = 0.934579
Validation prc-auc = 0.987583
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 5
Loss = 2.6189e-01, PNorm = 68.1649, GNorm = 0.2342, lr_0 = 2.5751e-04
Validation auc = 0.964009
Validation accuracy = 0.953271
Validation prc-auc = 0.987722
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 6
Loss = 2.5290e-01, PNorm = 68.1806, GNorm = 0.2500, lr_0 = 2.5246e-04
Validation auc = 0.968439
Validation accuracy = 0.943925
Validation prc-auc = 0.989654
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 7
Loss = 2.5665e-01, PNorm = 68.1949, GNorm = 0.3835, lr_0 = 2.4795e-04
Validation auc = 0.968992
Validation accuracy = 0.953271
Validation prc-auc = 0.989942
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 8
Loss = 2.2569e-01, PNorm = 68.2113, GNorm = 0.2073, lr_0 = 2.4309e-04
Validation auc = 0.973976
Validation accuracy = 0.943925
Validation prc-auc = 0.992249
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 9
Loss = 2.4524e-01, PNorm = 68.2262, GNorm = 0.4412, lr_0 = 2.3876e-04
Validation auc = 0.976190
Validation accuracy = 0.953271
Validation prc-auc = 0.993144
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 10
Loss = 2.4971e-01, PNorm = 68.2428, GNorm = 0.2806, lr_0 = 2.3450e-04
Validation auc = 0.977852
Validation accuracy = 0.962617
Validation prc-auc = 0.993530
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 11
Loss = 2.3766e-01, PNorm = 68.2610, GNorm = 0.4582, lr_0 = 2.2990e-04
Validation auc = 0.978405
Validation accuracy = 0.962617
Validation prc-auc = 0.993901
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 12
Loss = 2.3355e-01, PNorm = 68.2783, GNorm = 0.4522, lr_0 = 2.2580e-04
Validation auc = 0.982835
Validation accuracy = 0.953271
Validation prc-auc = 0.995273
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 13
Loss = 2.2852e-01, PNorm = 68.2965, GNorm = 0.2157, lr_0 = 2.2177e-04
Validation auc = 0.983942
Validation accuracy = 0.953271
Validation prc-auc = 0.995732
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 14
Loss = 2.1072e-01, PNorm = 68.3177, GNorm = 0.3316, lr_0 = 2.1742e-04
Validation auc = 0.984496
Validation accuracy = 0.962617
Validation prc-auc = 0.995869
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 15
Loss = 2.1772e-01, PNorm = 68.3364, GNorm = 0.8870, lr_0 = 2.1354e-04
Validation auc = 0.986711
Validation accuracy = 0.962617
Validation prc-auc = 0.996572
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 16
Loss = 2.3114e-01, PNorm = 68.3563, GNorm = 0.3065, lr_0 = 2.0936e-04
Validation auc = 0.987265
Validation accuracy = 0.971963
Validation prc-auc = 0.996754
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 17
Loss = 2.2472e-01, PNorm = 68.3771, GNorm = 0.2628, lr_0 = 2.0562e-04
Validation auc = 0.987265
Validation accuracy = 0.962617
Validation prc-auc = 0.996765
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 18
Loss = 1.9380e-01, PNorm = 68.3970, GNorm = 0.3306, lr_0 = 2.0195e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.997048
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 19
Loss = 2.1584e-01, PNorm = 68.4149, GNorm = 0.3034, lr_0 = 1.9800e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.997034
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 20
Loss = 1.9904e-01, PNorm = 68.4367, GNorm = 0.5320, lr_0 = 1.9446e-04
Validation auc = 0.985604
Validation accuracy = 0.953271
Validation prc-auc = 0.996366
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 21
Loss = 2.0445e-01, PNorm = 68.4559, GNorm = 0.9317, lr_0 = 1.9099e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.997053
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 22
Loss = 1.8621e-01, PNorm = 68.4775, GNorm = 0.4270, lr_0 = 1.8725e-04
Validation auc = 0.989480
Validation accuracy = 0.962617
Validation prc-auc = 0.997348
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 23
Loss = 1.9277e-01, PNorm = 68.4966, GNorm = 0.5888, lr_0 = 1.8391e-04
Loss = 2.1644e-01, PNorm = 68.4981, GNorm = 0.4823, lr_0 = 1.8358e-04
Validation auc = 0.986711
Validation accuracy = 0.953271
Validation prc-auc = 0.996651
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 24
Loss = 1.9229e-01, PNorm = 68.5159, GNorm = 0.7916, lr_0 = 1.8030e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.997068
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 25
Loss = 1.9078e-01, PNorm = 68.5391, GNorm = 0.5859, lr_0 = 1.7709e-04
Validation auc = 0.988926
Validation accuracy = 0.953271
Validation prc-auc = 0.997244
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 26
Validation auc = 0.991141
Validation accuracy = 0.953271
Validation prc-auc = 0.997769
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 27
Loss = 1.1738e-01, PNorm = 68.5614, GNorm = 0.6210, lr_0 = 1.7424e-04
Validation auc = 0.991141
Validation accuracy = 0.943925
Validation prc-auc = 0.997756
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 28
Loss = 1.6433e-01, PNorm = 68.5812, GNorm = 0.3625, lr_0 = 1.7424e-04
Validation auc = 0.985604
Validation accuracy = 0.962617
Validation prc-auc = 0.996366
Validation f1 = 0.977273
Validation mcc = 0.879514
Epoch 29
Loss = 2.1920e-01, PNorm = 68.6049, GNorm = 0.8429, lr_0 = 1.7424e-04
Validation auc = 0.988372
Validation accuracy = 0.953271
Validation prc-auc = 0.997056
Validation f1 = 0.970760
Validation mcc = 0.854863
Model 2 best validation auc = 0.991141 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.990998
Model 2 test accuracy = 0.975000
Model 2 test prc-auc = 0.997411
Model 2 test f1 = 0.984293
Model 2 test mcc = 0.925881
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.943522
Validation accuracy = 0.943925
Validation prc-auc = 0.971474
Validation f1 = 0.966292
Validation mcc = 0.817130
Epoch 1
Loss = 4.1239e-01, PNorm = 67.4748, GNorm = 0.3712, lr_0 = 1.1868e-03
Validation auc = 0.949059
Validation accuracy = 0.943925
Validation prc-auc = 0.974693
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 2
Loss = 3.5432e-01, PNorm = 68.0274, GNorm = 0.2992, lr_0 = 8.0296e-04
Validation auc = 0.952381
Validation accuracy = 0.934579
Validation prc-auc = 0.977710
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 3
Loss = 2.4024e-01, PNorm = 68.1953, GNorm = 0.2158, lr_0 = 3.8068e-04
Validation auc = 0.955150
Validation accuracy = 0.943925
Validation prc-auc = 0.980589
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 4
Loss = 2.4769e-01, PNorm = 68.2275, GNorm = 0.3547, lr_0 = 2.6218e-04
Validation auc = 0.960687
Validation accuracy = 0.934579
Validation prc-auc = 0.984963
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 5
Loss = 2.2146e-01, PNorm = 68.2437, GNorm = 0.3215, lr_0 = 2.5751e-04
Validation auc = 0.964009
Validation accuracy = 0.943925
Validation prc-auc = 0.986813
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 6
Loss = 2.8023e-01, PNorm = 68.2573, GNorm = 0.7810, lr_0 = 2.5246e-04
Validation auc = 0.967331
Validation accuracy = 0.953271
Validation prc-auc = 0.988292
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 7
Loss = 2.6147e-01, PNorm = 68.2689, GNorm = 0.4458, lr_0 = 2.4795e-04
Validation auc = 0.968992
Validation accuracy = 0.943925
Validation prc-auc = 0.989449
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 8
Loss = 2.3734e-01, PNorm = 68.2809, GNorm = 0.2355, lr_0 = 2.4309e-04
Validation auc = 0.970100
Validation accuracy = 0.953271
Validation prc-auc = 0.989881
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 9
Loss = 2.7322e-01, PNorm = 68.2937, GNorm = 0.3876, lr_0 = 2.3876e-04
Validation auc = 0.972868
Validation accuracy = 0.962617
Validation prc-auc = 0.991284
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 10
Loss = 2.4373e-01, PNorm = 68.3071, GNorm = 0.8174, lr_0 = 2.3450e-04
Validation auc = 0.975637
Validation accuracy = 0.953271
Validation prc-auc = 0.992536
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 11
Loss = 2.4709e-01, PNorm = 68.3239, GNorm = 0.3876, lr_0 = 2.2990e-04
Validation auc = 0.974529
Validation accuracy = 0.971963
Validation prc-auc = 0.992051
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 12
Loss = 2.6505e-01, PNorm = 68.3386, GNorm = 0.3198, lr_0 = 2.2580e-04
Validation auc = 0.978959
Validation accuracy = 0.953271
Validation prc-auc = 0.993892
Validation f1 = 0.970414
Validation mcc = 0.862541
Epoch 13
Loss = 2.2129e-01, PNorm = 68.3531, GNorm = 0.6250, lr_0 = 2.2177e-04
Validation auc = 0.977298
Validation accuracy = 0.971963
Validation prc-auc = 0.993311
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 14
Loss = 2.2260e-01, PNorm = 68.3692, GNorm = 0.8273, lr_0 = 2.1742e-04
Validation auc = 0.979513
Validation accuracy = 0.962617
Validation prc-auc = 0.994015
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 15
Loss = 2.1249e-01, PNorm = 68.3833, GNorm = 0.2565, lr_0 = 2.1354e-04
Validation auc = 0.978959
Validation accuracy = 0.962617
Validation prc-auc = 0.993951
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 16
Loss = 2.1763e-01, PNorm = 68.4012, GNorm = 0.3287, lr_0 = 2.0936e-04
Validation auc = 0.981174
Validation accuracy = 0.971963
Validation prc-auc = 0.994753
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 17
Loss = 2.3089e-01, PNorm = 68.4172, GNorm = 0.5582, lr_0 = 2.0562e-04
Validation auc = 0.981174
Validation accuracy = 0.971963
Validation prc-auc = 0.994753
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 18
Loss = 2.0655e-01, PNorm = 68.4337, GNorm = 0.7979, lr_0 = 2.0195e-04
Validation auc = 0.986157
Validation accuracy = 0.962617
Validation prc-auc = 0.996270
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 19
Loss = 2.2803e-01, PNorm = 68.4500, GNorm = 0.3806, lr_0 = 1.9800e-04
Validation auc = 0.980620
Validation accuracy = 0.971963
Validation prc-auc = 0.994558
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 20
Loss = 2.1566e-01, PNorm = 68.4680, GNorm = 0.4548, lr_0 = 1.9446e-04
Validation auc = 0.987265
Validation accuracy = 0.962617
Validation prc-auc = 0.996570
Validation f1 = 0.976471
Validation mcc = 0.887074
Epoch 21
Loss = 2.0409e-01, PNorm = 68.4838, GNorm = 0.2142, lr_0 = 1.9099e-04
Validation auc = 0.982281
Validation accuracy = 0.971963
Validation prc-auc = 0.995224
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 22
Loss = 2.1443e-01, PNorm = 68.5015, GNorm = 0.4269, lr_0 = 1.8725e-04
Validation auc = 0.984496
Validation accuracy = 0.962617
Validation prc-auc = 0.995929
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 23
Loss = 2.0548e-01, PNorm = 68.5200, GNorm = 1.5619, lr_0 = 1.8391e-04
Loss = 2.6179e-01, PNorm = 68.5216, GNorm = 0.3425, lr_0 = 1.8358e-04
Validation auc = 0.987818
Validation accuracy = 0.962617
Validation prc-auc = 0.996809
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 24
Loss = 2.0892e-01, PNorm = 68.5382, GNorm = 0.3013, lr_0 = 1.8030e-04
Validation auc = 0.981174
Validation accuracy = 0.953271
Validation prc-auc = 0.994911
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 25
Loss = 2.2250e-01, PNorm = 68.5537, GNorm = 0.5749, lr_0 = 1.7709e-04
Validation auc = 0.986157
Validation accuracy = 0.953271
Validation prc-auc = 0.996360
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 26
Validation auc = 0.985604
Validation accuracy = 0.953271
Validation prc-auc = 0.996209
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 27
Loss = 1.6468e-01, PNorm = 68.5730, GNorm = 0.3384, lr_0 = 1.7424e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.996974
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 28
Loss = 1.3917e-01, PNorm = 68.5918, GNorm = 0.8285, lr_0 = 1.7424e-04
Validation auc = 0.986711
Validation accuracy = 0.962617
Validation prc-auc = 0.996504
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 29
Loss = 2.1635e-01, PNorm = 68.6112, GNorm = 0.3627, lr_0 = 1.7424e-04
Validation auc = 0.988372
Validation accuracy = 0.962617
Validation prc-auc = 0.996999
Validation f1 = 0.976744
Validation mcc = 0.881506
Model 3 best validation auc = 0.988372 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.991817
Model 3 test accuracy = 0.975000
Model 3 test prc-auc = 0.997660
Model 3 test f1 = 0.984293
Model 3 test mcc = 0.925881
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.945736
Validation accuracy = 0.897196
Validation prc-auc = 0.970965
Validation f1 = 0.939891
Validation mcc = 0.649761
Epoch 1
Loss = 3.4074e-01, PNorm = 67.4117, GNorm = 0.2699, lr_0 = 1.1868e-03
Validation auc = 0.948505
Validation accuracy = 0.934579
Validation prc-auc = 0.978058
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 2
Loss = 2.6145e-01, PNorm = 67.9693, GNorm = 0.2884, lr_0 = 8.0296e-04
Validation auc = 0.954596
Validation accuracy = 0.943925
Validation prc-auc = 0.981383
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 3
Loss = 1.8435e-01, PNorm = 68.1406, GNorm = 0.3897, lr_0 = 3.8068e-04
Validation auc = 0.959579
Validation accuracy = 0.943925
Validation prc-auc = 0.984390
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 4
Loss = 2.6702e-01, PNorm = 68.1742, GNorm = 0.2698, lr_0 = 2.6218e-04
Validation auc = 0.962348
Validation accuracy = 0.943925
Validation prc-auc = 0.986435
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 5
Loss = 2.7680e-01, PNorm = 68.1925, GNorm = 0.2777, lr_0 = 2.5751e-04
Validation auc = 0.965116
Validation accuracy = 0.953271
Validation prc-auc = 0.987981
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 6
Loss = 2.6444e-01, PNorm = 68.2072, GNorm = 0.3322, lr_0 = 2.5246e-04
Validation auc = 0.967885
Validation accuracy = 0.943925
Validation prc-auc = 0.989360
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 7
Loss = 2.6157e-01, PNorm = 68.2211, GNorm = 0.2121, lr_0 = 2.4795e-04
Validation auc = 0.965670
Validation accuracy = 0.943925
Validation prc-auc = 0.988495
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 8
Loss = 2.5854e-01, PNorm = 68.2364, GNorm = 0.3379, lr_0 = 2.4309e-04
Validation auc = 0.968439
Validation accuracy = 0.943925
Validation prc-auc = 0.990125
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 9
Loss = 2.5362e-01, PNorm = 68.2508, GNorm = 0.4025, lr_0 = 2.3876e-04
Validation auc = 0.969546
Validation accuracy = 0.943925
Validation prc-auc = 0.990654
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 10
Loss = 2.4263e-01, PNorm = 68.2668, GNorm = 0.2268, lr_0 = 2.3450e-04
Validation auc = 0.975083
Validation accuracy = 0.953271
Validation prc-auc = 0.992723
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 11
Loss = 2.6248e-01, PNorm = 68.2840, GNorm = 0.4118, lr_0 = 2.2990e-04
Validation auc = 0.974529
Validation accuracy = 0.962617
Validation prc-auc = 0.992480
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 12
Loss = 2.3747e-01, PNorm = 68.2992, GNorm = 0.2313, lr_0 = 2.2580e-04
Validation auc = 0.978405
Validation accuracy = 0.962617
Validation prc-auc = 0.993904
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 13
Loss = 2.3930e-01, PNorm = 68.3149, GNorm = 0.6629, lr_0 = 2.2177e-04
Validation auc = 0.981174
Validation accuracy = 0.953271
Validation prc-auc = 0.994823
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 14
Loss = 2.3115e-01, PNorm = 68.3340, GNorm = 0.2512, lr_0 = 2.1742e-04
Validation auc = 0.981728
Validation accuracy = 0.962617
Validation prc-auc = 0.995012
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 15
Loss = 2.1024e-01, PNorm = 68.3532, GNorm = 0.4556, lr_0 = 2.1354e-04
Validation auc = 0.983389
Validation accuracy = 0.962617
Validation prc-auc = 0.995645
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 16
Loss = 2.2764e-01, PNorm = 68.3681, GNorm = 0.3236, lr_0 = 2.0936e-04
Validation auc = 0.982281
Validation accuracy = 0.953271
Validation prc-auc = 0.995343
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 17
Loss = 2.0875e-01, PNorm = 68.3822, GNorm = 0.3863, lr_0 = 2.0562e-04
Validation auc = 0.984496
Validation accuracy = 0.962617
Validation prc-auc = 0.995956
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 18
Loss = 2.2512e-01, PNorm = 68.3993, GNorm = 0.8190, lr_0 = 2.0195e-04
Validation auc = 0.982281
Validation accuracy = 0.953271
Validation prc-auc = 0.995377
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 19
Loss = 1.9198e-01, PNorm = 68.4154, GNorm = 0.4566, lr_0 = 1.9800e-04
Validation auc = 0.986157
Validation accuracy = 0.962617
Validation prc-auc = 0.996458
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 20
Loss = 1.9941e-01, PNorm = 68.4332, GNorm = 0.7840, lr_0 = 1.9446e-04
Validation auc = 0.988926
Validation accuracy = 0.934579
Validation prc-auc = 0.997192
Validation f1 = 0.958580
Validation mcc = 0.806128
Epoch 21
Loss = 2.0897e-01, PNorm = 68.4474, GNorm = 1.1273, lr_0 = 1.9099e-04
Validation auc = 0.983942
Validation accuracy = 0.953271
Validation prc-auc = 0.995860
Validation f1 = 0.971429
Validation mcc = 0.847176
Epoch 22
Loss = 1.8965e-01, PNorm = 68.4679, GNorm = 0.6968, lr_0 = 1.8725e-04
Validation auc = 0.985604
Validation accuracy = 0.962617
Validation prc-auc = 0.996256
Validation f1 = 0.976744
Validation mcc = 0.881506
Epoch 23
Loss = 2.0336e-01, PNorm = 68.4862, GNorm = 0.6705, lr_0 = 1.8391e-04
Loss = 1.7770e-01, PNorm = 68.4880, GNorm = 0.3803, lr_0 = 1.8358e-04
Validation auc = 0.985604
Validation accuracy = 0.962617
Validation prc-auc = 0.996370
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 24
Loss = 2.0196e-01, PNorm = 68.5062, GNorm = 1.5064, lr_0 = 1.8030e-04
Validation auc = 0.988372
Validation accuracy = 0.953271
Validation prc-auc = 0.997068
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 25
Loss = 2.0575e-01, PNorm = 68.5220, GNorm = 1.1452, lr_0 = 1.7709e-04
Validation auc = 0.990033
Validation accuracy = 0.943925
Validation prc-auc = 0.997463
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 26
Validation auc = 0.988372
Validation accuracy = 0.971963
Validation prc-auc = 0.997034
Validation f1 = 0.982659
Validation mcc = 0.909915
Epoch 27
Loss = 1.3019e-01, PNorm = 68.5394, GNorm = 0.3152, lr_0 = 1.7424e-04
Validation auc = 0.990587
Validation accuracy = 0.953271
Validation prc-auc = 0.997602
Validation f1 = 0.970760
Validation mcc = 0.854863
Epoch 28
Loss = 2.3893e-01, PNorm = 68.5587, GNorm = 0.3955, lr_0 = 1.7424e-04
Validation auc = 0.990033
Validation accuracy = 0.943925
Validation prc-auc = 0.997463
Validation f1 = 0.964706
Validation mcc = 0.829792
Epoch 29
Loss = 1.9053e-01, PNorm = 68.5793, GNorm = 0.6312, lr_0 = 1.7424e-04
Validation auc = 0.989480
Validation accuracy = 0.943925
Validation prc-auc = 0.997322
Validation f1 = 0.964706
Validation mcc = 0.829792
Model 4 best validation auc = 0.990587 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.989771
Model 4 test accuracy = 0.975000
Model 4 test prc-auc = 0.997024
Model 4 test f1 = 0.984293
Model 4 test mcc = 0.925881
Ensemble test auc = 0.990998
Ensemble test accuracy = 0.975000
Ensemble test prc-auc = 0.997411
Ensemble test f1 = 0.984293
Ensemble test mcc = 0.925881
Fold 1
Splitting data with seed 1
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.777778
Validation accuracy = 0.897196
Validation prc-auc = 0.931115
Validation f1 = 0.941176
Validation mcc = 0.583840
Epoch 1
Loss = 3.2915e-01, PNorm = 67.4541, GNorm = 0.2590, lr_0 = 1.1868e-03
Validation auc = 0.783396
Validation accuracy = 0.850467
Validation prc-auc = 0.930230
Validation f1 = 0.912088
Validation mcc = 0.418216
Epoch 2
Loss = 3.0608e-01, PNorm = 68.0091, GNorm = 0.2490, lr_0 = 8.0296e-04
Validation auc = 0.798377
Validation accuracy = 0.869159
Validation prc-auc = 0.936653
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 3
Loss = 2.3699e-01, PNorm = 68.1763, GNorm = 0.3727, lr_0 = 3.8068e-04
Validation auc = 0.798377
Validation accuracy = 0.859813
Validation prc-auc = 0.934489
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 4
Loss = 2.7087e-01, PNorm = 68.2080, GNorm = 0.1791, lr_0 = 2.6218e-04
Validation auc = 0.807116
Validation accuracy = 0.869159
Validation prc-auc = 0.937126
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 5
Loss = 1.8926e-01, PNorm = 68.2236, GNorm = 0.4237, lr_0 = 2.5751e-04
Validation auc = 0.812734
Validation accuracy = 0.869159
Validation prc-auc = 0.939425
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 6
Loss = 2.1945e-01, PNorm = 68.2354, GNorm = 0.1977, lr_0 = 2.5246e-04
Validation auc = 0.819600
Validation accuracy = 0.869159
Validation prc-auc = 0.941974
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 7
Loss = 2.9053e-01, PNorm = 68.2449, GNorm = 0.3175, lr_0 = 2.4795e-04
Validation auc = 0.824594
Validation accuracy = 0.869159
Validation prc-auc = 0.943984
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 8
Loss = 2.5109e-01, PNorm = 68.2559, GNorm = 0.2326, lr_0 = 2.4309e-04
Validation auc = 0.830212
Validation accuracy = 0.869159
Validation prc-auc = 0.946149
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 9
Loss = 2.4957e-01, PNorm = 68.2669, GNorm = 0.5185, lr_0 = 2.3876e-04
Validation auc = 0.835830
Validation accuracy = 0.869159
Validation prc-auc = 0.943723
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 10
Loss = 2.9121e-01, PNorm = 68.2781, GNorm = 0.7688, lr_0 = 2.3450e-04
Validation auc = 0.841448
Validation accuracy = 0.878505
Validation prc-auc = 0.948425
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 11
Loss = 2.3296e-01, PNorm = 68.2891, GNorm = 0.4394, lr_0 = 2.2990e-04
Validation auc = 0.843945
Validation accuracy = 0.869159
Validation prc-auc = 0.946139
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 12
Loss = 2.2449e-01, PNorm = 68.3015, GNorm = 0.3850, lr_0 = 2.2580e-04
Validation auc = 0.848939
Validation accuracy = 0.869159
Validation prc-auc = 0.947614
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 13
Loss = 2.2859e-01, PNorm = 68.3144, GNorm = 0.4080, lr_0 = 2.2177e-04
Validation auc = 0.850811
Validation accuracy = 0.878505
Validation prc-auc = 0.948270
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 14
Loss = 2.1122e-01, PNorm = 68.3290, GNorm = 0.4579, lr_0 = 2.1742e-04
Validation auc = 0.859551
Validation accuracy = 0.878505
Validation prc-auc = 0.948935
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 15
Loss = 2.0550e-01, PNorm = 68.3424, GNorm = 0.3059, lr_0 = 2.1354e-04
Validation auc = 0.864544
Validation accuracy = 0.878505
Validation prc-auc = 0.950124
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 16
Loss = 1.9767e-01, PNorm = 68.3564, GNorm = 0.2362, lr_0 = 2.0936e-04
Validation auc = 0.870162
Validation accuracy = 0.878505
Validation prc-auc = 0.955012
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 17
Loss = 1.9591e-01, PNorm = 68.3700, GNorm = 0.2371, lr_0 = 2.0562e-04
Validation auc = 0.872035
Validation accuracy = 0.878505
Validation prc-auc = 0.955473
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 18
Loss = 2.0604e-01, PNorm = 68.3864, GNorm = 0.4481, lr_0 = 2.0195e-04
Validation auc = 0.872035
Validation accuracy = 0.887850
Validation prc-auc = 0.952077
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 19
Loss = 2.2048e-01, PNorm = 68.4008, GNorm = 0.2951, lr_0 = 1.9800e-04
Validation auc = 0.874532
Validation accuracy = 0.878505
Validation prc-auc = 0.954656
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 20
Loss = 2.2014e-01, PNorm = 68.4146, GNorm = 0.6321, lr_0 = 1.9446e-04
Validation auc = 0.878277
Validation accuracy = 0.887850
Validation prc-auc = 0.958372
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 21
Loss = 1.8411e-01, PNorm = 68.4306, GNorm = 0.2783, lr_0 = 1.9099e-04
Validation auc = 0.870162
Validation accuracy = 0.887850
Validation prc-auc = 0.956575
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 22
Loss = 1.9297e-01, PNorm = 68.4469, GNorm = 0.4820, lr_0 = 1.8725e-04
Validation auc = 0.874532
Validation accuracy = 0.897196
Validation prc-auc = 0.957555
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 23
Loss = 1.9753e-01, PNorm = 68.4601, GNorm = 0.2918, lr_0 = 1.8391e-04
Loss = 1.7460e-01, PNorm = 68.4617, GNorm = 0.6992, lr_0 = 1.8358e-04
Validation auc = 0.878277
Validation accuracy = 0.897196
Validation prc-auc = 0.961532
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 24
Loss = 1.9637e-01, PNorm = 68.4782, GNorm = 1.3853, lr_0 = 1.8030e-04
Validation auc = 0.880774
Validation accuracy = 0.887850
Validation prc-auc = 0.961121
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 25
Loss = 1.9474e-01, PNorm = 68.4925, GNorm = 0.4811, lr_0 = 1.7709e-04
Validation auc = 0.880150
Validation accuracy = 0.897196
Validation prc-auc = 0.962975
Validation f1 = 0.939891
Validation mcc = 0.597502
Epoch 26
Validation auc = 0.887640
Validation accuracy = 0.887850
Validation prc-auc = 0.967195
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 27
Loss = 8.0278e-02, PNorm = 68.5095, GNorm = 0.3522, lr_0 = 1.7424e-04
Validation auc = 0.882647
Validation accuracy = 0.897196
Validation prc-auc = 0.965592
Validation f1 = 0.939891
Validation mcc = 0.597502
Epoch 28
Loss = 2.9710e-01, PNorm = 68.5248, GNorm = 0.8184, lr_0 = 1.7424e-04
Validation auc = 0.889513
Validation accuracy = 0.897196
Validation prc-auc = 0.969849
Validation f1 = 0.941176
Validation mcc = 0.583840
Epoch 29
Loss = 1.8335e-01, PNorm = 68.5398, GNorm = 0.5635, lr_0 = 1.7424e-04
Validation auc = 0.890762
Validation accuracy = 0.897196
Validation prc-auc = 0.970288
Validation f1 = 0.940541
Validation mcc = 0.588164
Model 0 best validation auc = 0.890762 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.987316
Model 0 test accuracy = 0.975000
Model 0 test prc-auc = 0.996277
Model 0 test f1 = 0.984293
Model 0 test mcc = 0.925881
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.772784
Validation accuracy = 0.887850
Validation prc-auc = 0.917225
Validation f1 = 0.936842
Validation mcc = 0.541968
Epoch 1
Loss = 4.2949e-01, PNorm = 67.4448, GNorm = 0.7570, lr_0 = 1.1868e-03
Validation auc = 0.786517
Validation accuracy = 0.859813
Validation prc-auc = 0.918905
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 2
Loss = 2.8616e-01, PNorm = 68.0012, GNorm = 0.2302, lr_0 = 8.0296e-04
Validation auc = 0.801498
Validation accuracy = 0.869159
Validation prc-auc = 0.924263
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 3
Loss = 2.0304e-01, PNorm = 68.1732, GNorm = 0.2857, lr_0 = 3.8068e-04
Validation auc = 0.805868
Validation accuracy = 0.869159
Validation prc-auc = 0.926636
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 4
Loss = 2.6178e-01, PNorm = 68.2068, GNorm = 0.2650, lr_0 = 2.6218e-04
Validation auc = 0.815231
Validation accuracy = 0.869159
Validation prc-auc = 0.925428
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 5
Loss = 1.8263e-01, PNorm = 68.2242, GNorm = 0.4137, lr_0 = 2.5751e-04
Validation auc = 0.819600
Validation accuracy = 0.869159
Validation prc-auc = 0.927055
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 6
Loss = 2.6175e-01, PNorm = 68.2381, GNorm = 0.3685, lr_0 = 2.5246e-04
Validation auc = 0.829588
Validation accuracy = 0.869159
Validation prc-auc = 0.930272
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 7
Loss = 2.3131e-01, PNorm = 68.2495, GNorm = 0.3526, lr_0 = 2.4795e-04
Validation auc = 0.837703
Validation accuracy = 0.869159
Validation prc-auc = 0.933053
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 8
Loss = 2.2508e-01, PNorm = 68.2639, GNorm = 0.3224, lr_0 = 2.4309e-04
Validation auc = 0.845818
Validation accuracy = 0.869159
Validation prc-auc = 0.935291
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 9
Loss = 2.2560e-01, PNorm = 68.2784, GNorm = 0.2759, lr_0 = 2.3876e-04
Validation auc = 0.854557
Validation accuracy = 0.878505
Validation prc-auc = 0.937609
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 10
Loss = 2.1303e-01, PNorm = 68.2903, GNorm = 0.2946, lr_0 = 2.3450e-04
Validation auc = 0.857054
Validation accuracy = 0.878505
Validation prc-auc = 0.938343
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 11
Loss = 2.5626e-01, PNorm = 68.3054, GNorm = 0.4732, lr_0 = 2.2990e-04
Validation auc = 0.860799
Validation accuracy = 0.878505
Validation prc-auc = 0.943714
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 12
Loss = 2.0030e-01, PNorm = 68.3173, GNorm = 0.2404, lr_0 = 2.2580e-04
Validation auc = 0.863296
Validation accuracy = 0.878505
Validation prc-auc = 0.944286
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 13
Loss = 1.9598e-01, PNorm = 68.3324, GNorm = 0.4146, lr_0 = 2.2177e-04
Validation auc = 0.864544
Validation accuracy = 0.887850
Validation prc-auc = 0.944681
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 14
Loss = 2.1217e-01, PNorm = 68.3478, GNorm = 0.3589, lr_0 = 2.1742e-04
Validation auc = 0.866417
Validation accuracy = 0.878505
Validation prc-auc = 0.944999
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 15
Loss = 2.1634e-01, PNorm = 68.3629, GNorm = 0.4129, lr_0 = 2.1354e-04
Validation auc = 0.868914
Validation accuracy = 0.887850
Validation prc-auc = 0.945735
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 16
Loss = 1.8671e-01, PNorm = 68.3803, GNorm = 0.6626, lr_0 = 2.0936e-04
Validation auc = 0.869538
Validation accuracy = 0.897196
Validation prc-auc = 0.945903
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 17
Loss = 2.3027e-01, PNorm = 68.3950, GNorm = 0.8305, lr_0 = 2.0562e-04
Validation auc = 0.872659
Validation accuracy = 0.887850
Validation prc-auc = 0.953958
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 18
Loss = 1.9615e-01, PNorm = 68.4090, GNorm = 0.2762, lr_0 = 2.0195e-04
Validation auc = 0.873908
Validation accuracy = 0.887850
Validation prc-auc = 0.954446
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 19
Loss = 2.0511e-01, PNorm = 68.4272, GNorm = 0.3463, lr_0 = 1.9800e-04
Validation auc = 0.875156
Validation accuracy = 0.887850
Validation prc-auc = 0.954661
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 20
Loss = 1.9899e-01, PNorm = 68.4429, GNorm = 0.1986, lr_0 = 1.9446e-04
Validation auc = 0.875156
Validation accuracy = 0.897196
Validation prc-auc = 0.954791
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 21
Loss = 2.0517e-01, PNorm = 68.4599, GNorm = 0.5107, lr_0 = 1.9099e-04
Validation auc = 0.883271
Validation accuracy = 0.887850
Validation prc-auc = 0.964181
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 22
Loss = 1.9868e-01, PNorm = 68.4792, GNorm = 0.2793, lr_0 = 1.8725e-04
Validation auc = 0.883895
Validation accuracy = 0.887850
Validation prc-auc = 0.964457
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 23
Loss = 1.9157e-01, PNorm = 68.4968, GNorm = 0.5284, lr_0 = 1.8391e-04
Loss = 1.5229e-01, PNorm = 68.4986, GNorm = 0.9644, lr_0 = 1.8358e-04
Validation auc = 0.882022
Validation accuracy = 0.897196
Validation prc-auc = 0.963177
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 24
Loss = 1.9129e-01, PNorm = 68.5159, GNorm = 0.8548, lr_0 = 1.8030e-04
Validation auc = 0.880150
Validation accuracy = 0.897196
Validation prc-auc = 0.962735
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 25
Loss = 1.8243e-01, PNorm = 68.5326, GNorm = 0.4398, lr_0 = 1.7709e-04
Validation auc = 0.878277
Validation accuracy = 0.897196
Validation prc-auc = 0.961587
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 26
Validation auc = 0.880150
Validation accuracy = 0.887850
Validation prc-auc = 0.960840
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 27
Loss = 1.2673e-01, PNorm = 68.5534, GNorm = 0.6286, lr_0 = 1.7424e-04
Validation auc = 0.882022
Validation accuracy = 0.897196
Validation prc-auc = 0.963892
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 28
Loss = 2.2126e-01, PNorm = 68.5706, GNorm = 0.2960, lr_0 = 1.7424e-04
Validation auc = 0.886392
Validation accuracy = 0.897196
Validation prc-auc = 0.967752
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 29
Loss = 2.0034e-01, PNorm = 68.5912, GNorm = 0.2421, lr_0 = 1.7424e-04
Validation auc = 0.882022
Validation accuracy = 0.897196
Validation prc-auc = 0.966463
Validation f1 = 0.940541
Validation mcc = 0.588164
Model 1 best validation auc = 0.886392 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.989771
Model 1 test accuracy = 0.958333
Model 1 test prc-auc = 0.997024
Model 1 test f1 = 0.974093
Model 1 test mcc = 0.875728
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.787765
Validation accuracy = 0.887850
Validation prc-auc = 0.932417
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 1
Loss = 2.8993e-01, PNorm = 67.3834, GNorm = 0.3223, lr_0 = 1.1868e-03
Validation auc = 0.802122
Validation accuracy = 0.869159
Validation prc-auc = 0.934801
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 2
Loss = 4.0704e-01, PNorm = 67.9429, GNorm = 0.4618, lr_0 = 8.0296e-04
Validation auc = 0.815855
Validation accuracy = 0.859813
Validation prc-auc = 0.939343
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 3
Loss = 2.4622e-01, PNorm = 68.1157, GNorm = 0.2786, lr_0 = 3.8068e-04
Validation auc = 0.821473
Validation accuracy = 0.869159
Validation prc-auc = 0.941272
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 4
Loss = 2.7270e-01, PNorm = 68.1518, GNorm = 0.2722, lr_0 = 2.6218e-04
Validation auc = 0.832709
Validation accuracy = 0.869159
Validation prc-auc = 0.939010
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 5
Loss = 1.8927e-01, PNorm = 68.1711, GNorm = 0.3328, lr_0 = 2.5751e-04
Validation auc = 0.839576
Validation accuracy = 0.869159
Validation prc-auc = 0.938071
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 6
Loss = 2.2099e-01, PNorm = 68.1889, GNorm = 0.2199, lr_0 = 2.5246e-04
Validation auc = 0.850187
Validation accuracy = 0.869159
Validation prc-auc = 0.941074
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 7
Loss = 2.1062e-01, PNorm = 68.2029, GNorm = 0.2689, lr_0 = 2.4795e-04
Validation auc = 0.856429
Validation accuracy = 0.887850
Validation prc-auc = 0.929951
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 8
Loss = 1.7896e-01, PNorm = 68.2196, GNorm = 0.2727, lr_0 = 2.4309e-04
Validation auc = 0.860175
Validation accuracy = 0.887850
Validation prc-auc = 0.930871
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 9
Loss = 2.2200e-01, PNorm = 68.2354, GNorm = 0.3246, lr_0 = 2.3876e-04
Validation auc = 0.863920
Validation accuracy = 0.887850
Validation prc-auc = 0.931842
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 10
Loss = 1.9122e-01, PNorm = 68.2511, GNorm = 0.2773, lr_0 = 2.3450e-04
Validation auc = 0.868290
Validation accuracy = 0.887850
Validation prc-auc = 0.945714
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 11
Loss = 2.1137e-01, PNorm = 68.2674, GNorm = 0.4722, lr_0 = 2.2990e-04
Validation auc = 0.870787
Validation accuracy = 0.887850
Validation prc-auc = 0.946354
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 12
Loss = 2.0171e-01, PNorm = 68.2855, GNorm = 0.4754, lr_0 = 2.2580e-04
Validation auc = 0.872659
Validation accuracy = 0.887850
Validation prc-auc = 0.949860
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 13
Loss = 2.0192e-01, PNorm = 68.3014, GNorm = 0.7989, lr_0 = 2.2177e-04
Validation auc = 0.870787
Validation accuracy = 0.897196
Validation prc-auc = 0.949475
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 14
Loss = 2.1623e-01, PNorm = 68.3197, GNorm = 0.4762, lr_0 = 2.1742e-04
Validation auc = 0.868914
Validation accuracy = 0.897196
Validation prc-auc = 0.951446
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 15
Loss = 1.9650e-01, PNorm = 68.3377, GNorm = 0.2781, lr_0 = 2.1354e-04
Validation auc = 0.873908
Validation accuracy = 0.897196
Validation prc-auc = 0.947007
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 16
Loss = 2.0646e-01, PNorm = 68.3580, GNorm = 0.6889, lr_0 = 2.0936e-04
Validation auc = 0.877029
Validation accuracy = 0.897196
Validation prc-auc = 0.956796
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 17
Loss = 2.1815e-01, PNorm = 68.3750, GNorm = 1.3421, lr_0 = 2.0562e-04
Validation auc = 0.885144
Validation accuracy = 0.887850
Validation prc-auc = 0.965378
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 18
Loss = 1.9400e-01, PNorm = 68.3960, GNorm = 0.1970, lr_0 = 2.0195e-04
Validation auc = 0.882022
Validation accuracy = 0.897196
Validation prc-auc = 0.962504
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 19
Loss = 1.8548e-01, PNorm = 68.4193, GNorm = 0.1816, lr_0 = 1.9800e-04
Validation auc = 0.883271
Validation accuracy = 0.887850
Validation prc-auc = 0.963466
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 20
Loss = 1.8279e-01, PNorm = 68.4385, GNorm = 0.4450, lr_0 = 1.9446e-04
Validation auc = 0.883895
Validation accuracy = 0.897196
Validation prc-auc = 0.962897
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 21
Loss = 1.7782e-01, PNorm = 68.4569, GNorm = 1.0044, lr_0 = 1.9099e-04
Validation auc = 0.887640
Validation accuracy = 0.897196
Validation prc-auc = 0.963493
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 22
Loss = 1.7448e-01, PNorm = 68.4777, GNorm = 0.2819, lr_0 = 1.8725e-04
Validation auc = 0.885144
Validation accuracy = 0.897196
Validation prc-auc = 0.966058
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 23
Loss = 1.7437e-01, PNorm = 68.4982, GNorm = 0.4300, lr_0 = 1.8391e-04
Loss = 2.4403e-01, PNorm = 68.5000, GNorm = 1.4594, lr_0 = 1.8358e-04
Validation auc = 0.896380
Validation accuracy = 0.897196
Validation prc-auc = 0.972226
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 24
Loss = 1.8047e-01, PNorm = 68.5202, GNorm = 0.5830, lr_0 = 1.8030e-04
Validation auc = 0.898252
Validation accuracy = 0.887850
Validation prc-auc = 0.972622
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 25
Loss = 1.8540e-01, PNorm = 68.5383, GNorm = 0.6344, lr_0 = 1.7709e-04
Validation auc = 0.898252
Validation accuracy = 0.897196
Validation prc-auc = 0.974669
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 26
Validation auc = 0.904494
Validation accuracy = 0.897196
Validation prc-auc = 0.976151
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 27
Loss = 2.0307e-01, PNorm = 68.5606, GNorm = 0.7442, lr_0 = 1.7424e-04
Validation auc = 0.893258
Validation accuracy = 0.897196
Validation prc-auc = 0.972086
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 28
Loss = 1.1458e-01, PNorm = 68.5833, GNorm = 0.4977, lr_0 = 1.7424e-04
Validation auc = 0.895131
Validation accuracy = 0.897196
Validation prc-auc = 0.973360
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 29
Loss = 1.9432e-01, PNorm = 68.6042, GNorm = 0.2579, lr_0 = 1.7424e-04
Validation auc = 0.911361
Validation accuracy = 0.897196
Validation prc-auc = 0.978879
Validation f1 = 0.941176
Validation mcc = 0.583840
Model 2 best validation auc = 0.911361 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.989771
Model 2 test accuracy = 0.958333
Model 2 test prc-auc = 0.996968
Model 2 test f1 = 0.974093
Model 2 test mcc = 0.875728
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.781523
Validation accuracy = 0.887850
Validation prc-auc = 0.930034
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 1
Loss = 2.9015e-01, PNorm = 67.4783, GNorm = 0.2276, lr_0 = 1.1868e-03
Validation auc = 0.790262
Validation accuracy = 0.859813
Validation prc-auc = 0.930847
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 2
Loss = 2.6420e-01, PNorm = 68.0344, GNorm = 0.2541, lr_0 = 8.0296e-04
Validation auc = 0.799625
Validation accuracy = 0.869159
Validation prc-auc = 0.934466
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 3
Loss = 2.0990e-01, PNorm = 68.2032, GNorm = 0.1913, lr_0 = 3.8068e-04
Validation auc = 0.805243
Validation accuracy = 0.859813
Validation prc-auc = 0.936458
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 4
Loss = 2.0333e-01, PNorm = 68.2349, GNorm = 0.2558, lr_0 = 2.6218e-04
Validation auc = 0.812110
Validation accuracy = 0.869159
Validation prc-auc = 0.939018
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 5
Loss = 2.9385e-01, PNorm = 68.2496, GNorm = 0.2281, lr_0 = 2.5751e-04
Validation auc = 0.817104
Validation accuracy = 0.869159
Validation prc-auc = 0.940873
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 6
Loss = 2.4323e-01, PNorm = 68.2616, GNorm = 0.2192, lr_0 = 2.5246e-04
Validation auc = 0.823346
Validation accuracy = 0.869159
Validation prc-auc = 0.943751
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 7
Loss = 1.8167e-01, PNorm = 68.2719, GNorm = 0.1964, lr_0 = 2.4795e-04
Validation auc = 0.826467
Validation accuracy = 0.869159
Validation prc-auc = 0.943765
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 8
Loss = 2.5375e-01, PNorm = 68.2829, GNorm = 0.3681, lr_0 = 2.4309e-04
Validation auc = 0.835830
Validation accuracy = 0.869159
Validation prc-auc = 0.945300
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 9
Loss = 2.1483e-01, PNorm = 68.2938, GNorm = 0.4679, lr_0 = 2.3876e-04
Validation auc = 0.841448
Validation accuracy = 0.878505
Validation prc-auc = 0.943855
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 10
Loss = 1.9658e-01, PNorm = 68.3052, GNorm = 0.5029, lr_0 = 2.3450e-04
Validation auc = 0.845818
Validation accuracy = 0.878505
Validation prc-auc = 0.942935
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 11
Loss = 2.1528e-01, PNorm = 68.3193, GNorm = 0.2569, lr_0 = 2.2990e-04
Validation auc = 0.850811
Validation accuracy = 0.878505
Validation prc-auc = 0.936728
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 12
Loss = 2.1632e-01, PNorm = 68.3322, GNorm = 0.3146, lr_0 = 2.2580e-04
Validation auc = 0.858926
Validation accuracy = 0.878505
Validation prc-auc = 0.943486
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 13
Loss = 1.7896e-01, PNorm = 68.3453, GNorm = 0.5983, lr_0 = 2.2177e-04
Validation auc = 0.862672
Validation accuracy = 0.878505
Validation prc-auc = 0.947625
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 14
Loss = 2.1514e-01, PNorm = 68.3600, GNorm = 0.2774, lr_0 = 2.1742e-04
Validation auc = 0.866417
Validation accuracy = 0.887850
Validation prc-auc = 0.948418
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 15
Loss = 2.2480e-01, PNorm = 68.3738, GNorm = 0.7563, lr_0 = 2.1354e-04
Validation auc = 0.872035
Validation accuracy = 0.887850
Validation prc-auc = 0.952155
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 16
Loss = 2.0180e-01, PNorm = 68.3889, GNorm = 0.5408, lr_0 = 2.0936e-04
Validation auc = 0.873283
Validation accuracy = 0.887850
Validation prc-auc = 0.952470
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 17
Loss = 2.0565e-01, PNorm = 68.4036, GNorm = 0.4264, lr_0 = 2.0562e-04
Validation auc = 0.873283
Validation accuracy = 0.897196
Validation prc-auc = 0.952481
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 18
Loss = 2.2024e-01, PNorm = 68.4194, GNorm = 0.7757, lr_0 = 2.0195e-04
Validation auc = 0.873283
Validation accuracy = 0.897196
Validation prc-auc = 0.954334
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 19
Loss = 2.1666e-01, PNorm = 68.4369, GNorm = 0.8387, lr_0 = 1.9800e-04
Validation auc = 0.868290
Validation accuracy = 0.878505
Validation prc-auc = 0.953435
Validation f1 = 0.928962
Validation mcc = 0.521028
Epoch 20
Loss = 1.9681e-01, PNorm = 68.4497, GNorm = 0.3230, lr_0 = 1.9446e-04
Validation auc = 0.876404
Validation accuracy = 0.897196
Validation prc-auc = 0.959171
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 21
Loss = 1.9544e-01, PNorm = 68.4638, GNorm = 1.5090, lr_0 = 1.9099e-04
Validation auc = 0.878901
Validation accuracy = 0.887850
Validation prc-auc = 0.959685
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 22
Loss = 1.9447e-01, PNorm = 68.4812, GNorm = 0.4379, lr_0 = 1.8725e-04
Validation auc = 0.878901
Validation accuracy = 0.897196
Validation prc-auc = 0.960778
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 23
Loss = 1.9800e-01, PNorm = 68.4963, GNorm = 0.5072, lr_0 = 1.8391e-04
Loss = 1.3293e-01, PNorm = 68.4980, GNorm = 0.3260, lr_0 = 1.8358e-04
Validation auc = 0.876404
Validation accuracy = 0.897196
Validation prc-auc = 0.958128
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 24
Loss = 1.9577e-01, PNorm = 68.5147, GNorm = 0.8862, lr_0 = 1.8030e-04
Validation auc = 0.881398
Validation accuracy = 0.897196
Validation prc-auc = 0.964988
Validation f1 = 0.941176
Validation mcc = 0.583840
Epoch 25
Loss = 1.9721e-01, PNorm = 68.5268, GNorm = 0.8152, lr_0 = 1.7709e-04
Validation auc = 0.891386
Validation accuracy = 0.897196
Validation prc-auc = 0.967417
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 26
Validation auc = 0.892634
Validation accuracy = 0.887850
Validation prc-auc = 0.969217
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 27
Loss = 1.1924e-01, PNorm = 68.5424, GNorm = 0.3563, lr_0 = 1.7424e-04
Validation auc = 0.888265
Validation accuracy = 0.897196
Validation prc-auc = 0.968375
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 28
Loss = 2.0319e-01, PNorm = 68.5576, GNorm = 0.2608, lr_0 = 1.7424e-04
Validation auc = 0.887640
Validation accuracy = 0.897196
Validation prc-auc = 0.968233
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 29
Loss = 1.8492e-01, PNorm = 68.5753, GNorm = 1.2846, lr_0 = 1.7424e-04
Validation auc = 0.895131
Validation accuracy = 0.887850
Validation prc-auc = 0.972171
Validation f1 = 0.935484
Validation mcc = 0.542287
Model 3 best validation auc = 0.895131 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.989362
Model 3 test accuracy = 0.958333
Model 3 test prc-auc = 0.996892
Model 3 test f1 = 0.974093
Model 3 test mcc = 0.875728
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.803995
Validation accuracy = 0.887850
Validation prc-auc = 0.940241
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 1
Loss = 3.2776e-01, PNorm = 67.4154, GNorm = 0.2329, lr_0 = 1.1868e-03
Validation auc = 0.802122
Validation accuracy = 0.859813
Validation prc-auc = 0.937115
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 2
Loss = 4.2541e-01, PNorm = 67.9750, GNorm = 0.5817, lr_0 = 8.0296e-04
Validation auc = 0.807740
Validation accuracy = 0.869159
Validation prc-auc = 0.937785
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 3
Loss = 2.3562e-01, PNorm = 68.1471, GNorm = 0.2957, lr_0 = 3.8068e-04
Validation auc = 0.810861
Validation accuracy = 0.859813
Validation prc-auc = 0.938799
Validation f1 = 0.918033
Validation mcc = 0.444553
Epoch 4
Loss = 2.4277e-01, PNorm = 68.1791, GNorm = 0.2186, lr_0 = 2.6218e-04
Validation auc = 0.817728
Validation accuracy = 0.869159
Validation prc-auc = 0.941562
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 5
Loss = 2.1853e-01, PNorm = 68.1946, GNorm = 0.2818, lr_0 = 2.5751e-04
Validation auc = 0.820849
Validation accuracy = 0.869159
Validation prc-auc = 0.941226
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 6
Loss = 2.3426e-01, PNorm = 68.2078, GNorm = 0.2742, lr_0 = 2.5246e-04
Validation auc = 0.825218
Validation accuracy = 0.869159
Validation prc-auc = 0.941122
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 7
Loss = 2.2524e-01, PNorm = 68.2185, GNorm = 0.3076, lr_0 = 2.4795e-04
Validation auc = 0.831461
Validation accuracy = 0.869159
Validation prc-auc = 0.938709
Validation f1 = 0.923913
Validation mcc = 0.473583
Epoch 8
Loss = 2.4912e-01, PNorm = 68.2316, GNorm = 0.2437, lr_0 = 2.4309e-04
Validation auc = 0.840200
Validation accuracy = 0.878505
Validation prc-auc = 0.941195
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 9
Loss = 2.2066e-01, PNorm = 68.2443, GNorm = 0.1959, lr_0 = 2.3876e-04
Validation auc = 0.845818
Validation accuracy = 0.878505
Validation prc-auc = 0.935219
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 10
Loss = 2.3374e-01, PNorm = 68.2576, GNorm = 0.6573, lr_0 = 2.3450e-04
Validation auc = 0.853933
Validation accuracy = 0.878505
Validation prc-auc = 0.929381
Validation f1 = 0.929730
Validation mcc = 0.505898
Epoch 11
Loss = 2.2902e-01, PNorm = 68.2730, GNorm = 0.4495, lr_0 = 2.2990e-04
Validation auc = 0.857678
Validation accuracy = 0.887850
Validation prc-auc = 0.930476
Validation f1 = 0.934066
Validation mcc = 0.566391
Epoch 12
Loss = 2.3176e-01, PNorm = 68.2870, GNorm = 0.5271, lr_0 = 2.2580e-04
Validation auc = 0.858302
Validation accuracy = 0.887850
Validation prc-auc = 0.938594
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 13
Loss = 2.1057e-01, PNorm = 68.3001, GNorm = 0.7235, lr_0 = 2.2177e-04
Validation auc = 0.863920
Validation accuracy = 0.887850
Validation prc-auc = 0.931976
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 14
Loss = 2.0013e-01, PNorm = 68.3165, GNorm = 0.6158, lr_0 = 2.1742e-04
Validation auc = 0.863296
Validation accuracy = 0.897196
Validation prc-auc = 0.940114
Validation f1 = 0.939891
Validation mcc = 0.597502
Epoch 15
Loss = 2.0324e-01, PNorm = 68.3315, GNorm = 1.2156, lr_0 = 2.1354e-04
Validation auc = 0.863920
Validation accuracy = 0.887850
Validation prc-auc = 0.944450
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 16
Loss = 2.1065e-01, PNorm = 68.3476, GNorm = 0.4989, lr_0 = 2.0936e-04
Validation auc = 0.867665
Validation accuracy = 0.887850
Validation prc-auc = 0.941023
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 17
Loss = 1.8276e-01, PNorm = 68.3600, GNorm = 0.2526, lr_0 = 2.0562e-04
Validation auc = 0.873908
Validation accuracy = 0.887850
Validation prc-auc = 0.954507
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 18
Loss = 2.0071e-01, PNorm = 68.3729, GNorm = 0.4266, lr_0 = 2.0195e-04
Validation auc = 0.881398
Validation accuracy = 0.887850
Validation prc-auc = 0.961265
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 19
Loss = 2.1146e-01, PNorm = 68.3889, GNorm = 0.2437, lr_0 = 1.9800e-04
Validation auc = 0.878901
Validation accuracy = 0.887850
Validation prc-auc = 0.960797
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 20
Loss = 1.9799e-01, PNorm = 68.4050, GNorm = 0.3765, lr_0 = 1.9446e-04
Validation auc = 0.878277
Validation accuracy = 0.887850
Validation prc-auc = 0.959579
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 21
Loss = 1.9245e-01, PNorm = 68.4211, GNorm = 0.8730, lr_0 = 1.9099e-04
Validation auc = 0.877653
Validation accuracy = 0.887850
Validation prc-auc = 0.958255
Validation f1 = 0.934783
Validation mcc = 0.552760
Epoch 22
Loss = 1.9102e-01, PNorm = 68.4391, GNorm = 0.5072, lr_0 = 1.8725e-04
Validation auc = 0.877653
Validation accuracy = 0.897196
Validation prc-auc = 0.958168
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 23
Loss = 1.9038e-01, PNorm = 68.4553, GNorm = 0.2580, lr_0 = 1.8391e-04
Loss = 7.0275e-02, PNorm = 68.4570, GNorm = 1.0414, lr_0 = 1.8358e-04
Validation auc = 0.875780
Validation accuracy = 0.897196
Validation prc-auc = 0.956450
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 24
Loss = 1.8306e-01, PNorm = 68.4732, GNorm = 0.3311, lr_0 = 1.8030e-04
Validation auc = 0.877653
Validation accuracy = 0.906542
Validation prc-auc = 0.958150
Validation f1 = 0.945652
Validation mcc = 0.631938
Epoch 25
Loss = 1.8312e-01, PNorm = 68.4887, GNorm = 1.0283, lr_0 = 1.7709e-04
Validation auc = 0.885144
Validation accuracy = 0.897196
Validation prc-auc = 0.964373
Validation f1 = 0.941176
Validation mcc = 0.583840
Epoch 26
Validation auc = 0.889513
Validation accuracy = 0.887850
Validation prc-auc = 0.968928
Validation f1 = 0.935484
Validation mcc = 0.542287
Epoch 27
Loss = 2.1978e-01, PNorm = 68.5045, GNorm = 0.5821, lr_0 = 1.7424e-04
Validation auc = 0.890137
Validation accuracy = 0.897196
Validation prc-auc = 0.970335
Validation f1 = 0.940541
Validation mcc = 0.588164
Epoch 28
Loss = 2.2569e-01, PNorm = 68.5202, GNorm = 0.4781, lr_0 = 1.7424e-04
Validation auc = 0.891386
Validation accuracy = 0.897196
Validation prc-auc = 0.969724
Validation f1 = 0.941176
Validation mcc = 0.583840
Epoch 29
Loss = 1.7664e-01, PNorm = 68.5398, GNorm = 0.7597, lr_0 = 1.7424e-04
Validation auc = 0.883895
Validation accuracy = 0.897196
Validation prc-auc = 0.968691
Validation f1 = 0.939891
Validation mcc = 0.597502
Model 4 best validation auc = 0.891386 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.989362
Model 4 test accuracy = 0.958333
Model 4 test prc-auc = 0.996904
Model 4 test f1 = 0.974093
Model 4 test mcc = 0.875728
Ensemble test auc = 0.988953
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.996767
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 2
Splitting data with seed 2
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.910185
Validation accuracy = 0.925234
Validation prc-auc = 0.954358
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 1
Loss = 2.9530e-01, PNorm = 67.4564, GNorm = 0.2765, lr_0 = 1.1868e-03
Validation auc = 0.922685
Validation accuracy = 0.906542
Validation prc-auc = 0.961963
Validation f1 = 0.936709
Validation mcc = 0.759135
Epoch 2
Loss = 2.7340e-01, PNorm = 68.0082, GNorm = 0.2362, lr_0 = 8.0296e-04
Validation auc = 0.925926
Validation accuracy = 0.906542
Validation prc-auc = 0.963679
Validation f1 = 0.936709
Validation mcc = 0.759135
Epoch 3
Loss = 2.4120e-01, PNorm = 68.1767, GNorm = 0.1985, lr_0 = 3.8068e-04
Validation auc = 0.928704
Validation accuracy = 0.897196
Validation prc-auc = 0.965360
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 4
Loss = 2.4479e-01, PNorm = 68.2081, GNorm = 0.3777, lr_0 = 2.6218e-04
Validation auc = 0.931019
Validation accuracy = 0.934579
Validation prc-auc = 0.967251
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 5
Loss = 2.8135e-01, PNorm = 68.2244, GNorm = 0.2521, lr_0 = 2.5751e-04
Validation auc = 0.933796
Validation accuracy = 0.934579
Validation prc-auc = 0.969449
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 6
Loss = 2.7760e-01, PNorm = 68.2386, GNorm = 0.2307, lr_0 = 2.5246e-04
Validation auc = 0.937037
Validation accuracy = 0.934579
Validation prc-auc = 0.971501
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 7
Loss = 2.2381e-01, PNorm = 68.2505, GNorm = 0.2524, lr_0 = 2.4795e-04
Validation auc = 0.939815
Validation accuracy = 0.943925
Validation prc-auc = 0.973290
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 8
Loss = 2.6061e-01, PNorm = 68.2638, GNorm = 0.2455, lr_0 = 2.4309e-04
Validation auc = 0.941667
Validation accuracy = 0.934579
Validation prc-auc = 0.973476
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 9
Loss = 2.3533e-01, PNorm = 68.2762, GNorm = 0.3010, lr_0 = 2.3876e-04
Validation auc = 0.943519
Validation accuracy = 0.953271
Validation prc-auc = 0.974518
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 10
Loss = 2.0161e-01, PNorm = 68.2900, GNorm = 0.2996, lr_0 = 2.3450e-04
Validation auc = 0.943519
Validation accuracy = 0.925234
Validation prc-auc = 0.973213
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 11
Loss = 2.3672e-01, PNorm = 68.3048, GNorm = 0.2730, lr_0 = 2.2990e-04
Validation auc = 0.947222
Validation accuracy = 0.943925
Validation prc-auc = 0.976041
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 12
Loss = 2.4305e-01, PNorm = 68.3193, GNorm = 0.3279, lr_0 = 2.2580e-04
Validation auc = 0.947222
Validation accuracy = 0.953271
Validation prc-auc = 0.975105
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 13
Loss = 2.3411e-01, PNorm = 68.3361, GNorm = 0.3372, lr_0 = 2.2177e-04
Validation auc = 0.946759
Validation accuracy = 0.953271
Validation prc-auc = 0.974317
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 14
Loss = 2.3260e-01, PNorm = 68.3544, GNorm = 1.6068, lr_0 = 2.1742e-04
Validation auc = 0.948611
Validation accuracy = 0.962617
Validation prc-auc = 0.976711
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 15
Loss = 2.3996e-01, PNorm = 68.3686, GNorm = 0.2912, lr_0 = 2.1354e-04
Validation auc = 0.950000
Validation accuracy = 0.934579
Validation prc-auc = 0.976761
Validation f1 = 0.955975
Validation mcc = 0.828970
Epoch 16
Loss = 2.0627e-01, PNorm = 68.3851, GNorm = 0.2502, lr_0 = 2.0936e-04
Validation auc = 0.952315
Validation accuracy = 0.962617
Validation prc-auc = 0.978913
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 17
Loss = 2.2011e-01, PNorm = 68.4009, GNorm = 0.2321, lr_0 = 2.0562e-04
Validation auc = 0.953704
Validation accuracy = 0.943925
Validation prc-auc = 0.979091
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 18
Loss = 2.1194e-01, PNorm = 68.4174, GNorm = 0.4003, lr_0 = 2.0195e-04
Validation auc = 0.955093
Validation accuracy = 0.953271
Validation prc-auc = 0.979874
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 19
Loss = 2.0662e-01, PNorm = 68.4374, GNorm = 0.9352, lr_0 = 1.9800e-04
Validation auc = 0.953241
Validation accuracy = 0.953271
Validation prc-auc = 0.978583
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 20
Loss = 1.9680e-01, PNorm = 68.4558, GNorm = 0.2038, lr_0 = 1.9446e-04
Validation auc = 0.956019
Validation accuracy = 0.962617
Validation prc-auc = 0.980044
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 21
Loss = 1.9657e-01, PNorm = 68.4735, GNorm = 0.8537, lr_0 = 1.9099e-04
Validation auc = 0.956481
Validation accuracy = 0.962617
Validation prc-auc = 0.980313
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 22
Loss = 2.0165e-01, PNorm = 68.4951, GNorm = 0.2440, lr_0 = 1.8725e-04
Validation auc = 0.956944
Validation accuracy = 0.962617
Validation prc-auc = 0.981196
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 23
Loss = 1.9902e-01, PNorm = 68.5123, GNorm = 0.3326, lr_0 = 1.8391e-04
Loss = 1.1687e-01, PNorm = 68.5143, GNorm = 0.4046, lr_0 = 1.8358e-04
Validation auc = 0.959722
Validation accuracy = 0.953271
Validation prc-auc = 0.982579
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 24
Loss = 1.9533e-01, PNorm = 68.5341, GNorm = 0.4170, lr_0 = 1.8030e-04
Validation auc = 0.961574
Validation accuracy = 0.971963
Validation prc-auc = 0.983805
Validation f1 = 0.981595
Validation mcc = 0.925614
Epoch 25
Loss = 1.8981e-01, PNorm = 68.5539, GNorm = 0.7680, lr_0 = 1.7709e-04
Validation auc = 0.960648
Validation accuracy = 0.962617
Validation prc-auc = 0.983032
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 26
Validation auc = 0.959259
Validation accuracy = 0.934579
Validation prc-auc = 0.982195
Validation f1 = 0.955975
Validation mcc = 0.828970
Epoch 27
Loss = 1.8127e-01, PNorm = 68.5739, GNorm = 0.8319, lr_0 = 1.7424e-04
Validation auc = 0.962963
Validation accuracy = 0.962617
Validation prc-auc = 0.984556
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 28
Loss = 2.4600e-01, PNorm = 68.5897, GNorm = 0.7951, lr_0 = 1.7424e-04
Validation auc = 0.962500
Validation accuracy = 0.943925
Validation prc-auc = 0.984240
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 29
Loss = 2.0101e-01, PNorm = 68.6096, GNorm = 1.7361, lr_0 = 1.7424e-04
Validation auc = 0.963889
Validation accuracy = 0.971963
Validation prc-auc = 0.985079
Validation f1 = 0.981595
Validation mcc = 0.925614
Model 0 best validation auc = 0.963889 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.988953
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.996729
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.908333
Validation accuracy = 0.897196
Validation prc-auc = 0.954428
Validation f1 = 0.935673
Validation mcc = 0.721776
Epoch 1
Loss = 4.0795e-01, PNorm = 67.4417, GNorm = 0.5246, lr_0 = 1.1868e-03
Validation auc = 0.921296
Validation accuracy = 0.897196
Validation prc-auc = 0.962425
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 2
Loss = 3.6601e-01, PNorm = 67.9956, GNorm = 0.4161, lr_0 = 8.0296e-04
Validation auc = 0.926852
Validation accuracy = 0.925234
Validation prc-auc = 0.965670
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 3
Loss = 2.9384e-01, PNorm = 68.1642, GNorm = 0.2145, lr_0 = 3.8068e-04
Validation auc = 0.930093
Validation accuracy = 0.915888
Validation prc-auc = 0.967664
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 4
Loss = 2.4502e-01, PNorm = 68.1976, GNorm = 0.2343, lr_0 = 2.6218e-04
Validation auc = 0.933796
Validation accuracy = 0.915888
Validation prc-auc = 0.969832
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 5
Loss = 2.6438e-01, PNorm = 68.2158, GNorm = 0.3890, lr_0 = 2.5751e-04
Validation auc = 0.938426
Validation accuracy = 0.925234
Validation prc-auc = 0.972718
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 6
Loss = 2.5372e-01, PNorm = 68.2313, GNorm = 0.1819, lr_0 = 2.5246e-04
Validation auc = 0.937963
Validation accuracy = 0.934579
Validation prc-auc = 0.971643
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 7
Loss = 2.5254e-01, PNorm = 68.2455, GNorm = 0.3678, lr_0 = 2.4795e-04
Validation auc = 0.939815
Validation accuracy = 0.915888
Validation prc-auc = 0.971683
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 8
Loss = 2.3755e-01, PNorm = 68.2609, GNorm = 0.2141, lr_0 = 2.4309e-04
Validation auc = 0.943519
Validation accuracy = 0.934579
Validation prc-auc = 0.973626
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 9
Loss = 2.1054e-01, PNorm = 68.2746, GNorm = 0.3748, lr_0 = 2.3876e-04
Validation auc = 0.944444
Validation accuracy = 0.934579
Validation prc-auc = 0.974140
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 10
Loss = 2.8439e-01, PNorm = 68.2890, GNorm = 0.4218, lr_0 = 2.3450e-04
Validation auc = 0.948148
Validation accuracy = 0.953271
Validation prc-auc = 0.975784
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 11
Loss = 2.3518e-01, PNorm = 68.3065, GNorm = 0.3325, lr_0 = 2.2990e-04
Validation auc = 0.951389
Validation accuracy = 0.953271
Validation prc-auc = 0.977495
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 12
Loss = 2.2019e-01, PNorm = 68.3224, GNorm = 0.5472, lr_0 = 2.2580e-04
Validation auc = 0.950463
Validation accuracy = 0.934579
Validation prc-auc = 0.976945
Validation f1 = 0.955975
Validation mcc = 0.828970
Epoch 13
Loss = 2.4172e-01, PNorm = 68.3355, GNorm = 0.2564, lr_0 = 2.2177e-04
Validation auc = 0.952315
Validation accuracy = 0.962617
Validation prc-auc = 0.978685
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 14
Loss = 2.3030e-01, PNorm = 68.3467, GNorm = 0.7642, lr_0 = 2.1742e-04
Validation auc = 0.952315
Validation accuracy = 0.925234
Validation prc-auc = 0.978614
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 15
Loss = 2.2448e-01, PNorm = 68.3605, GNorm = 0.7737, lr_0 = 2.1354e-04
Validation auc = 0.952315
Validation accuracy = 0.943925
Validation prc-auc = 0.978614
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 16
Loss = 2.1173e-01, PNorm = 68.3781, GNorm = 0.5635, lr_0 = 2.0936e-04
Validation auc = 0.953704
Validation accuracy = 0.953271
Validation prc-auc = 0.979218
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 17
Loss = 2.0237e-01, PNorm = 68.3948, GNorm = 0.5123, lr_0 = 2.0562e-04
Validation auc = 0.953241
Validation accuracy = 0.962617
Validation prc-auc = 0.978833
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 18
Loss = 1.9754e-01, PNorm = 68.4095, GNorm = 0.3396, lr_0 = 2.0195e-04
Validation auc = 0.955556
Validation accuracy = 0.962617
Validation prc-auc = 0.979998
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 19
Loss = 2.0304e-01, PNorm = 68.4283, GNorm = 0.2327, lr_0 = 1.9800e-04
Validation auc = 0.957407
Validation accuracy = 0.962617
Validation prc-auc = 0.981319
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 20
Loss = 2.0444e-01, PNorm = 68.4450, GNorm = 0.2855, lr_0 = 1.9446e-04
Validation auc = 0.958796
Validation accuracy = 0.962617
Validation prc-auc = 0.982162
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 21
Loss = 2.0679e-01, PNorm = 68.4602, GNorm = 0.4123, lr_0 = 1.9099e-04
Validation auc = 0.957870
Validation accuracy = 0.934579
Validation prc-auc = 0.981488
Validation f1 = 0.955975
Validation mcc = 0.828970
Epoch 22
Loss = 2.0405e-01, PNorm = 68.4779, GNorm = 0.8429, lr_0 = 1.8725e-04
Validation auc = 0.960648
Validation accuracy = 0.953271
Validation prc-auc = 0.983282
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 23
Loss = 1.9968e-01, PNorm = 68.4951, GNorm = 0.2246, lr_0 = 1.8391e-04
Loss = 1.2689e-01, PNorm = 68.4970, GNorm = 0.4182, lr_0 = 1.8358e-04
Validation auc = 0.961574
Validation accuracy = 0.962617
Validation prc-auc = 0.983727
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 24
Loss = 2.0146e-01, PNorm = 68.5145, GNorm = 0.4397, lr_0 = 1.8030e-04
Validation auc = 0.960185
Validation accuracy = 0.943925
Validation prc-auc = 0.983112
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 25
Loss = 1.9088e-01, PNorm = 68.5330, GNorm = 0.6796, lr_0 = 1.7709e-04
Validation auc = 0.962500
Validation accuracy = 0.962617
Validation prc-auc = 0.984309
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 26
Validation auc = 0.961574
Validation accuracy = 0.953271
Validation prc-auc = 0.983769
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 27
Loss = 1.7707e-01, PNorm = 68.5533, GNorm = 0.9902, lr_0 = 1.7424e-04
Validation auc = 0.962500
Validation accuracy = 0.962617
Validation prc-auc = 0.984309
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 28
Loss = 1.5742e-01, PNorm = 68.5708, GNorm = 0.5769, lr_0 = 1.7424e-04
Validation auc = 0.964815
Validation accuracy = 0.953271
Validation prc-auc = 0.985369
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 29
Loss = 2.1949e-01, PNorm = 68.5908, GNorm = 0.3541, lr_0 = 1.7424e-04
Validation auc = 0.964352
Validation accuracy = 0.962617
Validation prc-auc = 0.985422
Validation f1 = 0.975610
Validation mcc = 0.900715
Model 1 best validation auc = 0.964815 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.991817
Model 1 test accuracy = 0.983333
Model 1 test prc-auc = 0.997660
Model 1 test f1 = 0.989474
Model 1 test mcc = 0.950708
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.916204
Validation accuracy = 0.906542
Validation prc-auc = 0.959271
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 1
Loss = 3.0933e-01, PNorm = 67.3827, GNorm = 0.3932, lr_0 = 1.1868e-03
Validation auc = 0.926389
Validation accuracy = 0.897196
Validation prc-auc = 0.964759
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 2
Loss = 3.5446e-01, PNorm = 67.9355, GNorm = 0.3013, lr_0 = 8.0296e-04
Validation auc = 0.932407
Validation accuracy = 0.915888
Validation prc-auc = 0.968927
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 3
Loss = 2.9923e-01, PNorm = 68.1071, GNorm = 0.2771, lr_0 = 3.8068e-04
Validation auc = 0.935648
Validation accuracy = 0.915888
Validation prc-auc = 0.971030
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 4
Loss = 2.2997e-01, PNorm = 68.1407, GNorm = 0.3360, lr_0 = 2.6218e-04
Validation auc = 0.938426
Validation accuracy = 0.934579
Validation prc-auc = 0.972422
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 5
Loss = 2.7668e-01, PNorm = 68.1589, GNorm = 0.3977, lr_0 = 2.5751e-04
Validation auc = 0.941204
Validation accuracy = 0.934579
Validation prc-auc = 0.973054
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 6
Loss = 2.6500e-01, PNorm = 68.1748, GNorm = 0.2252, lr_0 = 2.5246e-04
Validation auc = 0.943981
Validation accuracy = 0.934579
Validation prc-auc = 0.974017
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 7
Loss = 2.4187e-01, PNorm = 68.1894, GNorm = 0.2420, lr_0 = 2.4795e-04
Validation auc = 0.945370
Validation accuracy = 0.943925
Validation prc-auc = 0.973923
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 8
Loss = 2.3175e-01, PNorm = 68.2039, GNorm = 0.5744, lr_0 = 2.4309e-04
Validation auc = 0.945370
Validation accuracy = 0.934579
Validation prc-auc = 0.973813
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 9
Loss = 2.1429e-01, PNorm = 68.2169, GNorm = 0.3106, lr_0 = 2.3876e-04
Validation auc = 0.945833
Validation accuracy = 0.953271
Validation prc-auc = 0.974256
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 10
Loss = 2.1686e-01, PNorm = 68.2308, GNorm = 0.3693, lr_0 = 2.3450e-04
Validation auc = 0.946296
Validation accuracy = 0.943925
Validation prc-auc = 0.974252
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 11
Loss = 2.2654e-01, PNorm = 68.2466, GNorm = 0.4287, lr_0 = 2.2990e-04
Validation auc = 0.947685
Validation accuracy = 0.962617
Validation prc-auc = 0.974955
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 12
Loss = 2.1454e-01, PNorm = 68.2618, GNorm = 0.2629, lr_0 = 2.2580e-04
Validation auc = 0.949537
Validation accuracy = 0.943925
Validation prc-auc = 0.976030
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 13
Loss = 2.1190e-01, PNorm = 68.2800, GNorm = 0.3026, lr_0 = 2.2177e-04
Validation auc = 0.950000
Validation accuracy = 0.953271
Validation prc-auc = 0.976375
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 14
Loss = 2.0502e-01, PNorm = 68.3006, GNorm = 0.9019, lr_0 = 2.1742e-04
Validation auc = 0.950926
Validation accuracy = 0.953271
Validation prc-auc = 0.977086
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 15
Loss = 2.2348e-01, PNorm = 68.3186, GNorm = 0.5782, lr_0 = 2.1354e-04
Validation auc = 0.951389
Validation accuracy = 0.953271
Validation prc-auc = 0.977496
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 16
Loss = 2.0573e-01, PNorm = 68.3372, GNorm = 0.6334, lr_0 = 2.0936e-04
Validation auc = 0.951389
Validation accuracy = 0.962617
Validation prc-auc = 0.976775
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 17
Loss = 2.4329e-01, PNorm = 68.3531, GNorm = 0.3570, lr_0 = 2.0562e-04
Validation auc = 0.953704
Validation accuracy = 0.953271
Validation prc-auc = 0.979101
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 18
Loss = 2.1629e-01, PNorm = 68.3722, GNorm = 0.6724, lr_0 = 2.0195e-04
Validation auc = 0.955093
Validation accuracy = 0.953271
Validation prc-auc = 0.979625
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 19
Loss = 1.9025e-01, PNorm = 68.3923, GNorm = 0.3758, lr_0 = 1.9800e-04
Validation auc = 0.956944
Validation accuracy = 0.962617
Validation prc-auc = 0.980881
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 20
Loss = 2.0484e-01, PNorm = 68.4119, GNorm = 0.2009, lr_0 = 1.9446e-04
Validation auc = 0.958333
Validation accuracy = 0.962617
Validation prc-auc = 0.981548
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 21
Loss = 1.9706e-01, PNorm = 68.4329, GNorm = 0.4861, lr_0 = 1.9099e-04
Validation auc = 0.957407
Validation accuracy = 0.953271
Validation prc-auc = 0.981146
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 22
Loss = 1.9386e-01, PNorm = 68.4535, GNorm = 1.1706, lr_0 = 1.8725e-04
Validation auc = 0.960185
Validation accuracy = 0.962617
Validation prc-auc = 0.982716
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 23
Loss = 1.9314e-01, PNorm = 68.4696, GNorm = 1.2030, lr_0 = 1.8391e-04
Loss = 2.1495e-01, PNorm = 68.4712, GNorm = 0.3256, lr_0 = 1.8358e-04
Validation auc = 0.959259
Validation accuracy = 0.962617
Validation prc-auc = 0.982143
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 24
Loss = 1.8996e-01, PNorm = 68.4901, GNorm = 1.5081, lr_0 = 1.8030e-04
Validation auc = 0.958796
Validation accuracy = 0.962617
Validation prc-auc = 0.981998
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 25
Loss = 1.8725e-01, PNorm = 68.5109, GNorm = 0.9839, lr_0 = 1.7709e-04
Validation auc = 0.961111
Validation accuracy = 0.962617
Validation prc-auc = 0.983285
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 26
Validation auc = 0.961574
Validation accuracy = 0.962617
Validation prc-auc = 0.983750
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 27
Loss = 2.5249e-01, PNorm = 68.5321, GNorm = 0.3876, lr_0 = 1.7424e-04
Validation auc = 0.962963
Validation accuracy = 0.962617
Validation prc-auc = 0.984579
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 28
Loss = 1.6940e-01, PNorm = 68.5521, GNorm = 0.2521, lr_0 = 1.7424e-04
Validation auc = 0.962963
Validation accuracy = 0.962617
Validation prc-auc = 0.984265
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 29
Loss = 2.2589e-01, PNorm = 68.5749, GNorm = 1.5542, lr_0 = 1.7424e-04
Validation auc = 0.963889
Validation accuracy = 0.971963
Validation prc-auc = 0.984966
Validation f1 = 0.981595
Validation mcc = 0.925614
Model 2 best validation auc = 0.963889 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.989362
Model 2 test accuracy = 0.958333
Model 2 test prc-auc = 0.996894
Model 2 test f1 = 0.974093
Model 2 test mcc = 0.875728
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.911574
Validation accuracy = 0.850467
Validation prc-auc = 0.954008
Validation f1 = 0.909091
Validation mcc = 0.582672
Epoch 1
Loss = 3.5199e-01, PNorm = 67.5028, GNorm = 0.4691, lr_0 = 1.1868e-03
Validation auc = 0.920833
Validation accuracy = 0.897196
Validation prc-auc = 0.960620
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 2
Loss = 3.0760e-01, PNorm = 68.0656, GNorm = 0.2368, lr_0 = 8.0296e-04
Validation auc = 0.926852
Validation accuracy = 0.925234
Validation prc-auc = 0.965406
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 3
Loss = 2.0648e-01, PNorm = 68.2371, GNorm = 0.4214, lr_0 = 3.8068e-04
Validation auc = 0.930093
Validation accuracy = 0.915888
Validation prc-auc = 0.967057
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 4
Loss = 2.8958e-01, PNorm = 68.2704, GNorm = 0.3012, lr_0 = 2.6218e-04
Validation auc = 0.932407
Validation accuracy = 0.906542
Validation prc-auc = 0.968402
Validation f1 = 0.936709
Validation mcc = 0.759135
Epoch 5
Loss = 2.4493e-01, PNorm = 68.2870, GNorm = 0.4660, lr_0 = 2.5751e-04
Validation auc = 0.935185
Validation accuracy = 0.925234
Validation prc-auc = 0.970438
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 6
Loss = 2.2829e-01, PNorm = 68.3001, GNorm = 0.1923, lr_0 = 2.5246e-04
Validation auc = 0.936574
Validation accuracy = 0.915888
Validation prc-auc = 0.970796
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 7
Loss = 2.3786e-01, PNorm = 68.3120, GNorm = 0.2653, lr_0 = 2.4795e-04
Validation auc = 0.940278
Validation accuracy = 0.925234
Validation prc-auc = 0.972310
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 8
Loss = 2.3947e-01, PNorm = 68.3251, GNorm = 0.4690, lr_0 = 2.4309e-04
Validation auc = 0.942130
Validation accuracy = 0.943925
Validation prc-auc = 0.972954
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 9
Loss = 2.2681e-01, PNorm = 68.3381, GNorm = 0.3167, lr_0 = 2.3876e-04
Validation auc = 0.943056
Validation accuracy = 0.934579
Validation prc-auc = 0.972370
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 10
Loss = 2.4992e-01, PNorm = 68.3513, GNorm = 0.4584, lr_0 = 2.3450e-04
Validation auc = 0.944444
Validation accuracy = 0.943925
Validation prc-auc = 0.972830
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 11
Loss = 2.3388e-01, PNorm = 68.3662, GNorm = 0.4301, lr_0 = 2.2990e-04
Validation auc = 0.945370
Validation accuracy = 0.934579
Validation prc-auc = 0.973558
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 12
Loss = 2.8348e-01, PNorm = 68.3806, GNorm = 1.4009, lr_0 = 2.2580e-04
Validation auc = 0.946296
Validation accuracy = 0.962617
Validation prc-auc = 0.975487
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 13
Loss = 2.3539e-01, PNorm = 68.3931, GNorm = 0.2646, lr_0 = 2.2177e-04
Validation auc = 0.946296
Validation accuracy = 0.934579
Validation prc-auc = 0.975022
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 14
Loss = 2.3213e-01, PNorm = 68.4102, GNorm = 0.2782, lr_0 = 2.1742e-04
Validation auc = 0.949074
Validation accuracy = 0.934579
Validation prc-auc = 0.976787
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 15
Loss = 2.3918e-01, PNorm = 68.4250, GNorm = 0.5142, lr_0 = 2.1354e-04
Validation auc = 0.950000
Validation accuracy = 0.962617
Validation prc-auc = 0.977330
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 16
Loss = 2.3981e-01, PNorm = 68.4420, GNorm = 0.2806, lr_0 = 2.0936e-04
Validation auc = 0.951389
Validation accuracy = 0.943925
Validation prc-auc = 0.977597
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 17
Loss = 2.2729e-01, PNorm = 68.4584, GNorm = 0.2395, lr_0 = 2.0562e-04
Validation auc = 0.953241
Validation accuracy = 0.962617
Validation prc-auc = 0.978922
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 18
Loss = 2.0636e-01, PNorm = 68.4761, GNorm = 0.3318, lr_0 = 2.0195e-04
Validation auc = 0.953704
Validation accuracy = 0.943925
Validation prc-auc = 0.978861
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 19
Loss = 2.0487e-01, PNorm = 68.4945, GNorm = 0.2273, lr_0 = 1.9800e-04
Validation auc = 0.955556
Validation accuracy = 0.962617
Validation prc-auc = 0.980244
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 20
Loss = 2.1397e-01, PNorm = 68.5136, GNorm = 0.2024, lr_0 = 1.9446e-04
Validation auc = 0.955093
Validation accuracy = 0.971963
Validation prc-auc = 0.979882
Validation f1 = 0.981595
Validation mcc = 0.925614
Epoch 21
Loss = 2.1310e-01, PNorm = 68.5299, GNorm = 1.1262, lr_0 = 1.9099e-04
Validation auc = 0.953704
Validation accuracy = 0.943925
Validation prc-auc = 0.978861
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 22
Loss = 2.1100e-01, PNorm = 68.5476, GNorm = 0.3589, lr_0 = 1.8725e-04
Validation auc = 0.957407
Validation accuracy = 0.962617
Validation prc-auc = 0.981449
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 23
Loss = 2.1038e-01, PNorm = 68.5669, GNorm = 0.3641, lr_0 = 1.8391e-04
Loss = 2.2913e-01, PNorm = 68.5685, GNorm = 0.8897, lr_0 = 1.8358e-04
Validation auc = 0.957407
Validation accuracy = 0.971963
Validation prc-auc = 0.981106
Validation f1 = 0.981595
Validation mcc = 0.925614
Epoch 24
Loss = 1.9842e-01, PNorm = 68.5863, GNorm = 0.4033, lr_0 = 1.8030e-04
Validation auc = 0.958333
Validation accuracy = 0.962617
Validation prc-auc = 0.981630
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 25
Loss = 1.9892e-01, PNorm = 68.6059, GNorm = 0.8704, lr_0 = 1.7709e-04
Validation auc = 0.960648
Validation accuracy = 0.962617
Validation prc-auc = 0.983048
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 26
Validation auc = 0.961111
Validation accuracy = 0.962617
Validation prc-auc = 0.983364
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 27
Loss = 2.3627e-01, PNorm = 68.6268, GNorm = 0.2643, lr_0 = 1.7424e-04
Validation auc = 0.962500
Validation accuracy = 0.971963
Validation prc-auc = 0.984142
Validation f1 = 0.981595
Validation mcc = 0.925614
Epoch 28
Loss = 1.3406e-01, PNorm = 68.6467, GNorm = 0.2119, lr_0 = 1.7424e-04
Validation auc = 0.962963
Validation accuracy = 0.962617
Validation prc-auc = 0.984436
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 29
Loss = 1.9490e-01, PNorm = 68.6691, GNorm = 0.7282, lr_0 = 1.7424e-04
Validation auc = 0.962037
Validation accuracy = 0.962617
Validation prc-auc = 0.983841
Validation f1 = 0.975309
Validation mcc = 0.899595
Model 3 best validation auc = 0.962963 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.990180
Model 3 test accuracy = 0.966667
Model 3 test prc-auc = 0.997197
Model 3 test f1 = 0.979167
Model 3 test mcc = 0.900898
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.917593
Validation accuracy = 0.915888
Validation prc-auc = 0.960164
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 1
Loss = 3.7815e-01, PNorm = 67.4091, GNorm = 0.4106, lr_0 = 1.1868e-03
Validation auc = 0.924074
Validation accuracy = 0.906542
Validation prc-auc = 0.963951
Validation f1 = 0.937500
Validation mcc = 0.752315
Epoch 2
Loss = 2.4628e-01, PNorm = 67.9626, GNorm = 0.2504, lr_0 = 8.0296e-04
Validation auc = 0.929167
Validation accuracy = 0.897196
Validation prc-auc = 0.967207
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 3
Loss = 2.5070e-01, PNorm = 68.1366, GNorm = 0.2820, lr_0 = 3.8068e-04
Validation auc = 0.931481
Validation accuracy = 0.915888
Validation prc-auc = 0.968408
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 4
Loss = 2.6746e-01, PNorm = 68.1700, GNorm = 0.2100, lr_0 = 2.6218e-04
Validation auc = 0.934259
Validation accuracy = 0.915888
Validation prc-auc = 0.969608
Validation f1 = 0.943396
Validation mcc = 0.780019
Epoch 5
Loss = 2.9424e-01, PNorm = 68.1880, GNorm = 0.2095, lr_0 = 2.5751e-04
Validation auc = 0.937500
Validation accuracy = 0.925234
Validation prc-auc = 0.971023
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 6
Loss = 2.9429e-01, PNorm = 68.2029, GNorm = 0.2700, lr_0 = 2.5246e-04
Validation auc = 0.941204
Validation accuracy = 0.943925
Validation prc-auc = 0.972752
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 7
Loss = 2.6915e-01, PNorm = 68.2166, GNorm = 0.5006, lr_0 = 2.4795e-04
Validation auc = 0.944907
Validation accuracy = 0.925234
Validation prc-auc = 0.974539
Validation f1 = 0.950000
Validation mcc = 0.801852
Epoch 8
Loss = 2.2909e-01, PNorm = 68.2333, GNorm = 0.3296, lr_0 = 2.4309e-04
Validation auc = 0.945833
Validation accuracy = 0.934579
Validation prc-auc = 0.974724
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 9
Loss = 2.3896e-01, PNorm = 68.2477, GNorm = 0.2639, lr_0 = 2.3876e-04
Validation auc = 0.947685
Validation accuracy = 0.962617
Validation prc-auc = 0.975594
Validation f1 = 0.975610
Validation mcc = 0.900715
Epoch 10
Loss = 2.0483e-01, PNorm = 68.2612, GNorm = 0.6711, lr_0 = 2.3450e-04
Validation auc = 0.944444
Validation accuracy = 0.915888
Validation prc-auc = 0.972348
Validation f1 = 0.942675
Validation mcc = 0.787020
Epoch 11
Loss = 2.3070e-01, PNorm = 68.2743, GNorm = 0.8740, lr_0 = 2.2990e-04
Validation auc = 0.948611
Validation accuracy = 0.943925
Validation prc-auc = 0.976261
Validation f1 = 0.962963
Validation mcc = 0.848746
Epoch 12
Loss = 2.5756e-01, PNorm = 68.2873, GNorm = 0.2982, lr_0 = 2.2580e-04
Validation auc = 0.949537
Validation accuracy = 0.953271
Validation prc-auc = 0.976759
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 13
Loss = 2.4793e-01, PNorm = 68.3007, GNorm = 0.7235, lr_0 = 2.2177e-04
Validation auc = 0.950463
Validation accuracy = 0.953271
Validation prc-auc = 0.977269
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 14
Loss = 2.2617e-01, PNorm = 68.3180, GNorm = 0.4356, lr_0 = 2.1742e-04
Validation auc = 0.952778
Validation accuracy = 0.934579
Validation prc-auc = 0.978794
Validation f1 = 0.956522
Validation mcc = 0.824726
Epoch 15
Loss = 2.1400e-01, PNorm = 68.3348, GNorm = 0.6170, lr_0 = 2.1354e-04
Validation auc = 0.954167
Validation accuracy = 0.943925
Validation prc-auc = 0.979237
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 16
Loss = 2.0759e-01, PNorm = 68.3527, GNorm = 0.3087, lr_0 = 2.0936e-04
Validation auc = 0.953241
Validation accuracy = 0.953271
Validation prc-auc = 0.978717
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 17
Loss = 2.1365e-01, PNorm = 68.3688, GNorm = 0.4272, lr_0 = 2.0562e-04
Validation auc = 0.955556
Validation accuracy = 0.962617
Validation prc-auc = 0.979974
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 18
Loss = 2.0566e-01, PNorm = 68.3863, GNorm = 0.2688, lr_0 = 2.0195e-04
Validation auc = 0.953704
Validation accuracy = 0.962617
Validation prc-auc = 0.978205
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 19
Loss = 1.9888e-01, PNorm = 68.4059, GNorm = 0.6727, lr_0 = 1.9800e-04
Validation auc = 0.953241
Validation accuracy = 0.925234
Validation prc-auc = 0.978060
Validation f1 = 0.949367
Validation mcc = 0.807542
Epoch 20
Loss = 2.1916e-01, PNorm = 68.4194, GNorm = 0.6942, lr_0 = 1.9446e-04
Validation auc = 0.956944
Validation accuracy = 0.943925
Validation prc-auc = 0.981559
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 21
Loss = 1.9784e-01, PNorm = 68.4340, GNorm = 0.4435, lr_0 = 1.9099e-04
Validation auc = 0.956481
Validation accuracy = 0.953271
Validation prc-auc = 0.981412
Validation f1 = 0.969325
Validation mcc = 0.874030
Epoch 22
Loss = 2.0866e-01, PNorm = 68.4532, GNorm = 0.4031, lr_0 = 1.8725e-04
Validation auc = 0.958333
Validation accuracy = 0.962617
Validation prc-auc = 0.982062
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 23
Loss = 1.9301e-01, PNorm = 68.4727, GNorm = 0.6451, lr_0 = 1.8391e-04
Loss = 2.6091e-01, PNorm = 68.4745, GNorm = 0.4582, lr_0 = 1.8358e-04
Validation auc = 0.959259
Validation accuracy = 0.953271
Validation prc-auc = 0.982487
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 24
Loss = 2.0019e-01, PNorm = 68.4931, GNorm = 0.7775, lr_0 = 1.8030e-04
Validation auc = 0.958333
Validation accuracy = 0.962617
Validation prc-auc = 0.981822
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 25
Loss = 1.9857e-01, PNorm = 68.5101, GNorm = 0.7809, lr_0 = 1.7709e-04
Validation auc = 0.956944
Validation accuracy = 0.943925
Validation prc-auc = 0.980675
Validation f1 = 0.962500
Validation mcc = 0.851389
Epoch 26
Validation auc = 0.961574
Validation accuracy = 0.962617
Validation prc-auc = 0.983727
Validation f1 = 0.975309
Validation mcc = 0.899595
Epoch 27
Loss = 2.2833e-01, PNorm = 68.5304, GNorm = 0.9087, lr_0 = 1.7424e-04
Validation auc = 0.961574
Validation accuracy = 0.953271
Validation prc-auc = 0.983771
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 28
Loss = 2.5574e-01, PNorm = 68.5493, GNorm = 0.5552, lr_0 = 1.7424e-04
Validation auc = 0.961111
Validation accuracy = 0.953271
Validation prc-auc = 0.983529
Validation f1 = 0.968944
Validation mcc = 0.874894
Epoch 29
Loss = 2.0879e-01, PNorm = 68.5686, GNorm = 0.2788, lr_0 = 1.7424e-04
Validation auc = 0.962037
Validation accuracy = 0.962617
Validation prc-auc = 0.984021
Validation f1 = 0.975309
Validation mcc = 0.899595
Model 4 best validation auc = 0.962037 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.989362
Model 4 test accuracy = 0.958333
Model 4 test prc-auc = 0.996892
Model 4 test f1 = 0.974093
Model 4 test mcc = 0.875728
Ensemble test auc = 0.991408
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.997534
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 3
Splitting data with seed 3
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.920683
Validation accuracy = 0.915888
Validation prc-auc = 0.964148
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 1
Loss = 3.1198e-01, PNorm = 67.4457, GNorm = 0.2907, lr_0 = 1.1868e-03
Validation auc = 0.921687
Validation accuracy = 0.925234
Validation prc-auc = 0.962887
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 2
Loss = 2.3286e-01, PNorm = 67.9988, GNorm = 0.2089, lr_0 = 8.0296e-04
Validation auc = 0.925201
Validation accuracy = 0.925234
Validation prc-auc = 0.965432
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 3
Loss = 2.8403e-01, PNorm = 68.1649, GNorm = 0.4638, lr_0 = 3.8068e-04
Validation auc = 0.929719
Validation accuracy = 0.925234
Validation prc-auc = 0.966260
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 4
Loss = 3.2514e-01, PNorm = 68.1961, GNorm = 0.2443, lr_0 = 2.6218e-04
Validation auc = 0.930723
Validation accuracy = 0.925234
Validation prc-auc = 0.966088
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 5
Loss = 2.5574e-01, PNorm = 68.2120, GNorm = 0.3058, lr_0 = 2.5751e-04
Validation auc = 0.930221
Validation accuracy = 0.925234
Validation prc-auc = 0.965140
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 6
Loss = 2.6271e-01, PNorm = 68.2248, GNorm = 0.4284, lr_0 = 2.5246e-04
Validation auc = 0.934237
Validation accuracy = 0.925234
Validation prc-auc = 0.965777
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 7
Loss = 2.0744e-01, PNorm = 68.2354, GNorm = 0.1993, lr_0 = 2.4795e-04
Validation auc = 0.936245
Validation accuracy = 0.925234
Validation prc-auc = 0.965431
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 8
Loss = 2.6254e-01, PNorm = 68.2485, GNorm = 0.7842, lr_0 = 2.4309e-04
Validation auc = 0.937751
Validation accuracy = 0.915888
Validation prc-auc = 0.965912
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 9
Loss = 1.9355e-01, PNorm = 68.2607, GNorm = 0.4413, lr_0 = 2.3876e-04
Validation auc = 0.939759
Validation accuracy = 0.925234
Validation prc-auc = 0.966523
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 10
Loss = 2.1003e-01, PNorm = 68.2730, GNorm = 0.2942, lr_0 = 2.3450e-04
Validation auc = 0.936245
Validation accuracy = 0.925234
Validation prc-auc = 0.962728
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 11
Loss = 2.1316e-01, PNorm = 68.2851, GNorm = 0.3149, lr_0 = 2.2990e-04
Validation auc = 0.936245
Validation accuracy = 0.915888
Validation prc-auc = 0.964183
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 12
Loss = 2.5085e-01, PNorm = 68.2970, GNorm = 0.4715, lr_0 = 2.2580e-04
Validation auc = 0.936245
Validation accuracy = 0.915888
Validation prc-auc = 0.964165
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 13
Loss = 2.3874e-01, PNorm = 68.3112, GNorm = 0.3179, lr_0 = 2.2177e-04
Validation auc = 0.939257
Validation accuracy = 0.925234
Validation prc-auc = 0.965134
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 14
Loss = 2.2057e-01, PNorm = 68.3273, GNorm = 0.4982, lr_0 = 2.1742e-04
Validation auc = 0.939759
Validation accuracy = 0.925234
Validation prc-auc = 0.965314
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 15
Loss = 2.3140e-01, PNorm = 68.3413, GNorm = 0.2359, lr_0 = 2.1354e-04
Validation auc = 0.939759
Validation accuracy = 0.915888
Validation prc-auc = 0.966547
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 16
Loss = 2.1841e-01, PNorm = 68.3569, GNorm = 0.4007, lr_0 = 2.0936e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.966736
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 17
Loss = 2.3086e-01, PNorm = 68.3698, GNorm = 0.8598, lr_0 = 2.0562e-04
Validation auc = 0.940763
Validation accuracy = 0.915888
Validation prc-auc = 0.966873
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 18
Loss = 2.0607e-01, PNorm = 68.3829, GNorm = 0.5180, lr_0 = 2.0195e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.967860
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 19
Loss = 2.1798e-01, PNorm = 68.3986, GNorm = 1.0393, lr_0 = 1.9800e-04
Validation auc = 0.942269
Validation accuracy = 0.925234
Validation prc-auc = 0.968488
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 20
Loss = 1.9399e-01, PNorm = 68.4154, GNorm = 0.2639, lr_0 = 1.9446e-04
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.968693
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 21
Loss = 2.0225e-01, PNorm = 68.4298, GNorm = 0.6702, lr_0 = 1.9099e-04
Validation auc = 0.942269
Validation accuracy = 0.925234
Validation prc-auc = 0.968455
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 22
Loss = 2.0894e-01, PNorm = 68.4425, GNorm = 0.4239, lr_0 = 1.8725e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.968366
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 23
Loss = 1.9067e-01, PNorm = 68.4561, GNorm = 0.3084, lr_0 = 1.8391e-04
Loss = 2.0072e-01, PNorm = 68.4576, GNorm = 0.4198, lr_0 = 1.8358e-04
Validation auc = 0.942771
Validation accuracy = 0.915888
Validation prc-auc = 0.970565
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 24
Loss = 1.9254e-01, PNorm = 68.4734, GNorm = 2.2763, lr_0 = 1.8030e-04
Validation auc = 0.944277
Validation accuracy = 0.925234
Validation prc-auc = 0.970075
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 25
Loss = 1.9399e-01, PNorm = 68.4881, GNorm = 0.4678, lr_0 = 1.7709e-04
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.968749
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 26
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.968771
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 27
Loss = 2.4109e-01, PNorm = 68.5022, GNorm = 1.9735, lr_0 = 1.7424e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.971361
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 28
Loss = 1.6163e-01, PNorm = 68.5137, GNorm = 0.5417, lr_0 = 1.7424e-04
Validation auc = 0.944779
Validation accuracy = 0.925234
Validation prc-auc = 0.971947
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 29
Loss = 1.8946e-01, PNorm = 68.5303, GNorm = 0.2644, lr_0 = 1.7424e-04
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.971525
Validation f1 = 0.954023
Validation mcc = 0.779781
Model 0 best validation auc = 0.944779 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.986907
Model 0 test accuracy = 0.966667
Model 0 test prc-auc = 0.996143
Model 0 test f1 = 0.979167
Model 0 test mcc = 0.900898
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.921687
Validation accuracy = 0.915888
Validation prc-auc = 0.964381
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 1
Loss = 3.5188e-01, PNorm = 67.4468, GNorm = 0.3488, lr_0 = 1.1868e-03
Validation auc = 0.924699
Validation accuracy = 0.925234
Validation prc-auc = 0.964747
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 2
Loss = 3.4680e-01, PNorm = 68.0013, GNorm = 0.2593, lr_0 = 8.0296e-04
Validation auc = 0.928715
Validation accuracy = 0.925234
Validation prc-auc = 0.965329
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 3
Loss = 2.9139e-01, PNorm = 68.1717, GNorm = 0.2159, lr_0 = 3.8068e-04
Validation auc = 0.930221
Validation accuracy = 0.925234
Validation prc-auc = 0.965105
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 4
Loss = 3.2124e-01, PNorm = 68.2044, GNorm = 0.3263, lr_0 = 2.6218e-04
Validation auc = 0.930221
Validation accuracy = 0.925234
Validation prc-auc = 0.965105
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 5
Loss = 2.4797e-01, PNorm = 68.2215, GNorm = 0.2826, lr_0 = 2.5751e-04
Validation auc = 0.934237
Validation accuracy = 0.925234
Validation prc-auc = 0.967612
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 6
Loss = 3.2502e-01, PNorm = 68.2364, GNorm = 0.3388, lr_0 = 2.5246e-04
Validation auc = 0.935241
Validation accuracy = 0.934579
Validation prc-auc = 0.968028
Validation f1 = 0.959538
Validation mcc = 0.808233
Epoch 7
Loss = 2.6263e-01, PNorm = 68.2489, GNorm = 0.7907, lr_0 = 2.4795e-04
Validation auc = 0.936747
Validation accuracy = 0.925234
Validation prc-auc = 0.967713
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 8
Loss = 2.2910e-01, PNorm = 68.2625, GNorm = 0.2388, lr_0 = 2.4309e-04
Validation auc = 0.937249
Validation accuracy = 0.925234
Validation prc-auc = 0.966791
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 9
Loss = 2.4036e-01, PNorm = 68.2753, GNorm = 0.4326, lr_0 = 2.3876e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.965534
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 10
Loss = 2.2769e-01, PNorm = 68.2890, GNorm = 0.3105, lr_0 = 2.3450e-04
Validation auc = 0.937751
Validation accuracy = 0.925234
Validation prc-auc = 0.965985
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 11
Loss = 2.1950e-01, PNorm = 68.3049, GNorm = 0.3237, lr_0 = 2.2990e-04
Validation auc = 0.938755
Validation accuracy = 0.925234
Validation prc-auc = 0.963559
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 12
Loss = 2.0624e-01, PNorm = 68.3194, GNorm = 0.3311, lr_0 = 2.2580e-04
Validation auc = 0.937249
Validation accuracy = 0.925234
Validation prc-auc = 0.959378
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 13
Loss = 1.8927e-01, PNorm = 68.3319, GNorm = 0.4624, lr_0 = 2.2177e-04
Validation auc = 0.939257
Validation accuracy = 0.925234
Validation prc-auc = 0.962013
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 14
Loss = 2.2040e-01, PNorm = 68.3452, GNorm = 0.5255, lr_0 = 2.1742e-04
Validation auc = 0.939257
Validation accuracy = 0.915888
Validation prc-auc = 0.967487
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 15
Loss = 2.3160e-01, PNorm = 68.3577, GNorm = 0.2613, lr_0 = 2.1354e-04
Validation auc = 0.942269
Validation accuracy = 0.925234
Validation prc-auc = 0.969476
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 16
Loss = 2.0784e-01, PNorm = 68.3754, GNorm = 0.5735, lr_0 = 2.0936e-04
Validation auc = 0.943273
Validation accuracy = 0.915888
Validation prc-auc = 0.969795
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 17
Loss = 2.0008e-01, PNorm = 68.3907, GNorm = 0.4563, lr_0 = 2.0562e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.967243
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 18
Loss = 2.0970e-01, PNorm = 68.4051, GNorm = 0.9569, lr_0 = 2.0195e-04
Validation auc = 0.942771
Validation accuracy = 0.915888
Validation prc-auc = 0.969677
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 19
Loss = 2.1681e-01, PNorm = 68.4219, GNorm = 0.2849, lr_0 = 1.9800e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.969665
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 20
Loss = 2.1444e-01, PNorm = 68.4367, GNorm = 0.5345, lr_0 = 1.9446e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.967249
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 21
Loss = 1.9434e-01, PNorm = 68.4513, GNorm = 0.5405, lr_0 = 1.9099e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.970572
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 22
Loss = 1.9987e-01, PNorm = 68.4667, GNorm = 0.2368, lr_0 = 1.8725e-04
Validation auc = 0.942771
Validation accuracy = 0.915888
Validation prc-auc = 0.970572
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 23
Loss = 1.8989e-01, PNorm = 68.4830, GNorm = 0.2482, lr_0 = 1.8391e-04
Loss = 3.7338e-01, PNorm = 68.4843, GNorm = 0.5506, lr_0 = 1.8358e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.968405
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 24
Loss = 2.0591e-01, PNorm = 68.4985, GNorm = 1.1348, lr_0 = 1.8030e-04
Validation auc = 0.943273
Validation accuracy = 0.915888
Validation prc-auc = 0.971525
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 25
Loss = 1.8940e-01, PNorm = 68.5155, GNorm = 1.3366, lr_0 = 1.7709e-04
Validation auc = 0.944277
Validation accuracy = 0.925234
Validation prc-auc = 0.970150
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 26
Validation auc = 0.941265
Validation accuracy = 0.915888
Validation prc-auc = 0.970125
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 27
Loss = 1.4633e-01, PNorm = 68.5331, GNorm = 0.3881, lr_0 = 1.7424e-04
Validation auc = 0.943775
Validation accuracy = 0.915888
Validation prc-auc = 0.971702
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 28
Loss = 1.7415e-01, PNorm = 68.5487, GNorm = 0.5534, lr_0 = 1.7424e-04
Validation auc = 0.945783
Validation accuracy = 0.915888
Validation prc-auc = 0.973718
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 29
Loss = 1.8779e-01, PNorm = 68.5665, GNorm = 0.4795, lr_0 = 1.7424e-04
Validation auc = 0.945783
Validation accuracy = 0.915888
Validation prc-auc = 0.974945
Validation f1 = 0.948571
Validation mcc = 0.750905
Model 1 best validation auc = 0.945783 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.988134
Model 1 test accuracy = 0.958333
Model 1 test prc-auc = 0.996516
Model 1 test f1 = 0.974093
Model 1 test mcc = 0.875728
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.920683
Validation accuracy = 0.915888
Validation prc-auc = 0.961844
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 1
Loss = 2.7743e-01, PNorm = 67.3903, GNorm = 0.2641, lr_0 = 1.1868e-03
Validation auc = 0.924699
Validation accuracy = 0.925234
Validation prc-auc = 0.961356
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 2
Loss = 3.1797e-01, PNorm = 67.9524, GNorm = 0.2775, lr_0 = 8.0296e-04
Validation auc = 0.929217
Validation accuracy = 0.934579
Validation prc-auc = 0.964426
Validation f1 = 0.959538
Validation mcc = 0.808233
Epoch 3
Loss = 3.5808e-01, PNorm = 68.1263, GNorm = 0.2874, lr_0 = 3.8068e-04
Validation auc = 0.932731
Validation accuracy = 0.925234
Validation prc-auc = 0.963997
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 4
Loss = 2.9028e-01, PNorm = 68.1608, GNorm = 0.2385, lr_0 = 2.6218e-04
Validation auc = 0.934237
Validation accuracy = 0.925234
Validation prc-auc = 0.963429
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 5
Loss = 2.6044e-01, PNorm = 68.1805, GNorm = 0.2283, lr_0 = 2.5751e-04
Validation auc = 0.934739
Validation accuracy = 0.934579
Validation prc-auc = 0.963666
Validation f1 = 0.959538
Validation mcc = 0.808233
Epoch 6
Loss = 2.5096e-01, PNorm = 68.1974, GNorm = 0.3064, lr_0 = 2.5246e-04
Validation auc = 0.936245
Validation accuracy = 0.925234
Validation prc-auc = 0.964194
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 7
Loss = 2.4966e-01, PNorm = 68.2126, GNorm = 0.2018, lr_0 = 2.4795e-04
Validation auc = 0.934237
Validation accuracy = 0.915888
Validation prc-auc = 0.962088
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 8
Loss = 2.1670e-01, PNorm = 68.2302, GNorm = 0.3318, lr_0 = 2.4309e-04
Validation auc = 0.933233
Validation accuracy = 0.925234
Validation prc-auc = 0.961829
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 9
Loss = 2.3757e-01, PNorm = 68.2456, GNorm = 0.6339, lr_0 = 2.3876e-04
Validation auc = 0.933233
Validation accuracy = 0.915888
Validation prc-auc = 0.961829
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 10
Loss = 2.6265e-01, PNorm = 68.2618, GNorm = 0.4580, lr_0 = 2.3450e-04
Validation auc = 0.935241
Validation accuracy = 0.915888
Validation prc-auc = 0.963868
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 11
Loss = 2.3273e-01, PNorm = 68.2778, GNorm = 0.3025, lr_0 = 2.2990e-04
Validation auc = 0.937249
Validation accuracy = 0.925234
Validation prc-auc = 0.961377
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 12
Loss = 1.9298e-01, PNorm = 68.2946, GNorm = 0.2647, lr_0 = 2.2580e-04
Validation auc = 0.938755
Validation accuracy = 0.915888
Validation prc-auc = 0.964963
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 13
Loss = 2.0467e-01, PNorm = 68.3128, GNorm = 1.9972, lr_0 = 2.2177e-04
Validation auc = 0.938755
Validation accuracy = 0.915888
Validation prc-auc = 0.966263
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 14
Loss = 1.9281e-01, PNorm = 68.3284, GNorm = 0.2665, lr_0 = 2.1742e-04
Validation auc = 0.937249
Validation accuracy = 0.915888
Validation prc-auc = 0.964543
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 15
Loss = 2.0679e-01, PNorm = 68.3458, GNorm = 0.2302, lr_0 = 2.1354e-04
Validation auc = 0.936245
Validation accuracy = 0.915888
Validation prc-auc = 0.965504
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 16
Loss = 2.1832e-01, PNorm = 68.3653, GNorm = 0.3581, lr_0 = 2.0936e-04
Validation auc = 0.939257
Validation accuracy = 0.925234
Validation prc-auc = 0.967590
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 17
Loss = 1.9804e-01, PNorm = 68.3836, GNorm = 0.4127, lr_0 = 2.0562e-04
Validation auc = 0.941767
Validation accuracy = 0.915888
Validation prc-auc = 0.969336
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 18
Loss = 2.0338e-01, PNorm = 68.4031, GNorm = 0.3946, lr_0 = 2.0195e-04
Validation auc = 0.939759
Validation accuracy = 0.925234
Validation prc-auc = 0.967729
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 19
Loss = 2.0344e-01, PNorm = 68.4235, GNorm = 1.3815, lr_0 = 1.9800e-04
Validation auc = 0.940763
Validation accuracy = 0.925234
Validation prc-auc = 0.969046
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 20
Loss = 1.9947e-01, PNorm = 68.4394, GNorm = 0.5157, lr_0 = 1.9446e-04
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.970689
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 21
Loss = 1.9177e-01, PNorm = 68.4553, GNorm = 0.4104, lr_0 = 1.9099e-04
Validation auc = 0.942269
Validation accuracy = 0.915888
Validation prc-auc = 0.970420
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 22
Loss = 1.9313e-01, PNorm = 68.4775, GNorm = 0.3845, lr_0 = 1.8725e-04
Validation auc = 0.942771
Validation accuracy = 0.915888
Validation prc-auc = 0.970550
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 23
Loss = 1.8071e-01, PNorm = 68.4988, GNorm = 0.3241, lr_0 = 1.8391e-04
Loss = 3.0691e-01, PNorm = 68.5010, GNorm = 1.7798, lr_0 = 1.8358e-04
Validation auc = 0.938755
Validation accuracy = 0.925234
Validation prc-auc = 0.968508
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 24
Loss = 1.8710e-01, PNorm = 68.5218, GNorm = 0.5958, lr_0 = 1.8030e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.969834
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 25
Loss = 1.8692e-01, PNorm = 68.5414, GNorm = 0.4856, lr_0 = 1.7709e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.972105
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 26
Validation auc = 0.943273
Validation accuracy = 0.925234
Validation prc-auc = 0.973571
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 27
Loss = 1.3417e-01, PNorm = 68.5636, GNorm = 0.1929, lr_0 = 1.7424e-04
Validation auc = 0.944779
Validation accuracy = 0.925234
Validation prc-auc = 0.973978
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 28
Loss = 2.1107e-01, PNorm = 68.5830, GNorm = 0.8731, lr_0 = 1.7424e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.974029
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 29
Loss = 1.8924e-01, PNorm = 68.6047, GNorm = 0.3850, lr_0 = 1.7424e-04
Validation auc = 0.944277
Validation accuracy = 0.915888
Validation prc-auc = 0.975066
Validation f1 = 0.947977
Validation mcc = 0.746943
Model 2 best validation auc = 0.944779 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.986088
Model 2 test accuracy = 0.966667
Model 2 test prc-auc = 0.995830
Model 2 test f1 = 0.979167
Model 2 test mcc = 0.900898
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.919679
Validation accuracy = 0.925234
Validation prc-auc = 0.962638
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 1
Loss = 4.4333e-01, PNorm = 67.4830, GNorm = 0.4895, lr_0 = 1.1868e-03
Validation auc = 0.925703
Validation accuracy = 0.925234
Validation prc-auc = 0.963834
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 2
Loss = 3.9240e-01, PNorm = 68.0367, GNorm = 0.3413, lr_0 = 8.0296e-04
Validation auc = 0.930221
Validation accuracy = 0.934579
Validation prc-auc = 0.965656
Validation f1 = 0.959538
Validation mcc = 0.808233
Epoch 3
Loss = 3.4679e-01, PNorm = 68.2053, GNorm = 0.2761, lr_0 = 3.8068e-04
Validation auc = 0.933735
Validation accuracy = 0.925234
Validation prc-auc = 0.966234
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 4
Loss = 2.5651e-01, PNorm = 68.2384, GNorm = 0.4641, lr_0 = 2.6218e-04
Validation auc = 0.935743
Validation accuracy = 0.934579
Validation prc-auc = 0.967989
Validation f1 = 0.959538
Validation mcc = 0.808233
Epoch 5
Loss = 2.8119e-01, PNorm = 68.2558, GNorm = 0.4173, lr_0 = 2.5751e-04
Validation auc = 0.935743
Validation accuracy = 0.934579
Validation prc-auc = 0.965073
Validation f1 = 0.959538
Validation mcc = 0.808233
Epoch 6
Loss = 2.5692e-01, PNorm = 68.2706, GNorm = 0.3133, lr_0 = 2.5246e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.965529
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 7
Loss = 2.3038e-01, PNorm = 68.2834, GNorm = 0.4458, lr_0 = 2.4795e-04
Validation auc = 0.937249
Validation accuracy = 0.925234
Validation prc-auc = 0.965751
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 8
Loss = 2.6928e-01, PNorm = 68.2982, GNorm = 0.3065, lr_0 = 2.4309e-04
Validation auc = 0.937249
Validation accuracy = 0.915888
Validation prc-auc = 0.966803
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 9
Loss = 1.9993e-01, PNorm = 68.3112, GNorm = 0.9820, lr_0 = 2.3876e-04
Validation auc = 0.936747
Validation accuracy = 0.925234
Validation prc-auc = 0.964410
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 10
Loss = 2.3070e-01, PNorm = 68.3247, GNorm = 0.2664, lr_0 = 2.3450e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.965607
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 11
Loss = 2.0144e-01, PNorm = 68.3390, GNorm = 0.3382, lr_0 = 2.2990e-04
Validation auc = 0.937249
Validation accuracy = 0.925234
Validation prc-auc = 0.964607
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 12
Loss = 2.0835e-01, PNorm = 68.3527, GNorm = 0.4363, lr_0 = 2.2580e-04
Validation auc = 0.936245
Validation accuracy = 0.915888
Validation prc-auc = 0.965527
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 13
Loss = 1.9893e-01, PNorm = 68.3668, GNorm = 0.2464, lr_0 = 2.2177e-04
Validation auc = 0.939759
Validation accuracy = 0.915888
Validation prc-auc = 0.965310
Validation f1 = 0.947368
Validation mcc = 0.746849
Epoch 14
Loss = 2.1593e-01, PNorm = 68.3829, GNorm = 0.2758, lr_0 = 2.1742e-04
Validation auc = 0.940763
Validation accuracy = 0.915888
Validation prc-auc = 0.966903
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 15
Loss = 2.3052e-01, PNorm = 68.3978, GNorm = 0.3780, lr_0 = 2.1354e-04
Validation auc = 0.938755
Validation accuracy = 0.915888
Validation prc-auc = 0.965034
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 16
Loss = 2.2475e-01, PNorm = 68.4136, GNorm = 0.4003, lr_0 = 2.0936e-04
Validation auc = 0.939759
Validation accuracy = 0.925234
Validation prc-auc = 0.965342
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 17
Loss = 2.2206e-01, PNorm = 68.4300, GNorm = 0.4412, lr_0 = 2.0562e-04
Validation auc = 0.939759
Validation accuracy = 0.925234
Validation prc-auc = 0.965342
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 18
Loss = 2.0891e-01, PNorm = 68.4443, GNorm = 1.2263, lr_0 = 2.0195e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.965508
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 19
Loss = 2.2405e-01, PNorm = 68.4580, GNorm = 0.6394, lr_0 = 1.9800e-04
Validation auc = 0.941265
Validation accuracy = 0.925234
Validation prc-auc = 0.968242
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 20
Loss = 2.1438e-01, PNorm = 68.4752, GNorm = 0.9631, lr_0 = 1.9446e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.968366
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 21
Loss = 2.1217e-01, PNorm = 68.4919, GNorm = 0.3854, lr_0 = 1.9099e-04
Validation auc = 0.941767
Validation accuracy = 0.925234
Validation prc-auc = 0.968351
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 22
Loss = 2.0348e-01, PNorm = 68.5096, GNorm = 0.9508, lr_0 = 1.8725e-04
Validation auc = 0.941767
Validation accuracy = 0.915888
Validation prc-auc = 0.969360
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 23
Loss = 1.9315e-01, PNorm = 68.5244, GNorm = 0.6409, lr_0 = 1.8391e-04
Loss = 1.6552e-01, PNorm = 68.5261, GNorm = 0.5122, lr_0 = 1.8358e-04
Validation auc = 0.942269
Validation accuracy = 0.915888
Validation prc-auc = 0.968499
Validation f1 = 0.947368
Validation mcc = 0.746849
Epoch 24
Loss = 2.0055e-01, PNorm = 68.5425, GNorm = 1.1936, lr_0 = 1.8030e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.970559
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 25
Loss = 1.9311e-01, PNorm = 68.5586, GNorm = 0.5363, lr_0 = 1.7709e-04
Validation auc = 0.942771
Validation accuracy = 0.915888
Validation prc-auc = 0.969650
Validation f1 = 0.947368
Validation mcc = 0.746849
Epoch 26
Validation auc = 0.943775
Validation accuracy = 0.925234
Validation prc-auc = 0.971692
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 27
Loss = 2.7463e-01, PNorm = 68.5765, GNorm = 1.0933, lr_0 = 1.7424e-04
Validation auc = 0.943775
Validation accuracy = 0.925234
Validation prc-auc = 0.973139
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 28
Loss = 1.9710e-01, PNorm = 68.5895, GNorm = 0.9111, lr_0 = 1.7424e-04
Validation auc = 0.943775
Validation accuracy = 0.906542
Validation prc-auc = 0.973139
Validation f1 = 0.941860
Validation mcc = 0.716529
Epoch 29
Loss = 1.6730e-01, PNorm = 68.6066, GNorm = 0.6447, lr_0 = 1.7424e-04
Validation auc = 0.944779
Validation accuracy = 0.906542
Validation prc-auc = 0.973466
Validation f1 = 0.941860
Validation mcc = 0.716529
Model 3 best validation auc = 0.944779 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.988543
Model 3 test accuracy = 0.958333
Model 3 test prc-auc = 0.996701
Model 3 test f1 = 0.974093
Model 3 test mcc = 0.875728
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.921687
Validation accuracy = 0.915888
Validation prc-auc = 0.958499
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 1
Loss = 4.3926e-01, PNorm = 67.4295, GNorm = 0.4672, lr_0 = 1.1868e-03
Validation auc = 0.923193
Validation accuracy = 0.915888
Validation prc-auc = 0.956936
Validation f1 = 0.946746
Validation mcc = 0.749715
Epoch 2
Loss = 2.7335e-01, PNorm = 67.9966, GNorm = 0.3382, lr_0 = 8.0296e-04
Validation auc = 0.926205
Validation accuracy = 0.925234
Validation prc-auc = 0.959889
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 3
Loss = 3.1652e-01, PNorm = 68.1721, GNorm = 0.3534, lr_0 = 3.8068e-04
Validation auc = 0.929217
Validation accuracy = 0.925234
Validation prc-auc = 0.962416
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 4
Loss = 2.2296e-01, PNorm = 68.2063, GNorm = 0.2107, lr_0 = 2.6218e-04
Validation auc = 0.929217
Validation accuracy = 0.925234
Validation prc-auc = 0.962447
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 5
Loss = 2.8957e-01, PNorm = 68.2244, GNorm = 0.2563, lr_0 = 2.5751e-04
Validation auc = 0.932731
Validation accuracy = 0.925234
Validation prc-auc = 0.963991
Validation f1 = 0.953488
Validation mcc = 0.776427
Epoch 6
Loss = 2.2732e-01, PNorm = 68.2397, GNorm = 0.2736, lr_0 = 2.5246e-04
Validation auc = 0.935743
Validation accuracy = 0.925234
Validation prc-auc = 0.962468
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 7
Loss = 2.3278e-01, PNorm = 68.2532, GNorm = 0.3040, lr_0 = 2.4795e-04
Validation auc = 0.937249
Validation accuracy = 0.925234
Validation prc-auc = 0.962944
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 8
Loss = 2.5798e-01, PNorm = 68.2684, GNorm = 0.3838, lr_0 = 2.4309e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.962812
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 9
Loss = 2.1552e-01, PNorm = 68.2832, GNorm = 0.2093, lr_0 = 2.3876e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.959102
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 10
Loss = 2.3389e-01, PNorm = 68.2980, GNorm = 0.8300, lr_0 = 2.3450e-04
Validation auc = 0.936747
Validation accuracy = 0.915888
Validation prc-auc = 0.959117
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 11
Loss = 1.9284e-01, PNorm = 68.3150, GNorm = 0.5649, lr_0 = 2.2990e-04
Validation auc = 0.939257
Validation accuracy = 0.915888
Validation prc-auc = 0.959936
Validation f1 = 0.947368
Validation mcc = 0.746849
Epoch 12
Loss = 2.3502e-01, PNorm = 68.3277, GNorm = 0.5613, lr_0 = 2.2580e-04
Validation auc = 0.937249
Validation accuracy = 0.915888
Validation prc-auc = 0.961336
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 13
Loss = 2.2480e-01, PNorm = 68.3433, GNorm = 0.2687, lr_0 = 2.2177e-04
Validation auc = 0.937751
Validation accuracy = 0.915888
Validation prc-auc = 0.959447
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 14
Loss = 2.3887e-01, PNorm = 68.3610, GNorm = 0.3403, lr_0 = 2.1742e-04
Validation auc = 0.938253
Validation accuracy = 0.915888
Validation prc-auc = 0.961724
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 15
Loss = 2.0781e-01, PNorm = 68.3785, GNorm = 0.2691, lr_0 = 2.1354e-04
Validation auc = 0.938755
Validation accuracy = 0.915888
Validation prc-auc = 0.961859
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 16
Loss = 2.1235e-01, PNorm = 68.3960, GNorm = 0.2781, lr_0 = 2.0936e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.964031
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 17
Loss = 1.9996e-01, PNorm = 68.4123, GNorm = 0.5961, lr_0 = 2.0562e-04
Validation auc = 0.940261
Validation accuracy = 0.915888
Validation prc-auc = 0.964017
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 18
Loss = 2.1701e-01, PNorm = 68.4309, GNorm = 0.2491, lr_0 = 2.0195e-04
Validation auc = 0.940763
Validation accuracy = 0.915888
Validation prc-auc = 0.964193
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 19
Loss = 1.9340e-01, PNorm = 68.4482, GNorm = 0.3888, lr_0 = 1.9800e-04
Validation auc = 0.942269
Validation accuracy = 0.925234
Validation prc-auc = 0.964615
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 20
Loss = 1.9306e-01, PNorm = 68.4643, GNorm = 0.7153, lr_0 = 1.9446e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.964047
Validation f1 = 0.952941
Validation mcc = 0.776692
Epoch 21
Loss = 2.1208e-01, PNorm = 68.4809, GNorm = 2.6996, lr_0 = 1.9099e-04
Validation auc = 0.940261
Validation accuracy = 0.915888
Validation prc-auc = 0.966787
Validation f1 = 0.948571
Validation mcc = 0.750905
Epoch 22
Loss = 1.9826e-01, PNorm = 68.4940, GNorm = 0.2399, lr_0 = 1.8725e-04
Validation auc = 0.941265
Validation accuracy = 0.906542
Validation prc-auc = 0.969216
Validation f1 = 0.941860
Validation mcc = 0.716529
Epoch 23
Loss = 2.0309e-01, PNorm = 68.5079, GNorm = 1.1445, lr_0 = 1.8391e-04
Loss = 1.6357e-01, PNorm = 68.5095, GNorm = 0.4907, lr_0 = 1.8358e-04
Validation auc = 0.940261
Validation accuracy = 0.925234
Validation prc-auc = 0.968876
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 24
Loss = 1.9261e-01, PNorm = 68.5272, GNorm = 0.4651, lr_0 = 1.8030e-04
Validation auc = 0.942269
Validation accuracy = 0.915888
Validation prc-auc = 0.969535
Validation f1 = 0.947368
Validation mcc = 0.746849
Epoch 25
Loss = 1.9373e-01, PNorm = 68.5448, GNorm = 0.8878, lr_0 = 1.7709e-04
Validation auc = 0.941265
Validation accuracy = 0.915888
Validation prc-auc = 0.969236
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 26
Validation auc = 0.941265
Validation accuracy = 0.915888
Validation prc-auc = 0.969231
Validation f1 = 0.947977
Validation mcc = 0.746943
Epoch 27
Loss = 1.9056e-01, PNorm = 68.5630, GNorm = 0.4316, lr_0 = 1.7424e-04
Validation auc = 0.942771
Validation accuracy = 0.925234
Validation prc-auc = 0.969645
Validation f1 = 0.954023
Validation mcc = 0.779781
Epoch 28
Loss = 2.1827e-01, PNorm = 68.5802, GNorm = 0.4205, lr_0 = 1.7424e-04
Validation auc = 0.943273
Validation accuracy = 0.934579
Validation prc-auc = 0.969796
Validation f1 = 0.959064
Validation mcc = 0.805480
Epoch 29
Loss = 1.9282e-01, PNorm = 68.5981, GNorm = 0.3414, lr_0 = 1.7424e-04
Validation auc = 0.942269
Validation accuracy = 0.915888
Validation prc-auc = 0.969535
Validation f1 = 0.947977
Validation mcc = 0.746943
Model 4 best validation auc = 0.943273 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.985270
Model 4 test accuracy = 0.966667
Model 4 test prc-auc = 0.995577
Model 4 test f1 = 0.979167
Model 4 test mcc = 0.900898
Ensemble test auc = 0.987316
Ensemble test accuracy = 0.966667
Ensemble test prc-auc = 0.996238
Ensemble test f1 = 0.979167
Ensemble test mcc = 0.900898
Fold 4
Splitting data with seed 4
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.908021
Validation accuracy = 0.934579
Validation prc-auc = 0.953883
Validation f1 = 0.960452
Validation mcc = 0.793688
Epoch 1
Loss = 3.3663e-01, PNorm = 67.4418, GNorm = 0.2488, lr_0 = 1.1868e-03
Validation auc = 0.912299
Validation accuracy = 0.915888
Validation prc-auc = 0.959131
Validation f1 = 0.946746
Validation mcc = 0.747075
Epoch 2
Loss = 3.0518e-01, PNorm = 67.9950, GNorm = 0.2862, lr_0 = 8.0296e-04
Validation auc = 0.913904
Validation accuracy = 0.925234
Validation prc-auc = 0.961175
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 3
Loss = 1.6718e-01, PNorm = 68.1640, GNorm = 0.2213, lr_0 = 3.8068e-04
Validation auc = 0.918182
Validation accuracy = 0.925234
Validation prc-auc = 0.963575
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 4
Loss = 2.8479e-01, PNorm = 68.1961, GNorm = 0.2310, lr_0 = 2.6218e-04
Validation auc = 0.920321
Validation accuracy = 0.934579
Validation prc-auc = 0.963994
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 5
Loss = 2.6343e-01, PNorm = 68.2120, GNorm = 0.3417, lr_0 = 2.5751e-04
Validation auc = 0.923529
Validation accuracy = 0.915888
Validation prc-auc = 0.965599
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 6
Loss = 2.2959e-01, PNorm = 68.2269, GNorm = 0.1853, lr_0 = 2.5246e-04
Validation auc = 0.924599
Validation accuracy = 0.915888
Validation prc-auc = 0.966171
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 7
Loss = 2.5415e-01, PNorm = 68.2394, GNorm = 0.3107, lr_0 = 2.4795e-04
Validation auc = 0.925668
Validation accuracy = 0.925234
Validation prc-auc = 0.965893
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 8
Loss = 2.3213e-01, PNorm = 68.2531, GNorm = 0.4812, lr_0 = 2.4309e-04
Validation auc = 0.927807
Validation accuracy = 0.915888
Validation prc-auc = 0.966733
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 9
Loss = 2.7600e-01, PNorm = 68.2671, GNorm = 0.6903, lr_0 = 2.3876e-04
Validation auc = 0.931016
Validation accuracy = 0.943925
Validation prc-auc = 0.967891
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 10
Loss = 2.7637e-01, PNorm = 68.2815, GNorm = 0.5264, lr_0 = 2.3450e-04
Validation auc = 0.932086
Validation accuracy = 0.925234
Validation prc-auc = 0.967242
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 11
Loss = 2.1055e-01, PNorm = 68.2967, GNorm = 0.3245, lr_0 = 2.2990e-04
Validation auc = 0.933155
Validation accuracy = 0.953271
Validation prc-auc = 0.968559
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 12
Loss = 1.8119e-01, PNorm = 68.3121, GNorm = 0.4063, lr_0 = 2.2580e-04
Validation auc = 0.934759
Validation accuracy = 0.934579
Validation prc-auc = 0.968101
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 13
Loss = 2.3537e-01, PNorm = 68.3265, GNorm = 0.2897, lr_0 = 2.2177e-04
Validation auc = 0.935829
Validation accuracy = 0.953271
Validation prc-auc = 0.969383
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 14
Loss = 2.2013e-01, PNorm = 68.3430, GNorm = 0.2917, lr_0 = 2.1742e-04
Validation auc = 0.936898
Validation accuracy = 0.943925
Validation prc-auc = 0.968694
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 15
Loss = 2.3159e-01, PNorm = 68.3609, GNorm = 0.2371, lr_0 = 2.1354e-04
Validation auc = 0.936898
Validation accuracy = 0.953271
Validation prc-auc = 0.968711
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 16
Loss = 2.3423e-01, PNorm = 68.3788, GNorm = 0.8095, lr_0 = 2.0936e-04
Validation auc = 0.938503
Validation accuracy = 0.953271
Validation prc-auc = 0.969141
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 17
Loss = 2.2126e-01, PNorm = 68.3943, GNorm = 0.6610, lr_0 = 2.0562e-04
Validation auc = 0.938503
Validation accuracy = 0.934579
Validation prc-auc = 0.970123
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 18
Loss = 2.3160e-01, PNorm = 68.4077, GNorm = 0.7546, lr_0 = 2.0195e-04
Validation auc = 0.939037
Validation accuracy = 0.943925
Validation prc-auc = 0.971148
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 19
Loss = 2.1822e-01, PNorm = 68.4251, GNorm = 0.6266, lr_0 = 1.9800e-04
Validation auc = 0.940642
Validation accuracy = 0.953271
Validation prc-auc = 0.973804
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 20
Loss = 1.9987e-01, PNorm = 68.4427, GNorm = 0.2754, lr_0 = 1.9446e-04
Validation auc = 0.942246
Validation accuracy = 0.943925
Validation prc-auc = 0.975416
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 21
Loss = 2.2039e-01, PNorm = 68.4587, GNorm = 0.2837, lr_0 = 1.9099e-04
Validation auc = 0.944385
Validation accuracy = 0.953271
Validation prc-auc = 0.975470
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 22
Loss = 2.1467e-01, PNorm = 68.4767, GNorm = 0.3665, lr_0 = 1.8725e-04
Validation auc = 0.945989
Validation accuracy = 0.953271
Validation prc-auc = 0.977493
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 23
Loss = 2.0199e-01, PNorm = 68.4943, GNorm = 0.3231, lr_0 = 1.8391e-04
Loss = 2.3731e-01, PNorm = 68.4961, GNorm = 0.6598, lr_0 = 1.8358e-04
Validation auc = 0.944385
Validation accuracy = 0.953271
Validation prc-auc = 0.977037
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 24
Loss = 2.0178e-01, PNorm = 68.5134, GNorm = 1.1776, lr_0 = 1.8030e-04
Validation auc = 0.945455
Validation accuracy = 0.953271
Validation prc-auc = 0.977351
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 25
Loss = 1.9542e-01, PNorm = 68.5299, GNorm = 1.0822, lr_0 = 1.7709e-04
Validation auc = 0.947059
Validation accuracy = 0.943925
Validation prc-auc = 0.978252
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 26
Validation auc = 0.948663
Validation accuracy = 0.953271
Validation prc-auc = 0.980275
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 27
Loss = 2.2283e-01, PNorm = 68.5472, GNorm = 0.2770, lr_0 = 1.7424e-04
Validation auc = 0.948663
Validation accuracy = 0.953271
Validation prc-auc = 0.980275
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 28
Loss = 1.8519e-01, PNorm = 68.5656, GNorm = 0.5161, lr_0 = 1.7424e-04
Validation auc = 0.948663
Validation accuracy = 0.943925
Validation prc-auc = 0.980261
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 29
Loss = 2.1001e-01, PNorm = 68.5861, GNorm = 0.7810, lr_0 = 1.7424e-04
Validation auc = 0.950267
Validation accuracy = 0.943925
Validation prc-auc = 0.981349
Validation f1 = 0.965116
Validation mcc = 0.823803
Model 0 best validation auc = 0.950267 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.991408
Model 0 test accuracy = 0.975000
Model 0 test prc-auc = 0.997519
Model 0 test f1 = 0.984127
Model 0 test mcc = 0.925598
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.905882
Validation accuracy = 0.943925
Validation prc-auc = 0.956220
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 1
Loss = 3.2775e-01, PNorm = 67.4401, GNorm = 0.2960, lr_0 = 1.1868e-03
Validation auc = 0.916043
Validation accuracy = 0.906542
Validation prc-auc = 0.964024
Validation f1 = 0.940476
Validation mcc = 0.724339
Epoch 2
Loss = 2.2921e-01, PNorm = 67.9956, GNorm = 0.2789, lr_0 = 8.0296e-04
Validation auc = 0.919786
Validation accuracy = 0.934579
Validation prc-auc = 0.965206
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 3
Loss = 3.3489e-01, PNorm = 68.1680, GNorm = 0.4009, lr_0 = 3.8068e-04
Validation auc = 0.926203
Validation accuracy = 0.925234
Validation prc-auc = 0.968142
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 4
Loss = 2.7768e-01, PNorm = 68.2028, GNorm = 0.2673, lr_0 = 2.6218e-04
Validation auc = 0.928342
Validation accuracy = 0.925234
Validation prc-auc = 0.969047
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 5
Loss = 2.3071e-01, PNorm = 68.2216, GNorm = 0.3748, lr_0 = 2.5751e-04
Validation auc = 0.926738
Validation accuracy = 0.915888
Validation prc-auc = 0.967215
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 6
Loss = 3.1024e-01, PNorm = 68.2384, GNorm = 0.2250, lr_0 = 2.5246e-04
Validation auc = 0.927807
Validation accuracy = 0.925234
Validation prc-auc = 0.967627
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 7
Loss = 2.5637e-01, PNorm = 68.2522, GNorm = 0.6794, lr_0 = 2.4795e-04
Validation auc = 0.933690
Validation accuracy = 0.915888
Validation prc-auc = 0.971153
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 8
Loss = 2.1335e-01, PNorm = 68.2685, GNorm = 0.3803, lr_0 = 2.4309e-04
Validation auc = 0.933690
Validation accuracy = 0.934579
Validation prc-auc = 0.969652
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 9
Loss = 2.5760e-01, PNorm = 68.2843, GNorm = 1.4725, lr_0 = 2.3876e-04
Validation auc = 0.933690
Validation accuracy = 0.915888
Validation prc-auc = 0.968765
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 10
Loss = 2.4821e-01, PNorm = 68.2984, GNorm = 0.3561, lr_0 = 2.3450e-04
Validation auc = 0.934225
Validation accuracy = 0.943925
Validation prc-auc = 0.969810
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 11
Loss = 2.3619e-01, PNorm = 68.3149, GNorm = 0.4534, lr_0 = 2.2990e-04
Validation auc = 0.934759
Validation accuracy = 0.943925
Validation prc-auc = 0.969977
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 12
Loss = 2.2444e-01, PNorm = 68.3302, GNorm = 0.4919, lr_0 = 2.2580e-04
Validation auc = 0.935294
Validation accuracy = 0.934579
Validation prc-auc = 0.970082
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 13
Loss = 2.2390e-01, PNorm = 68.3457, GNorm = 0.3337, lr_0 = 2.2177e-04
Validation auc = 0.936364
Validation accuracy = 0.943925
Validation prc-auc = 0.970377
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 14
Loss = 2.3664e-01, PNorm = 68.3636, GNorm = 0.5222, lr_0 = 2.1742e-04
Validation auc = 0.938503
Validation accuracy = 0.953271
Validation prc-auc = 0.971015
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 15
Loss = 2.0472e-01, PNorm = 68.3797, GNorm = 0.5677, lr_0 = 2.1354e-04
Validation auc = 0.937433
Validation accuracy = 0.943925
Validation prc-auc = 0.970694
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 16
Loss = 2.1733e-01, PNorm = 68.3973, GNorm = 0.2581, lr_0 = 2.0936e-04
Validation auc = 0.940107
Validation accuracy = 0.953271
Validation prc-auc = 0.969621
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 17
Loss = 2.1046e-01, PNorm = 68.4148, GNorm = 0.3065, lr_0 = 2.0562e-04
Validation auc = 0.941176
Validation accuracy = 0.953271
Validation prc-auc = 0.971769
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 18
Loss = 2.0735e-01, PNorm = 68.4323, GNorm = 0.6429, lr_0 = 2.0195e-04
Validation auc = 0.940642
Validation accuracy = 0.943925
Validation prc-auc = 0.973155
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 19
Loss = 1.9698e-01, PNorm = 68.4494, GNorm = 0.2733, lr_0 = 1.9800e-04
Validation auc = 0.941711
Validation accuracy = 0.943925
Validation prc-auc = 0.974707
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 20
Loss = 2.0542e-01, PNorm = 68.4669, GNorm = 0.3246, lr_0 = 1.9446e-04
Validation auc = 0.944920
Validation accuracy = 0.953271
Validation prc-auc = 0.976730
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 21
Loss = 1.9938e-01, PNorm = 68.4858, GNorm = 0.5567, lr_0 = 1.9099e-04
Validation auc = 0.945455
Validation accuracy = 0.953271
Validation prc-auc = 0.977351
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 22
Loss = 1.8994e-01, PNorm = 68.5049, GNorm = 0.4490, lr_0 = 1.8725e-04
Validation auc = 0.948663
Validation accuracy = 0.943925
Validation prc-auc = 0.980874
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 23
Loss = 2.0862e-01, PNorm = 68.5225, GNorm = 0.9072, lr_0 = 1.8391e-04
Loss = 2.0449e-01, PNorm = 68.5245, GNorm = 1.6151, lr_0 = 1.8358e-04
Validation auc = 0.951337
Validation accuracy = 0.943925
Validation prc-auc = 0.981919
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 24
Loss = 1.9456e-01, PNorm = 68.5444, GNorm = 0.7492, lr_0 = 1.8030e-04
Validation auc = 0.950802
Validation accuracy = 0.953271
Validation prc-auc = 0.981778
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 25
Loss = 1.8643e-01, PNorm = 68.5639, GNorm = 0.9504, lr_0 = 1.7709e-04
Validation auc = 0.950802
Validation accuracy = 0.953271
Validation prc-auc = 0.982075
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 26
Validation auc = 0.952941
Validation accuracy = 0.953271
Validation prc-auc = 0.982944
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 27
Loss = 1.8265e-01, PNorm = 68.5851, GNorm = 0.3820, lr_0 = 1.7424e-04
Validation auc = 0.952406
Validation accuracy = 0.943925
Validation prc-auc = 0.983880
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 28
Loss = 2.2182e-01, PNorm = 68.6052, GNorm = 1.5653, lr_0 = 1.7424e-04
Validation auc = 0.956150
Validation accuracy = 0.953271
Validation prc-auc = 0.985151
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 29
Loss = 1.8991e-01, PNorm = 68.6242, GNorm = 0.5302, lr_0 = 1.7424e-04
Validation auc = 0.957219
Validation accuracy = 0.943925
Validation prc-auc = 0.985634
Validation f1 = 0.965517
Validation mcc = 0.822153
Model 1 best validation auc = 0.957219 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.992226
Model 1 test accuracy = 0.966667
Model 1 test prc-auc = 0.997775
Model 1 test f1 = 0.979167
Model 1 test mcc = 0.900898
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.910695
Validation accuracy = 0.943925
Validation prc-auc = 0.960452
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 1
Loss = 2.8119e-01, PNorm = 67.3919, GNorm = 0.3356, lr_0 = 1.1868e-03
Validation auc = 0.912834
Validation accuracy = 0.925234
Validation prc-auc = 0.961643
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 2
Loss = 2.9775e-01, PNorm = 67.9512, GNorm = 0.3009, lr_0 = 8.0296e-04
Validation auc = 0.922460
Validation accuracy = 0.915888
Validation prc-auc = 0.968112
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 3
Loss = 3.0860e-01, PNorm = 68.1207, GNorm = 0.2595, lr_0 = 3.8068e-04
Validation auc = 0.925134
Validation accuracy = 0.915888
Validation prc-auc = 0.968843
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 4
Loss = 2.6411e-01, PNorm = 68.1524, GNorm = 0.3563, lr_0 = 2.6218e-04
Validation auc = 0.925668
Validation accuracy = 0.943925
Validation prc-auc = 0.968475
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 5
Loss = 2.7901e-01, PNorm = 68.1689, GNorm = 0.1985, lr_0 = 2.5751e-04
Validation auc = 0.928877
Validation accuracy = 0.915888
Validation prc-auc = 0.969859
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 6
Loss = 2.8190e-01, PNorm = 68.1835, GNorm = 0.2411, lr_0 = 2.5246e-04
Validation auc = 0.928342
Validation accuracy = 0.925234
Validation prc-auc = 0.968390
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 7
Loss = 2.6643e-01, PNorm = 68.1953, GNorm = 0.3279, lr_0 = 2.4795e-04
Validation auc = 0.930481
Validation accuracy = 0.934579
Validation prc-auc = 0.969215
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 8
Loss = 2.4209e-01, PNorm = 68.2100, GNorm = 0.4595, lr_0 = 2.4309e-04
Validation auc = 0.934225
Validation accuracy = 0.915888
Validation prc-auc = 0.970555
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 9
Loss = 2.3337e-01, PNorm = 68.2248, GNorm = 0.2284, lr_0 = 2.3876e-04
Validation auc = 0.935829
Validation accuracy = 0.953271
Validation prc-auc = 0.971757
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 10
Loss = 2.1666e-01, PNorm = 68.2398, GNorm = 0.2915, lr_0 = 2.3450e-04
Validation auc = 0.935829
Validation accuracy = 0.925234
Validation prc-auc = 0.971070
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 11
Loss = 1.9172e-01, PNorm = 68.2569, GNorm = 0.3131, lr_0 = 2.2990e-04
Validation auc = 0.936898
Validation accuracy = 0.953271
Validation prc-auc = 0.972110
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 12
Loss = 2.3098e-01, PNorm = 68.2716, GNorm = 0.3347, lr_0 = 2.2580e-04
Validation auc = 0.936898
Validation accuracy = 0.953271
Validation prc-auc = 0.972110
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 13
Loss = 2.3739e-01, PNorm = 68.2871, GNorm = 0.2480, lr_0 = 2.2177e-04
Validation auc = 0.939037
Validation accuracy = 0.953271
Validation prc-auc = 0.972722
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 14
Loss = 2.3247e-01, PNorm = 68.3066, GNorm = 0.3146, lr_0 = 2.1742e-04
Validation auc = 0.940107
Validation accuracy = 0.953271
Validation prc-auc = 0.973010
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 15
Loss = 2.0317e-01, PNorm = 68.3234, GNorm = 0.7243, lr_0 = 2.1354e-04
Validation auc = 0.940107
Validation accuracy = 0.943925
Validation prc-auc = 0.973627
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 16
Loss = 2.0772e-01, PNorm = 68.3427, GNorm = 0.4353, lr_0 = 2.0936e-04
Validation auc = 0.942781
Validation accuracy = 0.953271
Validation prc-auc = 0.975576
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 17
Loss = 1.9254e-01, PNorm = 68.3597, GNorm = 0.4145, lr_0 = 2.0562e-04
Validation auc = 0.943850
Validation accuracy = 0.953271
Validation prc-auc = 0.976885
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 18
Loss = 1.9285e-01, PNorm = 68.3777, GNorm = 0.3118, lr_0 = 2.0195e-04
Validation auc = 0.946524
Validation accuracy = 0.953271
Validation prc-auc = 0.979292
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 19
Loss = 2.0622e-01, PNorm = 68.3977, GNorm = 1.2300, lr_0 = 1.9800e-04
Validation auc = 0.947594
Validation accuracy = 0.953271
Validation prc-auc = 0.980281
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 20
Loss = 2.1087e-01, PNorm = 68.4168, GNorm = 1.2443, lr_0 = 1.9446e-04
Validation auc = 0.950267
Validation accuracy = 0.953271
Validation prc-auc = 0.981628
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 21
Loss = 1.9508e-01, PNorm = 68.4359, GNorm = 0.2492, lr_0 = 1.9099e-04
Validation auc = 0.948128
Validation accuracy = 0.943925
Validation prc-auc = 0.980728
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 22
Loss = 2.0013e-01, PNorm = 68.4574, GNorm = 0.5673, lr_0 = 1.8725e-04
Validation auc = 0.951872
Validation accuracy = 0.953271
Validation prc-auc = 0.982610
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 23
Loss = 1.9584e-01, PNorm = 68.4764, GNorm = 0.5444, lr_0 = 1.8391e-04
Loss = 1.3595e-01, PNorm = 68.4785, GNorm = 0.3341, lr_0 = 1.8358e-04
Validation auc = 0.952941
Validation accuracy = 0.953271
Validation prc-auc = 0.983853
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 24
Loss = 1.9391e-01, PNorm = 68.5001, GNorm = 0.3705, lr_0 = 1.8030e-04
Validation auc = 0.956150
Validation accuracy = 0.953271
Validation prc-auc = 0.984526
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 25
Loss = 1.8634e-01, PNorm = 68.5213, GNorm = 0.9799, lr_0 = 1.7709e-04
Validation auc = 0.953476
Validation accuracy = 0.953271
Validation prc-auc = 0.983583
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 26
Validation auc = 0.952406
Validation accuracy = 0.953271
Validation prc-auc = 0.982531
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 27
Loss = 2.5356e-01, PNorm = 68.5449, GNorm = 0.7406, lr_0 = 1.7424e-04
Validation auc = 0.955080
Validation accuracy = 0.953271
Validation prc-auc = 0.984254
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 28
Loss = 3.0382e-01, PNorm = 68.5630, GNorm = 1.2302, lr_0 = 1.7424e-04
Validation auc = 0.958824
Validation accuracy = 0.943925
Validation prc-auc = 0.986247
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 29
Loss = 1.3362e-01, PNorm = 68.5854, GNorm = 0.4205, lr_0 = 1.7424e-04
Validation auc = 0.958289
Validation accuracy = 0.953271
Validation prc-auc = 0.986436
Validation f1 = 0.971098
Validation mcc = 0.852830
Model 2 best validation auc = 0.958824 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.990998
Model 2 test accuracy = 0.950000
Model 2 test prc-auc = 0.997411
Model 2 test f1 = 0.969072
Model 2 test mcc = 0.850339
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.903743
Validation accuracy = 0.943925
Validation prc-auc = 0.949075
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 1
Loss = 3.0219e-01, PNorm = 67.4656, GNorm = 0.2564, lr_0 = 1.1868e-03
Validation auc = 0.910160
Validation accuracy = 0.906542
Validation prc-auc = 0.959114
Validation f1 = 0.940476
Validation mcc = 0.724339
Epoch 2
Loss = 3.5299e-01, PNorm = 68.0150, GNorm = 0.3557, lr_0 = 8.0296e-04
Validation auc = 0.911765
Validation accuracy = 0.934579
Validation prc-auc = 0.960059
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 3
Loss = 2.2224e-01, PNorm = 68.1803, GNorm = 0.1911, lr_0 = 3.8068e-04
Validation auc = 0.919251
Validation accuracy = 0.925234
Validation prc-auc = 0.964604
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 4
Loss = 3.0384e-01, PNorm = 68.2122, GNorm = 0.2760, lr_0 = 2.6218e-04
Validation auc = 0.920321
Validation accuracy = 0.925234
Validation prc-auc = 0.964793
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 5
Loss = 2.4471e-01, PNorm = 68.2275, GNorm = 0.2749, lr_0 = 2.5751e-04
Validation auc = 0.923529
Validation accuracy = 0.915888
Validation prc-auc = 0.966289
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 6
Loss = 2.8156e-01, PNorm = 68.2401, GNorm = 0.2277, lr_0 = 2.5246e-04
Validation auc = 0.926203
Validation accuracy = 0.915888
Validation prc-auc = 0.967502
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 7
Loss = 2.6002e-01, PNorm = 68.2500, GNorm = 0.2187, lr_0 = 2.4795e-04
Validation auc = 0.926738
Validation accuracy = 0.915888
Validation prc-auc = 0.967799
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 8
Loss = 2.7559e-01, PNorm = 68.2621, GNorm = 0.3434, lr_0 = 2.4309e-04
Validation auc = 0.927807
Validation accuracy = 0.943925
Validation prc-auc = 0.967503
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 9
Loss = 2.2555e-01, PNorm = 68.2741, GNorm = 0.4702, lr_0 = 2.3876e-04
Validation auc = 0.928877
Validation accuracy = 0.925234
Validation prc-auc = 0.967166
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 10
Loss = 2.5649e-01, PNorm = 68.2856, GNorm = 0.5677, lr_0 = 2.3450e-04
Validation auc = 0.930481
Validation accuracy = 0.953271
Validation prc-auc = 0.969215
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 11
Loss = 2.5279e-01, PNorm = 68.2976, GNorm = 0.6388, lr_0 = 2.2990e-04
Validation auc = 0.933155
Validation accuracy = 0.915888
Validation prc-auc = 0.968587
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 12
Loss = 2.0677e-01, PNorm = 68.3099, GNorm = 0.7181, lr_0 = 2.2580e-04
Validation auc = 0.934759
Validation accuracy = 0.953271
Validation prc-auc = 0.969942
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 13
Loss = 2.1918e-01, PNorm = 68.3237, GNorm = 0.2644, lr_0 = 2.2177e-04
Validation auc = 0.935829
Validation accuracy = 0.925234
Validation prc-auc = 0.971079
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 14
Loss = 2.2519e-01, PNorm = 68.3398, GNorm = 0.3988, lr_0 = 2.1742e-04
Validation auc = 0.937968
Validation accuracy = 0.953271
Validation prc-auc = 0.971711
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 15
Loss = 2.1305e-01, PNorm = 68.3554, GNorm = 0.2770, lr_0 = 2.1354e-04
Validation auc = 0.936898
Validation accuracy = 0.925234
Validation prc-auc = 0.971366
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 16
Loss = 2.1760e-01, PNorm = 68.3716, GNorm = 0.5148, lr_0 = 2.0936e-04
Validation auc = 0.937968
Validation accuracy = 0.953271
Validation prc-auc = 0.970886
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 17
Loss = 2.0816e-01, PNorm = 68.3874, GNorm = 0.9748, lr_0 = 2.0562e-04
Validation auc = 0.939037
Validation accuracy = 0.953271
Validation prc-auc = 0.970305
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 18
Loss = 2.2933e-01, PNorm = 68.4020, GNorm = 0.3565, lr_0 = 2.0195e-04
Validation auc = 0.940107
Validation accuracy = 0.953271
Validation prc-auc = 0.973017
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 19
Loss = 2.2452e-01, PNorm = 68.4185, GNorm = 0.2709, lr_0 = 1.9800e-04
Validation auc = 0.941711
Validation accuracy = 0.925234
Validation prc-auc = 0.974691
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 20
Loss = 2.2067e-01, PNorm = 68.4358, GNorm = 0.4267, lr_0 = 1.9446e-04
Validation auc = 0.943850
Validation accuracy = 0.953271
Validation prc-auc = 0.975294
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 21
Loss = 2.0422e-01, PNorm = 68.4526, GNorm = 0.2464, lr_0 = 1.9099e-04
Validation auc = 0.942781
Validation accuracy = 0.925234
Validation prc-auc = 0.976078
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 22
Loss = 2.1572e-01, PNorm = 68.4702, GNorm = 0.4115, lr_0 = 1.8725e-04
Validation auc = 0.948663
Validation accuracy = 0.943925
Validation prc-auc = 0.977724
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 23
Loss = 2.0897e-01, PNorm = 68.4849, GNorm = 0.4356, lr_0 = 1.8391e-04
Loss = 2.2625e-01, PNorm = 68.4864, GNorm = 0.3085, lr_0 = 1.8358e-04
Validation auc = 0.948128
Validation accuracy = 0.925234
Validation prc-auc = 0.979726
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 24
Loss = 2.0744e-01, PNorm = 68.5019, GNorm = 0.3759, lr_0 = 1.8030e-04
Validation auc = 0.951872
Validation accuracy = 0.953271
Validation prc-auc = 0.981786
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 25
Loss = 2.0391e-01, PNorm = 68.5199, GNorm = 0.5550, lr_0 = 1.7709e-04
Validation auc = 0.951337
Validation accuracy = 0.943925
Validation prc-auc = 0.981642
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 26
Validation auc = 0.952406
Validation accuracy = 0.943925
Validation prc-auc = 0.981947
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 27
Loss = 1.9029e-01, PNorm = 68.5388, GNorm = 0.2936, lr_0 = 1.7424e-04
Validation auc = 0.951337
Validation accuracy = 0.953271
Validation prc-auc = 0.980986
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 28
Loss = 2.0029e-01, PNorm = 68.5565, GNorm = 0.2831, lr_0 = 1.7424e-04
Validation auc = 0.950267
Validation accuracy = 0.943925
Validation prc-auc = 0.980711
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 29
Loss = 1.6541e-01, PNorm = 68.5765, GNorm = 0.4293, lr_0 = 1.7424e-04
Validation auc = 0.951337
Validation accuracy = 0.953271
Validation prc-auc = 0.982237
Validation f1 = 0.971098
Validation mcc = 0.852830
Model 3 best validation auc = 0.952406 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.990589
Model 3 test accuracy = 0.966667
Model 3 test prc-auc = 0.997305
Model 3 test f1 = 0.979167
Model 3 test mcc = 0.900898
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.910695
Validation accuracy = 0.943925
Validation prc-auc = 0.959673
Validation f1 = 0.965909
Validation mcc = 0.824209
Epoch 1
Loss = 3.1231e-01, PNorm = 67.4172, GNorm = 0.2514, lr_0 = 1.1868e-03
Validation auc = 0.914973
Validation accuracy = 0.925234
Validation prc-auc = 0.963523
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 2
Loss = 2.4537e-01, PNorm = 67.9740, GNorm = 0.3125, lr_0 = 8.0296e-04
Validation auc = 0.919786
Validation accuracy = 0.925234
Validation prc-auc = 0.964763
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 3
Loss = 3.0454e-01, PNorm = 68.1464, GNorm = 0.3107, lr_0 = 3.8068e-04
Validation auc = 0.924064
Validation accuracy = 0.915888
Validation prc-auc = 0.966645
Validation f1 = 0.947368
Validation mcc = 0.738414
Epoch 4
Loss = 3.0235e-01, PNorm = 68.1796, GNorm = 0.6677, lr_0 = 2.6218e-04
Validation auc = 0.925134
Validation accuracy = 0.925234
Validation prc-auc = 0.967125
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 5
Loss = 1.7789e-01, PNorm = 68.1968, GNorm = 0.2174, lr_0 = 2.5751e-04
Validation auc = 0.927807
Validation accuracy = 0.925234
Validation prc-auc = 0.968246
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 6
Loss = 2.0607e-01, PNorm = 68.2113, GNorm = 0.2362, lr_0 = 2.5246e-04
Validation auc = 0.927807
Validation accuracy = 0.925234
Validation prc-auc = 0.968246
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 7
Loss = 2.7164e-01, PNorm = 68.2221, GNorm = 0.4638, lr_0 = 2.4795e-04
Validation auc = 0.928342
Validation accuracy = 0.943925
Validation prc-auc = 0.968593
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 8
Loss = 2.8550e-01, PNorm = 68.2352, GNorm = 0.5084, lr_0 = 2.4309e-04
Validation auc = 0.933690
Validation accuracy = 0.925234
Validation prc-auc = 0.970421
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 9
Loss = 2.4212e-01, PNorm = 68.2489, GNorm = 0.3223, lr_0 = 2.3876e-04
Validation auc = 0.933690
Validation accuracy = 0.934579
Validation prc-auc = 0.969652
Validation f1 = 0.959538
Validation mcc = 0.792317
Epoch 10
Loss = 2.8761e-01, PNorm = 68.2631, GNorm = 0.7454, lr_0 = 2.3450e-04
Validation auc = 0.934225
Validation accuracy = 0.925234
Validation prc-auc = 0.970622
Validation f1 = 0.953488
Validation mcc = 0.764485
Epoch 11
Loss = 2.4666e-01, PNorm = 68.2779, GNorm = 0.2165, lr_0 = 2.2990e-04
Validation auc = 0.935829
Validation accuracy = 0.943925
Validation prc-auc = 0.969406
Validation f1 = 0.965517
Validation mcc = 0.822153
Epoch 12
Loss = 2.5015e-01, PNorm = 68.2937, GNorm = 0.3819, lr_0 = 2.2580e-04
Validation auc = 0.935829
Validation accuracy = 0.953271
Validation prc-auc = 0.968425
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 13
Loss = 2.5604e-01, PNorm = 68.3084, GNorm = 1.4806, lr_0 = 2.2177e-04
Validation auc = 0.936898
Validation accuracy = 0.925234
Validation prc-auc = 0.970552
Validation f1 = 0.952941
Validation mcc = 0.771123
Epoch 14
Loss = 2.3566e-01, PNorm = 68.3219, GNorm = 0.2890, lr_0 = 2.1742e-04
Validation auc = 0.939037
Validation accuracy = 0.953271
Validation prc-auc = 0.972694
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 15
Loss = 2.3067e-01, PNorm = 68.3361, GNorm = 0.2423, lr_0 = 2.1354e-04
Validation auc = 0.938503
Validation accuracy = 0.943925
Validation prc-auc = 0.973180
Validation f1 = 0.965116
Validation mcc = 0.823803
Epoch 16
Loss = 2.2489e-01, PNorm = 68.3533, GNorm = 0.2775, lr_0 = 2.0936e-04
Validation auc = 0.940107
Validation accuracy = 0.953271
Validation prc-auc = 0.973662
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 17
Loss = 2.1537e-01, PNorm = 68.3667, GNorm = 0.8276, lr_0 = 2.0562e-04
Validation auc = 0.941711
Validation accuracy = 0.953271
Validation prc-auc = 0.974709
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 18
Loss = 1.9959e-01, PNorm = 68.3812, GNorm = 0.2961, lr_0 = 2.0195e-04
Validation auc = 0.941176
Validation accuracy = 0.962617
Validation prc-auc = 0.973913
Validation f1 = 0.977011
Validation mcc = 0.883974
Epoch 19
Loss = 2.0026e-01, PNorm = 68.3981, GNorm = 0.5505, lr_0 = 1.9800e-04
Validation auc = 0.943316
Validation accuracy = 0.953271
Validation prc-auc = 0.974549
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 20
Loss = 2.1333e-01, PNorm = 68.4126, GNorm = 0.6798, lr_0 = 1.9446e-04
Validation auc = 0.943850
Validation accuracy = 0.953271
Validation prc-auc = 0.976840
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 21
Loss = 2.1309e-01, PNorm = 68.4265, GNorm = 0.3484, lr_0 = 1.9099e-04
Validation auc = 0.946524
Validation accuracy = 0.953271
Validation prc-auc = 0.978510
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 22
Loss = 2.0503e-01, PNorm = 68.4442, GNorm = 0.3874, lr_0 = 1.8725e-04
Validation auc = 0.945989
Validation accuracy = 0.953271
Validation prc-auc = 0.979089
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 23
Loss = 2.0926e-01, PNorm = 68.4606, GNorm = 0.6937, lr_0 = 1.8391e-04
Loss = 2.0307e-01, PNorm = 68.4622, GNorm = 0.3357, lr_0 = 1.8358e-04
Validation auc = 0.949733
Validation accuracy = 0.953271
Validation prc-auc = 0.980523
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 24
Loss = 1.9334e-01, PNorm = 68.4789, GNorm = 0.4365, lr_0 = 1.8030e-04
Validation auc = 0.948663
Validation accuracy = 0.953271
Validation prc-auc = 0.980209
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 25
Loss = 1.9634e-01, PNorm = 68.4954, GNorm = 0.7052, lr_0 = 1.7709e-04
Validation auc = 0.949198
Validation accuracy = 0.962617
Validation prc-auc = 0.980022
Validation f1 = 0.977011
Validation mcc = 0.883974
Epoch 26
Validation auc = 0.949733
Validation accuracy = 0.953271
Validation prc-auc = 0.981184
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 27
Loss = 2.0646e-01, PNorm = 68.5125, GNorm = 1.3859, lr_0 = 1.7424e-04
Validation auc = 0.951872
Validation accuracy = 0.953271
Validation prc-auc = 0.982063
Validation f1 = 0.971429
Validation mcc = 0.854282
Epoch 28
Loss = 1.6278e-01, PNorm = 68.5263, GNorm = 0.8562, lr_0 = 1.7424e-04
Validation auc = 0.955080
Validation accuracy = 0.953271
Validation prc-auc = 0.984225
Validation f1 = 0.971098
Validation mcc = 0.852830
Epoch 29
Loss = 1.4135e-01, PNorm = 68.5429, GNorm = 0.5620, lr_0 = 1.7424e-04
Validation auc = 0.954545
Validation accuracy = 0.953271
Validation prc-auc = 0.983851
Validation f1 = 0.971098
Validation mcc = 0.852830
Model 4 best validation auc = 0.955080 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.990998
Model 4 test accuracy = 0.966667
Model 4 test prc-auc = 0.997411
Model 4 test f1 = 0.979167
Model 4 test mcc = 0.900898
Ensemble test auc = 0.992226
Ensemble test accuracy = 0.966667
Ensemble test prc-auc = 0.997775
Ensemble test f1 = 0.979167
Ensemble test mcc = 0.900898
Fold 5
Splitting data with seed 5
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.869421
Validation accuracy = 0.887850
Validation prc-auc = 0.936076
Validation f1 = 0.931034
Validation mcc = 0.684823
Epoch 1
Loss = 3.9290e-01, PNorm = 67.4597, GNorm = 0.2364, lr_0 = 1.1868e-03
Validation auc = 0.871320
Validation accuracy = 0.887850
Validation prc-auc = 0.937920
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 2
Loss = 3.2073e-01, PNorm = 68.0127, GNorm = 0.4050, lr_0 = 8.0296e-04
Validation auc = 0.877018
Validation accuracy = 0.878505
Validation prc-auc = 0.940247
Validation f1 = 0.923077
Validation mcc = 0.649083
Epoch 3
Loss = 3.0678e-01, PNorm = 68.1802, GNorm = 0.3172, lr_0 = 3.8068e-04
Validation auc = 0.882241
Validation accuracy = 0.887850
Validation prc-auc = 0.943531
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 4
Loss = 3.1074e-01, PNorm = 68.2115, GNorm = 0.3699, lr_0 = 2.6218e-04
Validation auc = 0.884141
Validation accuracy = 0.887850
Validation prc-auc = 0.944454
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 5
Loss = 2.5828e-01, PNorm = 68.2268, GNorm = 0.4988, lr_0 = 2.5751e-04
Validation auc = 0.888414
Validation accuracy = 0.887850
Validation prc-auc = 0.946331
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 6
Loss = 2.7051e-01, PNorm = 68.2395, GNorm = 0.6324, lr_0 = 2.5246e-04
Validation auc = 0.891738
Validation accuracy = 0.887850
Validation prc-auc = 0.947445
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 7
Loss = 2.3562e-01, PNorm = 68.2494, GNorm = 0.2726, lr_0 = 2.4795e-04
Validation auc = 0.894587
Validation accuracy = 0.897196
Validation prc-auc = 0.949486
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 8
Loss = 2.4554e-01, PNorm = 68.2618, GNorm = 0.4477, lr_0 = 2.4309e-04
Validation auc = 0.895537
Validation accuracy = 0.897196
Validation prc-auc = 0.951945
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 9
Loss = 2.2036e-01, PNorm = 68.2715, GNorm = 0.3209, lr_0 = 2.3876e-04
Validation auc = 0.896486
Validation accuracy = 0.897196
Validation prc-auc = 0.952404
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 10
Loss = 2.4231e-01, PNorm = 68.2838, GNorm = 0.3597, lr_0 = 2.3450e-04
Validation auc = 0.898386
Validation accuracy = 0.897196
Validation prc-auc = 0.953452
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 11
Loss = 2.3930e-01, PNorm = 68.2949, GNorm = 0.6092, lr_0 = 2.2990e-04
Validation auc = 0.902184
Validation accuracy = 0.897196
Validation prc-auc = 0.955884
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 12
Loss = 2.3558e-01, PNorm = 68.3075, GNorm = 0.1986, lr_0 = 2.2580e-04
Validation auc = 0.903609
Validation accuracy = 0.897196
Validation prc-auc = 0.955697
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 13
Loss = 1.9479e-01, PNorm = 68.3195, GNorm = 0.3021, lr_0 = 2.2177e-04
Validation auc = 0.905033
Validation accuracy = 0.897196
Validation prc-auc = 0.957142
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 14
Loss = 2.0541e-01, PNorm = 68.3353, GNorm = 0.2553, lr_0 = 2.1742e-04
Validation auc = 0.906933
Validation accuracy = 0.906542
Validation prc-auc = 0.956894
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 15
Loss = 2.2145e-01, PNorm = 68.3487, GNorm = 0.5706, lr_0 = 2.1354e-04
Validation auc = 0.909307
Validation accuracy = 0.906542
Validation prc-auc = 0.957708
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 16
Loss = 2.1400e-01, PNorm = 68.3640, GNorm = 0.3009, lr_0 = 2.0936e-04
Validation auc = 0.908832
Validation accuracy = 0.906542
Validation prc-auc = 0.959185
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 17
Loss = 2.1167e-01, PNorm = 68.3752, GNorm = 0.2191, lr_0 = 2.0562e-04
Validation auc = 0.910256
Validation accuracy = 0.897196
Validation prc-auc = 0.959564
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 18
Loss = 2.0866e-01, PNorm = 68.3884, GNorm = 0.2794, lr_0 = 2.0195e-04
Validation auc = 0.909782
Validation accuracy = 0.906542
Validation prc-auc = 0.960210
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 19
Loss = 1.8071e-01, PNorm = 68.4046, GNorm = 0.3395, lr_0 = 1.9800e-04
Validation auc = 0.912631
Validation accuracy = 0.906542
Validation prc-auc = 0.961123
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 20
Loss = 1.9655e-01, PNorm = 68.4202, GNorm = 0.7073, lr_0 = 1.9446e-04
Validation auc = 0.913105
Validation accuracy = 0.915888
Validation prc-auc = 0.961830
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 21
Loss = 2.0378e-01, PNorm = 68.4335, GNorm = 0.2972, lr_0 = 1.9099e-04
Validation auc = 0.913105
Validation accuracy = 0.897196
Validation prc-auc = 0.961758
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 22
Loss = 1.9909e-01, PNorm = 68.4520, GNorm = 0.7189, lr_0 = 1.8725e-04
Validation auc = 0.911206
Validation accuracy = 0.915888
Validation prc-auc = 0.961271
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 23
Loss = 1.8209e-01, PNorm = 68.4686, GNorm = 0.4885, lr_0 = 1.8391e-04
Loss = 3.7752e-01, PNorm = 68.4702, GNorm = 0.5491, lr_0 = 1.8358e-04
Validation auc = 0.911681
Validation accuracy = 0.906542
Validation prc-auc = 0.960630
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 24
Loss = 1.8489e-01, PNorm = 68.4851, GNorm = 0.6337, lr_0 = 1.8030e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.961115
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 25
Loss = 1.9034e-01, PNorm = 68.5001, GNorm = 0.8537, lr_0 = 1.7709e-04
Validation auc = 0.913105
Validation accuracy = 0.906542
Validation prc-auc = 0.962371
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 26
Validation auc = 0.911681
Validation accuracy = 0.915888
Validation prc-auc = 0.962041
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 27
Loss = 6.6692e-02, PNorm = 68.5175, GNorm = 0.5235, lr_0 = 1.7424e-04
Validation auc = 0.913105
Validation accuracy = 0.915888
Validation prc-auc = 0.963366
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 28
Loss = 2.1873e-01, PNorm = 68.5325, GNorm = 0.6853, lr_0 = 1.7424e-04
Validation auc = 0.916429
Validation accuracy = 0.906542
Validation prc-auc = 0.965753
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 29
Loss = 1.8273e-01, PNorm = 68.5477, GNorm = 0.7348, lr_0 = 1.7424e-04
Validation auc = 0.916429
Validation accuracy = 0.915888
Validation prc-auc = 0.966268
Validation f1 = 0.947368
Validation mcc = 0.767112
Model 0 best validation auc = 0.916429 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.989362
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.996922
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.869896
Validation accuracy = 0.878505
Validation prc-auc = 0.934531
Validation f1 = 0.924855
Validation mcc = 0.649937
Epoch 1
Loss = 2.6945e-01, PNorm = 67.4297, GNorm = 0.2445, lr_0 = 1.1868e-03
Validation auc = 0.871795
Validation accuracy = 0.878505
Validation prc-auc = 0.933916
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 2
Loss = 3.3317e-01, PNorm = 67.9770, GNorm = 0.2342, lr_0 = 8.0296e-04
Validation auc = 0.881292
Validation accuracy = 0.887850
Validation prc-auc = 0.940402
Validation f1 = 0.929412
Validation mcc = 0.677267
Epoch 3
Loss = 2.3946e-01, PNorm = 68.1440, GNorm = 0.1977, lr_0 = 3.8068e-04
Validation auc = 0.886515
Validation accuracy = 0.887850
Validation prc-auc = 0.943247
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 4
Loss = 2.4873e-01, PNorm = 68.1762, GNorm = 0.3024, lr_0 = 2.6218e-04
Validation auc = 0.891738
Validation accuracy = 0.878505
Validation prc-auc = 0.945847
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 5
Loss = 2.2756e-01, PNorm = 68.1924, GNorm = 0.3279, lr_0 = 2.5751e-04
Validation auc = 0.893637
Validation accuracy = 0.887850
Validation prc-auc = 0.948087
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 6
Loss = 2.2138e-01, PNorm = 68.2064, GNorm = 0.3310, lr_0 = 2.5246e-04
Validation auc = 0.896961
Validation accuracy = 0.887850
Validation prc-auc = 0.950664
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 7
Loss = 2.8973e-01, PNorm = 68.2185, GNorm = 0.2962, lr_0 = 2.4795e-04
Validation auc = 0.900285
Validation accuracy = 0.897196
Validation prc-auc = 0.951794
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 8
Loss = 2.7973e-01, PNorm = 68.2316, GNorm = 0.3657, lr_0 = 2.4309e-04
Validation auc = 0.901235
Validation accuracy = 0.897196
Validation prc-auc = 0.952192
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 9
Loss = 2.7127e-01, PNorm = 68.2459, GNorm = 0.4622, lr_0 = 2.3876e-04
Validation auc = 0.902659
Validation accuracy = 0.897196
Validation prc-auc = 0.952766
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 10
Loss = 1.7812e-01, PNorm = 68.2614, GNorm = 0.3710, lr_0 = 2.3450e-04
Validation auc = 0.905033
Validation accuracy = 0.878505
Validation prc-auc = 0.952425
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 11
Loss = 2.4129e-01, PNorm = 68.2767, GNorm = 0.2803, lr_0 = 2.2990e-04
Validation auc = 0.905033
Validation accuracy = 0.906542
Validation prc-auc = 0.952502
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 12
Loss = 2.3313e-01, PNorm = 68.2875, GNorm = 0.3181, lr_0 = 2.2580e-04
Validation auc = 0.906458
Validation accuracy = 0.897196
Validation prc-auc = 0.955084
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 13
Loss = 2.3061e-01, PNorm = 68.3004, GNorm = 1.2882, lr_0 = 2.2177e-04
Validation auc = 0.905508
Validation accuracy = 0.915888
Validation prc-auc = 0.954798
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 14
Loss = 2.3588e-01, PNorm = 68.3134, GNorm = 1.3458, lr_0 = 2.1742e-04
Validation auc = 0.907882
Validation accuracy = 0.897196
Validation prc-auc = 0.955574
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 15
Loss = 2.1680e-01, PNorm = 68.3255, GNorm = 0.3580, lr_0 = 2.1354e-04
Validation auc = 0.907882
Validation accuracy = 0.897196
Validation prc-auc = 0.956446
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 16
Loss = 1.9007e-01, PNorm = 68.3412, GNorm = 0.1893, lr_0 = 2.0936e-04
Validation auc = 0.908832
Validation accuracy = 0.906542
Validation prc-auc = 0.956803
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 17
Loss = 1.8783e-01, PNorm = 68.3555, GNorm = 0.2103, lr_0 = 2.0562e-04
Validation auc = 0.910256
Validation accuracy = 0.906542
Validation prc-auc = 0.958090
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 18
Loss = 2.1938e-01, PNorm = 68.3706, GNorm = 0.3144, lr_0 = 2.0195e-04
Validation auc = 0.909782
Validation accuracy = 0.906542
Validation prc-auc = 0.957203
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 19
Loss = 2.0009e-01, PNorm = 68.3895, GNorm = 0.4027, lr_0 = 1.9800e-04
Validation auc = 0.909307
Validation accuracy = 0.915888
Validation prc-auc = 0.957157
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 20
Loss = 2.0134e-01, PNorm = 68.4030, GNorm = 0.3838, lr_0 = 1.9446e-04
Validation auc = 0.909782
Validation accuracy = 0.887850
Validation prc-auc = 0.957158
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 21
Loss = 2.1775e-01, PNorm = 68.4173, GNorm = 0.7092, lr_0 = 1.9099e-04
Validation auc = 0.910256
Validation accuracy = 0.915888
Validation prc-auc = 0.958392
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 22
Loss = 2.0711e-01, PNorm = 68.4342, GNorm = 0.3955, lr_0 = 1.8725e-04
Validation auc = 0.912156
Validation accuracy = 0.915888
Validation prc-auc = 0.960521
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 23
Loss = 1.9208e-01, PNorm = 68.4516, GNorm = 0.3770, lr_0 = 1.8391e-04
Loss = 2.3605e-01, PNorm = 68.4531, GNorm = 0.3227, lr_0 = 1.8358e-04
Validation auc = 0.911206
Validation accuracy = 0.915888
Validation prc-auc = 0.959532
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 24
Loss = 1.9281e-01, PNorm = 68.4698, GNorm = 0.5552, lr_0 = 1.8030e-04
Validation auc = 0.911206
Validation accuracy = 0.915888
Validation prc-auc = 0.960864
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 25
Loss = 1.8840e-01, PNorm = 68.4872, GNorm = 0.4031, lr_0 = 1.7709e-04
Validation auc = 0.912156
Validation accuracy = 0.906542
Validation prc-auc = 0.961231
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 26
Validation auc = 0.913580
Validation accuracy = 0.915888
Validation prc-auc = 0.962421
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 27
Loss = 9.7110e-02, PNorm = 68.5057, GNorm = 0.2809, lr_0 = 1.7424e-04
Validation auc = 0.913580
Validation accuracy = 0.915888
Validation prc-auc = 0.962521
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 28
Loss = 1.3481e-01, PNorm = 68.5222, GNorm = 0.3360, lr_0 = 1.7424e-04
Validation auc = 0.917379
Validation accuracy = 0.906542
Validation prc-auc = 0.965101
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 29
Loss = 2.3178e-01, PNorm = 68.5406, GNorm = 0.7981, lr_0 = 1.7424e-04
Validation auc = 0.916904
Validation accuracy = 0.915888
Validation prc-auc = 0.965478
Validation f1 = 0.947368
Validation mcc = 0.767112
Model 1 best validation auc = 0.917379 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.990998
Model 1 test accuracy = 0.975000
Model 1 test prc-auc = 0.997411
Model 1 test f1 = 0.984293
Model 1 test mcc = 0.925881
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.870370
Validation accuracy = 0.887850
Validation prc-auc = 0.936145
Validation f1 = 0.931034
Validation mcc = 0.684823
Epoch 1
Loss = 3.4220e-01, PNorm = 67.3898, GNorm = 0.2871, lr_0 = 1.1868e-03
Validation auc = 0.877493
Validation accuracy = 0.887850
Validation prc-auc = 0.940213
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 2
Loss = 2.3024e-01, PNorm = 67.9525, GNorm = 0.7814, lr_0 = 8.0296e-04
Validation auc = 0.880817
Validation accuracy = 0.887850
Validation prc-auc = 0.943154
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 3
Loss = 2.3931e-01, PNorm = 68.1220, GNorm = 0.2593, lr_0 = 3.8068e-04
Validation auc = 0.886515
Validation accuracy = 0.887850
Validation prc-auc = 0.947604
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 4
Loss = 2.7188e-01, PNorm = 68.1542, GNorm = 0.2218, lr_0 = 2.6218e-04
Validation auc = 0.889364
Validation accuracy = 0.897196
Validation prc-auc = 0.950047
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 5
Loss = 2.3292e-01, PNorm = 68.1710, GNorm = 0.2892, lr_0 = 2.5751e-04
Validation auc = 0.891263
Validation accuracy = 0.897196
Validation prc-auc = 0.951007
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 6
Loss = 2.3432e-01, PNorm = 68.1854, GNorm = 0.2372, lr_0 = 2.5246e-04
Validation auc = 0.895537
Validation accuracy = 0.897196
Validation prc-auc = 0.952564
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 7
Loss = 2.4113e-01, PNorm = 68.1981, GNorm = 0.2570, lr_0 = 2.4795e-04
Validation auc = 0.896011
Validation accuracy = 0.897196
Validation prc-auc = 0.952735
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 8
Loss = 2.3354e-01, PNorm = 68.2133, GNorm = 0.3378, lr_0 = 2.4309e-04
Validation auc = 0.898386
Validation accuracy = 0.906542
Validation prc-auc = 0.954232
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 9
Loss = 1.9359e-01, PNorm = 68.2282, GNorm = 0.2765, lr_0 = 2.3876e-04
Validation auc = 0.902659
Validation accuracy = 0.906542
Validation prc-auc = 0.955965
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 10
Loss = 1.8422e-01, PNorm = 68.2436, GNorm = 0.5012, lr_0 = 2.3450e-04
Validation auc = 0.905033
Validation accuracy = 0.906542
Validation prc-auc = 0.957458
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 11
Loss = 2.2857e-01, PNorm = 68.2608, GNorm = 0.3459, lr_0 = 2.2990e-04
Validation auc = 0.906458
Validation accuracy = 0.906542
Validation prc-auc = 0.957324
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 12
Loss = 2.0695e-01, PNorm = 68.2780, GNorm = 0.2683, lr_0 = 2.2580e-04
Validation auc = 0.907882
Validation accuracy = 0.906542
Validation prc-auc = 0.957891
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 13
Loss = 2.2678e-01, PNorm = 68.2951, GNorm = 0.5526, lr_0 = 2.2177e-04
Validation auc = 0.908832
Validation accuracy = 0.915888
Validation prc-auc = 0.959608
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 14
Loss = 1.9939e-01, PNorm = 68.3127, GNorm = 0.4559, lr_0 = 2.1742e-04
Validation auc = 0.910731
Validation accuracy = 0.897196
Validation prc-auc = 0.960057
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 15
Loss = 2.1831e-01, PNorm = 68.3278, GNorm = 0.7550, lr_0 = 2.1354e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.960853
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 16
Loss = 2.0548e-01, PNorm = 68.3472, GNorm = 0.3361, lr_0 = 2.0936e-04
Validation auc = 0.911681
Validation accuracy = 0.915888
Validation prc-auc = 0.961037
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 17
Loss = 2.0153e-01, PNorm = 68.3655, GNorm = 0.2454, lr_0 = 2.0562e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.960980
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 18
Loss = 1.9851e-01, PNorm = 68.3813, GNorm = 1.2280, lr_0 = 2.0195e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.961780
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 19
Loss = 2.0220e-01, PNorm = 68.3991, GNorm = 0.4304, lr_0 = 1.9800e-04
Validation auc = 0.912631
Validation accuracy = 0.906542
Validation prc-auc = 0.963181
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 20
Loss = 1.9593e-01, PNorm = 68.4187, GNorm = 0.4613, lr_0 = 1.9446e-04
Validation auc = 0.914530
Validation accuracy = 0.915888
Validation prc-auc = 0.965012
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 21
Loss = 1.8726e-01, PNorm = 68.4408, GNorm = 0.3542, lr_0 = 1.9099e-04
Validation auc = 0.913580
Validation accuracy = 0.906542
Validation prc-auc = 0.964421
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 22
Loss = 1.9549e-01, PNorm = 68.4605, GNorm = 0.2477, lr_0 = 1.8725e-04
Validation auc = 0.914055
Validation accuracy = 0.915888
Validation prc-auc = 0.965453
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 23
Loss = 1.7846e-01, PNorm = 68.4822, GNorm = 0.5062, lr_0 = 1.8391e-04
Loss = 2.9622e-01, PNorm = 68.4840, GNorm = 1.1504, lr_0 = 1.8358e-04
Validation auc = 0.914530
Validation accuracy = 0.915888
Validation prc-auc = 0.965688
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 24
Loss = 1.8828e-01, PNorm = 68.5030, GNorm = 0.6223, lr_0 = 1.8030e-04
Validation auc = 0.916429
Validation accuracy = 0.906542
Validation prc-auc = 0.967669
Validation f1 = 0.941860
Validation mcc = 0.740108
Epoch 25
Loss = 1.9216e-01, PNorm = 68.5212, GNorm = 1.1250, lr_0 = 1.7709e-04
Validation auc = 0.918329
Validation accuracy = 0.915888
Validation prc-auc = 0.967903
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 26
Validation auc = 0.918803
Validation accuracy = 0.915888
Validation prc-auc = 0.969202
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 27
Loss = 1.0234e-01, PNorm = 68.5440, GNorm = 0.2182, lr_0 = 1.7424e-04
Validation auc = 0.922127
Validation accuracy = 0.915888
Validation prc-auc = 0.970626
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 28
Loss = 2.1205e-01, PNorm = 68.5613, GNorm = 0.5945, lr_0 = 1.7424e-04
Validation auc = 0.922602
Validation accuracy = 0.915888
Validation prc-auc = 0.971229
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 29
Loss = 2.2390e-01, PNorm = 68.5822, GNorm = 0.6830, lr_0 = 1.7424e-04
Validation auc = 0.924501
Validation accuracy = 0.915888
Validation prc-auc = 0.972439
Validation f1 = 0.947368
Validation mcc = 0.767112
Model 2 best validation auc = 0.924501 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.988953
Model 2 test accuracy = 0.958333
Model 2 test prc-auc = 0.996758
Model 2 test f1 = 0.974093
Model 2 test mcc = 0.875728
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.874644
Validation accuracy = 0.897196
Validation prc-auc = 0.941197
Validation f1 = 0.936416
Validation mcc = 0.712701
Epoch 1
Loss = 3.4058e-01, PNorm = 67.4726, GNorm = 0.3169, lr_0 = 1.1868e-03
Validation auc = 0.878443
Validation accuracy = 0.878505
Validation prc-auc = 0.942739
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 2
Loss = 3.1241e-01, PNorm = 68.0267, GNorm = 0.3033, lr_0 = 8.0296e-04
Validation auc = 0.877968
Validation accuracy = 0.887850
Validation prc-auc = 0.942753
Validation f1 = 0.929412
Validation mcc = 0.677267
Epoch 3
Loss = 3.8026e-01, PNorm = 68.1910, GNorm = 1.0293, lr_0 = 3.8068e-04
Validation auc = 0.883666
Validation accuracy = 0.887850
Validation prc-auc = 0.945772
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 4
Loss = 2.5204e-01, PNorm = 68.2230, GNorm = 0.2390, lr_0 = 2.6218e-04
Validation auc = 0.886990
Validation accuracy = 0.897196
Validation prc-auc = 0.947603
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 5
Loss = 2.0169e-01, PNorm = 68.2389, GNorm = 0.3590, lr_0 = 2.5751e-04
Validation auc = 0.890313
Validation accuracy = 0.897196
Validation prc-auc = 0.949787
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 6
Loss = 2.2688e-01, PNorm = 68.2519, GNorm = 0.2468, lr_0 = 2.5246e-04
Validation auc = 0.894112
Validation accuracy = 0.897196
Validation prc-auc = 0.951439
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 7
Loss = 2.4605e-01, PNorm = 68.2623, GNorm = 0.2339, lr_0 = 2.4795e-04
Validation auc = 0.896961
Validation accuracy = 0.897196
Validation prc-auc = 0.952811
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 8
Loss = 2.3617e-01, PNorm = 68.2754, GNorm = 0.4218, lr_0 = 2.4309e-04
Validation auc = 0.897436
Validation accuracy = 0.897196
Validation prc-auc = 0.953272
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 9
Loss = 2.2340e-01, PNorm = 68.2877, GNorm = 0.4092, lr_0 = 2.3876e-04
Validation auc = 0.899335
Validation accuracy = 0.887850
Validation prc-auc = 0.953808
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 10
Loss = 2.0917e-01, PNorm = 68.3010, GNorm = 0.2598, lr_0 = 2.3450e-04
Validation auc = 0.901235
Validation accuracy = 0.897196
Validation prc-auc = 0.954790
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 11
Loss = 1.8990e-01, PNorm = 68.3151, GNorm = 0.2839, lr_0 = 2.2990e-04
Validation auc = 0.904084
Validation accuracy = 0.887850
Validation prc-auc = 0.956305
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 12
Loss = 2.3436e-01, PNorm = 68.3288, GNorm = 0.2608, lr_0 = 2.2580e-04
Validation auc = 0.907882
Validation accuracy = 0.906542
Validation prc-auc = 0.958800
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 13
Loss = 2.4643e-01, PNorm = 68.3423, GNorm = 0.4589, lr_0 = 2.2177e-04
Validation auc = 0.907882
Validation accuracy = 0.906542
Validation prc-auc = 0.958032
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 14
Loss = 2.4201e-01, PNorm = 68.3568, GNorm = 0.3249, lr_0 = 2.1742e-04
Validation auc = 0.909307
Validation accuracy = 0.878505
Validation prc-auc = 0.958407
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 15
Loss = 2.0765e-01, PNorm = 68.3715, GNorm = 0.8690, lr_0 = 2.1354e-04
Validation auc = 0.910731
Validation accuracy = 0.906542
Validation prc-auc = 0.959031
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 16
Loss = 1.9327e-01, PNorm = 68.3883, GNorm = 0.7805, lr_0 = 2.0936e-04
Validation auc = 0.911681
Validation accuracy = 0.906542
Validation prc-auc = 0.960119
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 17
Loss = 2.0785e-01, PNorm = 68.4022, GNorm = 0.2727, lr_0 = 2.0562e-04
Validation auc = 0.911206
Validation accuracy = 0.906542
Validation prc-auc = 0.959884
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 18
Loss = 2.0356e-01, PNorm = 68.4168, GNorm = 0.2223, lr_0 = 2.0195e-04
Validation auc = 0.912156
Validation accuracy = 0.906542
Validation prc-auc = 0.959712
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 19
Loss = 2.1155e-01, PNorm = 68.4352, GNorm = 0.5609, lr_0 = 1.9800e-04
Validation auc = 0.913580
Validation accuracy = 0.906542
Validation prc-auc = 0.960933
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 20
Loss = 1.8633e-01, PNorm = 68.4504, GNorm = 0.2045, lr_0 = 1.9446e-04
Validation auc = 0.915005
Validation accuracy = 0.915888
Validation prc-auc = 0.962104
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 21
Loss = 1.9991e-01, PNorm = 68.4661, GNorm = 0.4307, lr_0 = 1.9099e-04
Validation auc = 0.914055
Validation accuracy = 0.915888
Validation prc-auc = 0.962475
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 22
Loss = 2.0588e-01, PNorm = 68.4837, GNorm = 0.6543, lr_0 = 1.8725e-04
Validation auc = 0.913580
Validation accuracy = 0.915888
Validation prc-auc = 0.961592
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 23
Loss = 2.0948e-01, PNorm = 68.4988, GNorm = 0.5270, lr_0 = 1.8391e-04
Loss = 1.7940e-01, PNorm = 68.5001, GNorm = 1.1887, lr_0 = 1.8358e-04
Validation auc = 0.915480
Validation accuracy = 0.897196
Validation prc-auc = 0.963337
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 24
Loss = 1.9280e-01, PNorm = 68.5150, GNorm = 0.6049, lr_0 = 1.8030e-04
Validation auc = 0.917379
Validation accuracy = 0.915888
Validation prc-auc = 0.966021
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 25
Loss = 1.9563e-01, PNorm = 68.5299, GNorm = 0.9582, lr_0 = 1.7709e-04
Validation auc = 0.916904
Validation accuracy = 0.915888
Validation prc-auc = 0.965719
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 26
Validation auc = 0.916429
Validation accuracy = 0.915888
Validation prc-auc = 0.965588
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 27
Loss = 2.6615e-01, PNorm = 68.5470, GNorm = 0.2819, lr_0 = 1.7424e-04
Validation auc = 0.917379
Validation accuracy = 0.915888
Validation prc-auc = 0.966270
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 28
Loss = 1.8744e-01, PNorm = 68.5624, GNorm = 0.2314, lr_0 = 1.7424e-04
Validation auc = 0.918803
Validation accuracy = 0.915888
Validation prc-auc = 0.966769
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 29
Loss = 1.9883e-01, PNorm = 68.5821, GNorm = 0.5072, lr_0 = 1.7424e-04
Validation auc = 0.918329
Validation accuracy = 0.915888
Validation prc-auc = 0.966742
Validation f1 = 0.947368
Validation mcc = 0.767112
Model 3 best validation auc = 0.918803 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.991408
Model 3 test accuracy = 0.966667
Model 3 test prc-auc = 0.997534
Model 3 test f1 = 0.979167
Model 3 test mcc = 0.900898
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.877018
Validation accuracy = 0.878505
Validation prc-auc = 0.940852
Validation f1 = 0.925714
Validation mcc = 0.656392
Epoch 1
Loss = 3.2148e-01, PNorm = 67.4310, GNorm = 0.2528, lr_0 = 1.1868e-03
Validation auc = 0.878917
Validation accuracy = 0.878505
Validation prc-auc = 0.939294
Validation f1 = 0.922156
Validation mcc = 0.652740
Epoch 2
Loss = 2.9279e-01, PNorm = 67.9935, GNorm = 0.2356, lr_0 = 8.0296e-04
Validation auc = 0.885090
Validation accuracy = 0.887850
Validation prc-auc = 0.943904
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 3
Loss = 2.7936e-01, PNorm = 68.1670, GNorm = 0.3473, lr_0 = 3.8068e-04
Validation auc = 0.888889
Validation accuracy = 0.887850
Validation prc-auc = 0.946609
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 4
Loss = 2.1745e-01, PNorm = 68.2002, GNorm = 0.2847, lr_0 = 2.6218e-04
Validation auc = 0.893637
Validation accuracy = 0.897196
Validation prc-auc = 0.949826
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 5
Loss = 2.6702e-01, PNorm = 68.2161, GNorm = 0.2149, lr_0 = 2.5751e-04
Validation auc = 0.894112
Validation accuracy = 0.897196
Validation prc-auc = 0.950085
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 6
Loss = 1.5860e-01, PNorm = 68.2292, GNorm = 0.2686, lr_0 = 2.5246e-04
Validation auc = 0.896961
Validation accuracy = 0.897196
Validation prc-auc = 0.951404
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 7
Loss = 2.2189e-01, PNorm = 68.2403, GNorm = 0.4319, lr_0 = 2.4795e-04
Validation auc = 0.898860
Validation accuracy = 0.897196
Validation prc-auc = 0.952186
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 8
Loss = 2.3313e-01, PNorm = 68.2524, GNorm = 0.2912, lr_0 = 2.4309e-04
Validation auc = 0.898386
Validation accuracy = 0.897196
Validation prc-auc = 0.951947
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 9
Loss = 2.4478e-01, PNorm = 68.2649, GNorm = 0.3465, lr_0 = 2.3876e-04
Validation auc = 0.901709
Validation accuracy = 0.906542
Validation prc-auc = 0.953472
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 10
Loss = 1.9704e-01, PNorm = 68.2790, GNorm = 0.5760, lr_0 = 2.3450e-04
Validation auc = 0.904084
Validation accuracy = 0.887850
Validation prc-auc = 0.954243
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 11
Loss = 2.0609e-01, PNorm = 68.2953, GNorm = 0.2795, lr_0 = 2.2990e-04
Validation auc = 0.905983
Validation accuracy = 0.897196
Validation prc-auc = 0.955086
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 12
Loss = 2.1171e-01, PNorm = 68.3093, GNorm = 0.6395, lr_0 = 2.2580e-04
Validation auc = 0.905508
Validation accuracy = 0.906542
Validation prc-auc = 0.956550
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 13
Loss = 1.8530e-01, PNorm = 68.3229, GNorm = 0.4969, lr_0 = 2.2177e-04
Validation auc = 0.908832
Validation accuracy = 0.897196
Validation prc-auc = 0.957051
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 14
Loss = 2.1371e-01, PNorm = 68.3384, GNorm = 0.8373, lr_0 = 2.1742e-04
Validation auc = 0.909307
Validation accuracy = 0.915888
Validation prc-auc = 0.957965
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 15
Loss = 2.3795e-01, PNorm = 68.3528, GNorm = 0.3821, lr_0 = 2.1354e-04
Validation auc = 0.910731
Validation accuracy = 0.915888
Validation prc-auc = 0.959269
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 16
Loss = 1.9925e-01, PNorm = 68.3699, GNorm = 1.1923, lr_0 = 2.0936e-04
Validation auc = 0.911206
Validation accuracy = 0.915888
Validation prc-auc = 0.959459
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 17
Loss = 2.1321e-01, PNorm = 68.3859, GNorm = 0.7516, lr_0 = 2.0562e-04
Validation auc = 0.910256
Validation accuracy = 0.887850
Validation prc-auc = 0.958261
Validation f1 = 0.928571
Validation mcc = 0.678587
Epoch 18
Loss = 2.0168e-01, PNorm = 68.4021, GNorm = 0.4834, lr_0 = 2.0195e-04
Validation auc = 0.913105
Validation accuracy = 0.915888
Validation prc-auc = 0.960305
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 19
Loss = 1.9259e-01, PNorm = 68.4213, GNorm = 0.4426, lr_0 = 1.9800e-04
Validation auc = 0.911681
Validation accuracy = 0.906542
Validation prc-auc = 0.959827
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 20
Loss = 2.0274e-01, PNorm = 68.4377, GNorm = 0.2042, lr_0 = 1.9446e-04
Validation auc = 0.908832
Validation accuracy = 0.915888
Validation prc-auc = 0.960253
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 21
Loss = 1.8990e-01, PNorm = 68.4537, GNorm = 0.4990, lr_0 = 1.9099e-04
Validation auc = 0.909782
Validation accuracy = 0.915888
Validation prc-auc = 0.961136
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 22
Loss = 1.9362e-01, PNorm = 68.4726, GNorm = 0.6610, lr_0 = 1.8725e-04
Validation auc = 0.913580
Validation accuracy = 0.915888
Validation prc-auc = 0.962951
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 23
Loss = 1.9737e-01, PNorm = 68.4900, GNorm = 0.6216, lr_0 = 1.8391e-04
Loss = 1.1658e-01, PNorm = 68.4917, GNorm = 1.0659, lr_0 = 1.8358e-04
Validation auc = 0.912156
Validation accuracy = 0.915888
Validation prc-auc = 0.963395
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 24
Loss = 1.8641e-01, PNorm = 68.5059, GNorm = 1.0422, lr_0 = 1.8030e-04
Validation auc = 0.915954
Validation accuracy = 0.897196
Validation prc-auc = 0.965026
Validation f1 = 0.934911
Validation mcc = 0.706104
Epoch 25
Loss = 1.8631e-01, PNorm = 68.5245, GNorm = 0.4089, lr_0 = 1.7709e-04
Validation auc = 0.917379
Validation accuracy = 0.915888
Validation prc-auc = 0.967377
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 26
Validation auc = 0.918329
Validation accuracy = 0.906542
Validation prc-auc = 0.968231
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 27
Loss = 1.4438e-01, PNorm = 68.5435, GNorm = 1.5509, lr_0 = 1.7424e-04
Validation auc = 0.919753
Validation accuracy = 0.906542
Validation prc-auc = 0.968794
Validation f1 = 0.941176
Validation mcc = 0.735521
Epoch 28
Loss = 1.5413e-01, PNorm = 68.5632, GNorm = 0.3283, lr_0 = 1.7424e-04
Validation auc = 0.918803
Validation accuracy = 0.915888
Validation prc-auc = 0.968601
Validation f1 = 0.947368
Validation mcc = 0.767112
Epoch 29
Loss = 1.7392e-01, PNorm = 68.5843, GNorm = 0.5248, lr_0 = 1.7424e-04
Validation auc = 0.920703
Validation accuracy = 0.906542
Validation prc-auc = 0.969239
Validation f1 = 0.941176
Validation mcc = 0.735521
Model 4 best validation auc = 0.920703 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.989771
Model 4 test accuracy = 0.966667
Model 4 test prc-auc = 0.997024
Model 4 test f1 = 0.979167
Model 4 test mcc = 0.900898
Ensemble test auc = 0.990589
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.997283
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 6
Splitting data with seed 6
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.878704
Validation accuracy = 0.887850
Validation prc-auc = 0.936373
Validation f1 = 0.930233
Validation mcc = 0.695048
Epoch 1
Loss = 2.5844e-01, PNorm = 67.4556, GNorm = 0.3199, lr_0 = 1.1868e-03
Validation auc = 0.901852
Validation accuracy = 0.906542
Validation prc-auc = 0.955105
Validation f1 = 0.939024
Validation mcc = 0.743579
Epoch 2
Loss = 2.3655e-01, PNorm = 68.0101, GNorm = 0.6414, lr_0 = 8.0296e-04
Validation auc = 0.904630
Validation accuracy = 0.915888
Validation prc-auc = 0.955921
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 3
Loss = 2.4385e-01, PNorm = 68.1786, GNorm = 0.4642, lr_0 = 3.8068e-04
Validation auc = 0.908333
Validation accuracy = 0.915888
Validation prc-auc = 0.958054
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 4
Loss = 3.0458e-01, PNorm = 68.2107, GNorm = 0.4257, lr_0 = 2.6218e-04
Validation auc = 0.917593
Validation accuracy = 0.915888
Validation prc-auc = 0.963606
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 5
Loss = 2.7220e-01, PNorm = 68.2259, GNorm = 0.2027, lr_0 = 2.5751e-04
Validation auc = 0.919444
Validation accuracy = 0.925234
Validation prc-auc = 0.964276
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 6
Loss = 2.5272e-01, PNorm = 68.2373, GNorm = 0.2127, lr_0 = 2.5246e-04
Validation auc = 0.925926
Validation accuracy = 0.915888
Validation prc-auc = 0.968253
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 7
Loss = 2.7149e-01, PNorm = 68.2473, GNorm = 0.2655, lr_0 = 2.4795e-04
Validation auc = 0.930093
Validation accuracy = 0.925234
Validation prc-auc = 0.970332
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 8
Loss = 2.6379e-01, PNorm = 68.2579, GNorm = 0.4421, lr_0 = 2.4309e-04
Validation auc = 0.932407
Validation accuracy = 0.915888
Validation prc-auc = 0.972103
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 9
Loss = 2.3720e-01, PNorm = 68.2693, GNorm = 0.4409, lr_0 = 2.3876e-04
Validation auc = 0.936111
Validation accuracy = 0.925234
Validation prc-auc = 0.973799
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 10
Loss = 2.3136e-01, PNorm = 68.2803, GNorm = 0.5249, lr_0 = 2.3450e-04
Validation auc = 0.940278
Validation accuracy = 0.915888
Validation prc-auc = 0.975587
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 11
Loss = 2.6093e-01, PNorm = 68.2927, GNorm = 0.3665, lr_0 = 2.2990e-04
Validation auc = 0.943981
Validation accuracy = 0.915888
Validation prc-auc = 0.976601
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 12
Loss = 2.5753e-01, PNorm = 68.3055, GNorm = 0.3051, lr_0 = 2.2580e-04
Validation auc = 0.947685
Validation accuracy = 0.906542
Validation prc-auc = 0.979042
Validation f1 = 0.939024
Validation mcc = 0.743579
Epoch 13
Loss = 2.4432e-01, PNorm = 68.3191, GNorm = 0.2807, lr_0 = 2.2177e-04
Validation auc = 0.946759
Validation accuracy = 0.915888
Validation prc-auc = 0.978046
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 14
Loss = 2.4304e-01, PNorm = 68.3345, GNorm = 0.3314, lr_0 = 2.1742e-04
Validation auc = 0.949074
Validation accuracy = 0.906542
Validation prc-auc = 0.979270
Validation f1 = 0.939024
Validation mcc = 0.743579
Epoch 15
Loss = 2.2742e-01, PNorm = 68.3486, GNorm = 0.1985, lr_0 = 2.1354e-04
Validation auc = 0.950926
Validation accuracy = 0.897196
Validation prc-auc = 0.980253
Validation f1 = 0.932515
Validation mcc = 0.719279
Epoch 16
Loss = 2.3269e-01, PNorm = 68.3639, GNorm = 0.5249, lr_0 = 2.0936e-04
Validation auc = 0.950926
Validation accuracy = 0.906542
Validation prc-auc = 0.979769
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 17
Loss = 2.2155e-01, PNorm = 68.3788, GNorm = 1.0255, lr_0 = 2.0562e-04
Validation auc = 0.951389
Validation accuracy = 0.906542
Validation prc-auc = 0.980049
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 18
Loss = 2.0179e-01, PNorm = 68.3922, GNorm = 0.7286, lr_0 = 2.0195e-04
Validation auc = 0.953704
Validation accuracy = 0.906542
Validation prc-auc = 0.981730
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 19
Loss = 2.0014e-01, PNorm = 68.4073, GNorm = 0.5336, lr_0 = 1.9800e-04
Validation auc = 0.952315
Validation accuracy = 0.906542
Validation prc-auc = 0.980605
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 20
Loss = 2.0304e-01, PNorm = 68.4211, GNorm = 0.3259, lr_0 = 1.9446e-04
Validation auc = 0.954630
Validation accuracy = 0.906542
Validation prc-auc = 0.982753
Validation f1 = 0.937500
Validation mcc = 0.752315
Epoch 21
Loss = 2.0663e-01, PNorm = 68.4371, GNorm = 0.9222, lr_0 = 1.9099e-04
Validation auc = 0.954167
Validation accuracy = 0.897196
Validation prc-auc = 0.982278
Validation f1 = 0.934132
Validation mcc = 0.714927
Epoch 22
Loss = 2.0050e-01, PNorm = 68.4538, GNorm = 0.3186, lr_0 = 1.8725e-04
Validation auc = 0.953241
Validation accuracy = 0.897196
Validation prc-auc = 0.981348
Validation f1 = 0.934132
Validation mcc = 0.714927
Epoch 23
Loss = 1.8715e-01, PNorm = 68.4704, GNorm = 1.1768, lr_0 = 1.8391e-04
Loss = 3.5909e-01, PNorm = 68.4719, GNorm = 2.0913, lr_0 = 1.8358e-04
Validation auc = 0.953241
Validation accuracy = 0.906542
Validation prc-auc = 0.981404
Validation f1 = 0.939759
Validation mcc = 0.742247
Epoch 24
Loss = 1.8886e-01, PNorm = 68.4871, GNorm = 0.4451, lr_0 = 1.8030e-04
Validation auc = 0.954167
Validation accuracy = 0.897196
Validation prc-auc = 0.982441
Validation f1 = 0.930818
Validation mcc = 0.731067
Epoch 25
Loss = 1.9107e-01, PNorm = 68.5042, GNorm = 3.7628, lr_0 = 1.7709e-04
Validation auc = 0.953241
Validation accuracy = 0.906542
Validation prc-auc = 0.982123
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 26
Validation auc = 0.955093
Validation accuracy = 0.897196
Validation prc-auc = 0.983518
Validation f1 = 0.929936
Validation mcc = 0.739119
Epoch 27
Loss = 2.5317e-01, PNorm = 68.5189, GNorm = 1.8681, lr_0 = 1.7424e-04
Validation auc = 0.955556
Validation accuracy = 0.915888
Validation prc-auc = 0.981761
Validation f1 = 0.946746
Validation mcc = 0.774113
Epoch 28
Loss = 1.8418e-01, PNorm = 68.5308, GNorm = 0.9960, lr_0 = 1.7424e-04
Validation auc = 0.956944
Validation accuracy = 0.915888
Validation prc-auc = 0.982999
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 29
Loss = 1.8888e-01, PNorm = 68.5466, GNorm = 0.2363, lr_0 = 1.7424e-04
Validation auc = 0.956944
Validation accuracy = 0.906542
Validation prc-auc = 0.982811
Validation f1 = 0.940476
Validation mcc = 0.743528
Model 0 best validation auc = 0.956944 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.987725
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.996254
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.896759
Validation accuracy = 0.887850
Validation prc-auc = 0.949753
Validation f1 = 0.930233
Validation mcc = 0.695048
Epoch 1
Loss = 2.4666e-01, PNorm = 67.4473, GNorm = 0.2158, lr_0 = 1.1868e-03
Validation auc = 0.908333
Validation accuracy = 0.915888
Validation prc-auc = 0.957831
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 2
Loss = 3.9019e-01, PNorm = 68.0023, GNorm = 0.3397, lr_0 = 8.0296e-04
Validation auc = 0.918519
Validation accuracy = 0.915888
Validation prc-auc = 0.963615
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 3
Loss = 2.3959e-01, PNorm = 68.1727, GNorm = 0.2052, lr_0 = 3.8068e-04
Validation auc = 0.922685
Validation accuracy = 0.915888
Validation prc-auc = 0.966266
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 4
Loss = 2.8901e-01, PNorm = 68.2061, GNorm = 0.2767, lr_0 = 2.6218e-04
Validation auc = 0.926389
Validation accuracy = 0.925234
Validation prc-auc = 0.968259
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 5
Loss = 2.4808e-01, PNorm = 68.2223, GNorm = 0.2648, lr_0 = 2.5751e-04
Validation auc = 0.933333
Validation accuracy = 0.925234
Validation prc-auc = 0.972055
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 6
Loss = 3.0037e-01, PNorm = 68.2360, GNorm = 0.3366, lr_0 = 2.5246e-04
Validation auc = 0.938889
Validation accuracy = 0.925234
Validation prc-auc = 0.974818
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 7
Loss = 2.9601e-01, PNorm = 68.2490, GNorm = 0.2037, lr_0 = 2.4795e-04
Validation auc = 0.941667
Validation accuracy = 0.925234
Validation prc-auc = 0.975760
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 8
Loss = 2.1630e-01, PNorm = 68.2654, GNorm = 0.5796, lr_0 = 2.4309e-04
Validation auc = 0.946759
Validation accuracy = 0.906542
Validation prc-auc = 0.978019
Validation f1 = 0.939024
Validation mcc = 0.743579
Epoch 9
Loss = 2.6623e-01, PNorm = 68.2806, GNorm = 0.7151, lr_0 = 2.3876e-04
Validation auc = 0.949074
Validation accuracy = 0.906542
Validation prc-auc = 0.978535
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 10
Loss = 2.5069e-01, PNorm = 68.2944, GNorm = 0.4088, lr_0 = 2.3450e-04
Validation auc = 0.951389
Validation accuracy = 0.934579
Validation prc-auc = 0.979905
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 11
Loss = 2.3117e-01, PNorm = 68.3116, GNorm = 0.2679, lr_0 = 2.2990e-04
Validation auc = 0.953704
Validation accuracy = 0.934579
Validation prc-auc = 0.981173
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 12
Loss = 2.3185e-01, PNorm = 68.3281, GNorm = 0.2580, lr_0 = 2.2580e-04
Validation auc = 0.955556
Validation accuracy = 0.906542
Validation prc-auc = 0.982018
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 13
Loss = 2.3948e-01, PNorm = 68.3456, GNorm = 0.2979, lr_0 = 2.2177e-04
Validation auc = 0.956944
Validation accuracy = 0.925234
Validation prc-auc = 0.982619
Validation f1 = 0.951220
Validation mcc = 0.795958
Epoch 14
Loss = 2.2437e-01, PNorm = 68.3614, GNorm = 0.8620, lr_0 = 2.1742e-04
Validation auc = 0.955556
Validation accuracy = 0.934579
Validation prc-auc = 0.981784
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 15
Loss = 1.9740e-01, PNorm = 68.3780, GNorm = 1.0531, lr_0 = 2.1354e-04
Validation auc = 0.957870
Validation accuracy = 0.915888
Validation prc-auc = 0.983437
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 16
Loss = 2.0727e-01, PNorm = 68.3937, GNorm = 0.4859, lr_0 = 2.0936e-04
Validation auc = 0.958796
Validation accuracy = 0.934579
Validation prc-auc = 0.983834
Validation f1 = 0.957055
Validation mcc = 0.822446
Epoch 17
Loss = 2.0802e-01, PNorm = 68.4072, GNorm = 0.9095, lr_0 = 2.0562e-04
Validation auc = 0.956481
Validation accuracy = 0.915888
Validation prc-auc = 0.982347
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 18
Loss = 2.0606e-01, PNorm = 68.4222, GNorm = 0.2171, lr_0 = 2.0195e-04
Validation auc = 0.957407
Validation accuracy = 0.934579
Validation prc-auc = 0.982803
Validation f1 = 0.957055
Validation mcc = 0.822446
Epoch 19
Loss = 1.9174e-01, PNorm = 68.4426, GNorm = 0.5744, lr_0 = 1.9800e-04
Validation auc = 0.958796
Validation accuracy = 0.925234
Validation prc-auc = 0.983915
Validation f1 = 0.951220
Validation mcc = 0.795958
Epoch 20
Loss = 1.9588e-01, PNorm = 68.4602, GNorm = 0.4385, lr_0 = 1.9446e-04
Validation auc = 0.958333
Validation accuracy = 0.915888
Validation prc-auc = 0.984232
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 21
Loss = 1.9274e-01, PNorm = 68.4779, GNorm = 0.3900, lr_0 = 1.9099e-04
Validation auc = 0.958333
Validation accuracy = 0.934579
Validation prc-auc = 0.984377
Validation f1 = 0.957055
Validation mcc = 0.822446
Epoch 22
Loss = 2.0489e-01, PNorm = 68.4964, GNorm = 0.9011, lr_0 = 1.8725e-04
Validation auc = 0.957407
Validation accuracy = 0.906542
Validation prc-auc = 0.983711
Validation f1 = 0.937500
Validation mcc = 0.752315
Epoch 23
Loss = 1.8939e-01, PNorm = 68.5138, GNorm = 0.5235, lr_0 = 1.8391e-04
Loss = 2.9002e-01, PNorm = 68.5154, GNorm = 0.9554, lr_0 = 1.8358e-04
Validation auc = 0.959722
Validation accuracy = 0.934579
Validation prc-auc = 0.984416
Validation f1 = 0.957055
Validation mcc = 0.822446
Epoch 24
Loss = 1.8549e-01, PNorm = 68.5345, GNorm = 0.3702, lr_0 = 1.8030e-04
Validation auc = 0.960648
Validation accuracy = 0.925234
Validation prc-auc = 0.984828
Validation f1 = 0.951220
Validation mcc = 0.795958
Epoch 25
Loss = 1.8994e-01, PNorm = 68.5547, GNorm = 0.9639, lr_0 = 1.7709e-04
Validation auc = 0.959722
Validation accuracy = 0.915888
Validation prc-auc = 0.984630
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 26
Validation auc = 0.961111
Validation accuracy = 0.934579
Validation prc-auc = 0.985359
Validation f1 = 0.957055
Validation mcc = 0.822446
Epoch 27
Loss = 8.3491e-02, PNorm = 68.5751, GNorm = 0.2870, lr_0 = 1.7424e-04
Validation auc = 0.958333
Validation accuracy = 0.915888
Validation prc-auc = 0.984564
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 28
Loss = 1.6315e-01, PNorm = 68.5944, GNorm = 0.3197, lr_0 = 1.7424e-04
Validation auc = 0.960185
Validation accuracy = 0.915888
Validation prc-auc = 0.985261
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 29
Loss = 1.3629e-01, PNorm = 68.6151, GNorm = 0.9740, lr_0 = 1.7424e-04
Validation auc = 0.957870
Validation accuracy = 0.906542
Validation prc-auc = 0.983902
Validation f1 = 0.937500
Validation mcc = 0.752315
Model 1 best validation auc = 0.961111 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.990180
Model 1 test accuracy = 0.975000
Model 1 test prc-auc = 0.997136
Model 1 test f1 = 0.984293
Model 1 test mcc = 0.925881
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.899074
Validation accuracy = 0.887850
Validation prc-auc = 0.950855
Validation f1 = 0.930233
Validation mcc = 0.695048
Epoch 1
Loss = 2.9832e-01, PNorm = 67.3757, GNorm = 0.2073, lr_0 = 1.1868e-03
Validation auc = 0.911111
Validation accuracy = 0.915888
Validation prc-auc = 0.959754
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 2
Loss = 1.8020e-01, PNorm = 67.9256, GNorm = 0.3587, lr_0 = 8.0296e-04
Validation auc = 0.914352
Validation accuracy = 0.925234
Validation prc-auc = 0.961804
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 3
Loss = 3.3359e-01, PNorm = 68.0957, GNorm = 0.3661, lr_0 = 3.8068e-04
Validation auc = 0.919444
Validation accuracy = 0.925234
Validation prc-auc = 0.964656
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 4
Loss = 2.2737e-01, PNorm = 68.1272, GNorm = 0.2642, lr_0 = 2.6218e-04
Validation auc = 0.926389
Validation accuracy = 0.925234
Validation prc-auc = 0.968338
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 5
Loss = 2.6385e-01, PNorm = 68.1438, GNorm = 0.4259, lr_0 = 2.5751e-04
Validation auc = 0.931019
Validation accuracy = 0.925234
Validation prc-auc = 0.971053
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 6
Loss = 2.7765e-01, PNorm = 68.1581, GNorm = 0.2813, lr_0 = 2.5246e-04
Validation auc = 0.931481
Validation accuracy = 0.925234
Validation prc-auc = 0.970878
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 7
Loss = 2.6973e-01, PNorm = 68.1713, GNorm = 0.3076, lr_0 = 2.4795e-04
Validation auc = 0.936574
Validation accuracy = 0.925234
Validation prc-auc = 0.973777
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 8
Loss = 2.0520e-01, PNorm = 68.1865, GNorm = 0.4783, lr_0 = 2.4309e-04
Validation auc = 0.941667
Validation accuracy = 0.925234
Validation prc-auc = 0.975972
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 9
Loss = 2.4178e-01, PNorm = 68.2009, GNorm = 0.5668, lr_0 = 2.3876e-04
Validation auc = 0.946296
Validation accuracy = 0.925234
Validation prc-auc = 0.977518
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 10
Loss = 1.8369e-01, PNorm = 68.2171, GNorm = 0.3086, lr_0 = 2.3450e-04
Validation auc = 0.949074
Validation accuracy = 0.934579
Validation prc-auc = 0.979190
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 11
Loss = 2.2273e-01, PNorm = 68.2348, GNorm = 0.4821, lr_0 = 2.2990e-04
Validation auc = 0.952778
Validation accuracy = 0.934579
Validation prc-auc = 0.980912
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 12
Loss = 2.1383e-01, PNorm = 68.2527, GNorm = 0.5831, lr_0 = 2.2580e-04
Validation auc = 0.953704
Validation accuracy = 0.925234
Validation prc-auc = 0.981226
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 13
Loss = 2.4267e-01, PNorm = 68.2699, GNorm = 0.6855, lr_0 = 2.2177e-04
Validation auc = 0.953241
Validation accuracy = 0.906542
Validation prc-auc = 0.980886
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 14
Loss = 1.9992e-01, PNorm = 68.2880, GNorm = 0.2280, lr_0 = 2.1742e-04
Validation auc = 0.956944
Validation accuracy = 0.934579
Validation prc-auc = 0.982849
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 15
Loss = 1.7989e-01, PNorm = 68.3065, GNorm = 0.2343, lr_0 = 2.1354e-04
Validation auc = 0.956019
Validation accuracy = 0.915888
Validation prc-auc = 0.982369
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 16
Loss = 2.0769e-01, PNorm = 68.3285, GNorm = 0.3143, lr_0 = 2.0936e-04
Validation auc = 0.954630
Validation accuracy = 0.906542
Validation prc-auc = 0.982301
Validation f1 = 0.937500
Validation mcc = 0.752315
Epoch 17
Loss = 2.1296e-01, PNorm = 68.3458, GNorm = 1.2410, lr_0 = 2.0562e-04
Validation auc = 0.955093
Validation accuracy = 0.906542
Validation prc-auc = 0.982058
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 18
Loss = 1.9804e-01, PNorm = 68.3649, GNorm = 0.6842, lr_0 = 2.0195e-04
Validation auc = 0.958333
Validation accuracy = 0.934579
Validation prc-auc = 0.983825
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 19
Loss = 2.0060e-01, PNorm = 68.3859, GNorm = 1.5766, lr_0 = 1.9800e-04
Validation auc = 0.958796
Validation accuracy = 0.915888
Validation prc-auc = 0.983856
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 20
Loss = 1.9400e-01, PNorm = 68.4026, GNorm = 0.5406, lr_0 = 1.9446e-04
Validation auc = 0.957407
Validation accuracy = 0.915888
Validation prc-auc = 0.983728
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 21
Loss = 1.8606e-01, PNorm = 68.4222, GNorm = 1.1836, lr_0 = 1.9099e-04
Validation auc = 0.956944
Validation accuracy = 0.925234
Validation prc-auc = 0.983079
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 22
Loss = 1.8871e-01, PNorm = 68.4437, GNorm = 1.0665, lr_0 = 1.8725e-04
Validation auc = 0.959722
Validation accuracy = 0.915888
Validation prc-auc = 0.984187
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 23
Loss = 1.7985e-01, PNorm = 68.4613, GNorm = 1.1450, lr_0 = 1.8391e-04
Loss = 3.3342e-01, PNorm = 68.4634, GNorm = 0.5809, lr_0 = 1.8358e-04
Validation auc = 0.958796
Validation accuracy = 0.915888
Validation prc-auc = 0.984158
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 24
Loss = 1.8428e-01, PNorm = 68.4834, GNorm = 0.4958, lr_0 = 1.8030e-04
Validation auc = 0.959722
Validation accuracy = 0.915888
Validation prc-auc = 0.983889
Validation f1 = 0.946746
Validation mcc = 0.774113
Epoch 25
Loss = 1.8680e-01, PNorm = 68.5018, GNorm = 0.3678, lr_0 = 1.7709e-04
Validation auc = 0.958333
Validation accuracy = 0.906542
Validation prc-auc = 0.983794
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 26
Validation auc = 0.957870
Validation accuracy = 0.915888
Validation prc-auc = 0.983829
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 27
Loss = 2.1693e-01, PNorm = 68.5231, GNorm = 2.0016, lr_0 = 1.7424e-04
Validation auc = 0.956944
Validation accuracy = 0.906542
Validation prc-auc = 0.983750
Validation f1 = 0.937500
Validation mcc = 0.752315
Epoch 28
Loss = 2.1327e-01, PNorm = 68.5413, GNorm = 0.7972, lr_0 = 1.7424e-04
Validation auc = 0.960185
Validation accuracy = 0.915888
Validation prc-auc = 0.984424
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 29
Loss = 1.6845e-01, PNorm = 68.5614, GNorm = 0.2805, lr_0 = 1.7424e-04
Validation auc = 0.958333
Validation accuracy = 0.915888
Validation prc-auc = 0.983806
Validation f1 = 0.944785
Validation mcc = 0.770863
Model 2 best validation auc = 0.960185 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.987725
Model 2 test accuracy = 0.958333
Model 2 test prc-auc = 0.996293
Model 2 test f1 = 0.974093
Model 2 test mcc = 0.875728
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.895370
Validation accuracy = 0.887850
Validation prc-auc = 0.948975
Validation f1 = 0.930233
Validation mcc = 0.695048
Epoch 1
Loss = 2.4800e-01, PNorm = 67.4817, GNorm = 0.4294, lr_0 = 1.1868e-03
Validation auc = 0.904167
Validation accuracy = 0.915888
Validation prc-auc = 0.955699
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 2
Loss = 2.7391e-01, PNorm = 68.0352, GNorm = 0.3079, lr_0 = 8.0296e-04
Validation auc = 0.910185
Validation accuracy = 0.915888
Validation prc-auc = 0.959226
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 3
Loss = 2.7781e-01, PNorm = 68.2004, GNorm = 0.2700, lr_0 = 3.8068e-04
Validation auc = 0.913889
Validation accuracy = 0.915888
Validation prc-auc = 0.961480
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 4
Loss = 2.7843e-01, PNorm = 68.2316, GNorm = 0.2335, lr_0 = 2.6218e-04
Validation auc = 0.918519
Validation accuracy = 0.925234
Validation prc-auc = 0.963974
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 5
Loss = 2.2897e-01, PNorm = 68.2462, GNorm = 0.2033, lr_0 = 2.5751e-04
Validation auc = 0.924537
Validation accuracy = 0.925234
Validation prc-auc = 0.967603
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 6
Loss = 2.7279e-01, PNorm = 68.2581, GNorm = 0.3553, lr_0 = 2.5246e-04
Validation auc = 0.925463
Validation accuracy = 0.925234
Validation prc-auc = 0.968101
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 7
Loss = 2.7743e-01, PNorm = 68.2674, GNorm = 0.2205, lr_0 = 2.4795e-04
Validation auc = 0.930556
Validation accuracy = 0.925234
Validation prc-auc = 0.970413
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 8
Loss = 2.5156e-01, PNorm = 68.2790, GNorm = 0.2848, lr_0 = 2.4309e-04
Validation auc = 0.934259
Validation accuracy = 0.915888
Validation prc-auc = 0.973014
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 9
Loss = 2.6037e-01, PNorm = 68.2891, GNorm = 0.5032, lr_0 = 2.3876e-04
Validation auc = 0.938426
Validation accuracy = 0.925234
Validation prc-auc = 0.975111
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 10
Loss = 2.6152e-01, PNorm = 68.3010, GNorm = 0.3024, lr_0 = 2.3450e-04
Validation auc = 0.938889
Validation accuracy = 0.925234
Validation prc-auc = 0.974527
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 11
Loss = 2.5873e-01, PNorm = 68.3139, GNorm = 0.2111, lr_0 = 2.2990e-04
Validation auc = 0.943981
Validation accuracy = 0.925234
Validation prc-auc = 0.976723
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 12
Loss = 2.0242e-01, PNorm = 68.3279, GNorm = 0.2556, lr_0 = 2.2580e-04
Validation auc = 0.944444
Validation accuracy = 0.925234
Validation prc-auc = 0.977181
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 13
Loss = 2.4220e-01, PNorm = 68.3405, GNorm = 0.2323, lr_0 = 2.2177e-04
Validation auc = 0.946759
Validation accuracy = 0.915888
Validation prc-auc = 0.978159
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 14
Loss = 2.4321e-01, PNorm = 68.3552, GNorm = 0.5406, lr_0 = 2.1742e-04
Validation auc = 0.948148
Validation accuracy = 0.925234
Validation prc-auc = 0.978273
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 15
Loss = 2.2472e-01, PNorm = 68.3704, GNorm = 0.2835, lr_0 = 2.1354e-04
Validation auc = 0.950000
Validation accuracy = 0.906542
Validation prc-auc = 0.979032
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 16
Loss = 2.2652e-01, PNorm = 68.3865, GNorm = 0.4729, lr_0 = 2.0936e-04
Validation auc = 0.951389
Validation accuracy = 0.906542
Validation prc-auc = 0.980300
Validation f1 = 0.938272
Validation mcc = 0.747048
Epoch 17
Loss = 2.4000e-01, PNorm = 68.3994, GNorm = 0.7586, lr_0 = 2.0562e-04
Validation auc = 0.949537
Validation accuracy = 0.906542
Validation prc-auc = 0.978590
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 18
Loss = 2.1374e-01, PNorm = 68.4136, GNorm = 0.2498, lr_0 = 2.0195e-04
Validation auc = 0.950926
Validation accuracy = 0.915888
Validation prc-auc = 0.979371
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 19
Loss = 2.3211e-01, PNorm = 68.4307, GNorm = 0.4320, lr_0 = 1.9800e-04
Validation auc = 0.953241
Validation accuracy = 0.925234
Validation prc-auc = 0.980488
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 20
Loss = 2.1912e-01, PNorm = 68.4474, GNorm = 0.8982, lr_0 = 1.9446e-04
Validation auc = 0.952778
Validation accuracy = 0.915888
Validation prc-auc = 0.980348
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 21
Loss = 2.2071e-01, PNorm = 68.4636, GNorm = 0.4466, lr_0 = 1.9099e-04
Validation auc = 0.955556
Validation accuracy = 0.915888
Validation prc-auc = 0.982344
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 22
Loss = 2.0366e-01, PNorm = 68.4823, GNorm = 0.2468, lr_0 = 1.8725e-04
Validation auc = 0.952315
Validation accuracy = 0.915888
Validation prc-auc = 0.980429
Validation f1 = 0.946108
Validation mcc = 0.770120
Epoch 23
Loss = 1.9978e-01, PNorm = 68.4984, GNorm = 0.2645, lr_0 = 1.8391e-04
Loss = 3.0690e-01, PNorm = 68.4998, GNorm = 1.1876, lr_0 = 1.8358e-04
Validation auc = 0.955556
Validation accuracy = 0.915888
Validation prc-auc = 0.982775
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 24
Loss = 2.1484e-01, PNorm = 68.5139, GNorm = 0.4436, lr_0 = 1.8030e-04
Validation auc = 0.954630
Validation accuracy = 0.915888
Validation prc-auc = 0.981474
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 25
Loss = 2.0893e-01, PNorm = 68.5311, GNorm = 1.4628, lr_0 = 1.7709e-04
Validation auc = 0.954630
Validation accuracy = 0.915888
Validation prc-auc = 0.981696
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 26
Validation auc = 0.954630
Validation accuracy = 0.925234
Validation prc-auc = 0.981696
Validation f1 = 0.951220
Validation mcc = 0.795958
Epoch 27
Loss = 1.9171e-01, PNorm = 68.5501, GNorm = 0.6609, lr_0 = 1.7424e-04
Validation auc = 0.953241
Validation accuracy = 0.906542
Validation prc-auc = 0.981016
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 28
Loss = 1.8071e-01, PNorm = 68.5681, GNorm = 0.3907, lr_0 = 1.7424e-04
Validation auc = 0.956944
Validation accuracy = 0.915888
Validation prc-auc = 0.983062
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 29
Loss = 1.4790e-01, PNorm = 68.5848, GNorm = 0.6635, lr_0 = 1.7424e-04
Validation auc = 0.954630
Validation accuracy = 0.925234
Validation prc-auc = 0.981514
Validation f1 = 0.951220
Validation mcc = 0.795958
Model 3 best validation auc = 0.956944 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.990589
Model 3 test accuracy = 0.975000
Model 3 test prc-auc = 0.997291
Model 3 test f1 = 0.984293
Model 3 test mcc = 0.925881
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.896296
Validation accuracy = 0.887850
Validation prc-auc = 0.948234
Validation f1 = 0.930233
Validation mcc = 0.695048
Epoch 1
Loss = 2.6297e-01, PNorm = 67.4218, GNorm = 0.2199, lr_0 = 1.1868e-03
Validation auc = 0.911574
Validation accuracy = 0.915888
Validation prc-auc = 0.960297
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 2
Loss = 2.8875e-01, PNorm = 67.9840, GNorm = 0.2303, lr_0 = 8.0296e-04
Validation auc = 0.922222
Validation accuracy = 0.925234
Validation prc-auc = 0.966222
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 3
Loss = 2.5079e-01, PNorm = 68.1553, GNorm = 0.2220, lr_0 = 3.8068e-04
Validation auc = 0.927315
Validation accuracy = 0.925234
Validation prc-auc = 0.968588
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 4
Loss = 2.6834e-01, PNorm = 68.1881, GNorm = 0.2222, lr_0 = 2.6218e-04
Validation auc = 0.931019
Validation accuracy = 0.925234
Validation prc-auc = 0.970704
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 5
Loss = 2.1997e-01, PNorm = 68.2059, GNorm = 0.2449, lr_0 = 2.5751e-04
Validation auc = 0.934722
Validation accuracy = 0.925234
Validation prc-auc = 0.972805
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 6
Loss = 2.1190e-01, PNorm = 68.2215, GNorm = 0.2460, lr_0 = 2.5246e-04
Validation auc = 0.941204
Validation accuracy = 0.925234
Validation prc-auc = 0.975959
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 7
Loss = 2.9939e-01, PNorm = 68.2345, GNorm = 0.8318, lr_0 = 2.4795e-04
Validation auc = 0.946296
Validation accuracy = 0.925234
Validation prc-auc = 0.978293
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 8
Loss = 2.1147e-01, PNorm = 68.2481, GNorm = 0.3118, lr_0 = 2.4309e-04
Validation auc = 0.950463
Validation accuracy = 0.925234
Validation prc-auc = 0.980052
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 9
Loss = 2.5916e-01, PNorm = 68.2608, GNorm = 0.3274, lr_0 = 2.3876e-04
Validation auc = 0.949074
Validation accuracy = 0.925234
Validation prc-auc = 0.978678
Validation f1 = 0.951807
Validation mcc = 0.796421
Epoch 10
Loss = 2.2178e-01, PNorm = 68.2755, GNorm = 0.4558, lr_0 = 2.3450e-04
Validation auc = 0.951852
Validation accuracy = 0.934579
Validation prc-auc = 0.980359
Validation f1 = 0.957576
Validation mcc = 0.822480
Epoch 11
Loss = 2.3623e-01, PNorm = 68.2920, GNorm = 0.4933, lr_0 = 2.2990e-04
Validation auc = 0.954630
Validation accuracy = 0.925234
Validation prc-auc = 0.982212
Validation f1 = 0.951220
Validation mcc = 0.795958
Epoch 12
Loss = 2.0618e-01, PNorm = 68.3082, GNorm = 0.3471, lr_0 = 2.2580e-04
Validation auc = 0.958333
Validation accuracy = 0.915888
Validation prc-auc = 0.983888
Validation f1 = 0.944099
Validation mcc = 0.774558
Epoch 13
Loss = 2.6819e-01, PNorm = 68.3235, GNorm = 0.4239, lr_0 = 2.2177e-04
Validation auc = 0.954167
Validation accuracy = 0.906542
Validation prc-auc = 0.981784
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 14
Loss = 2.1550e-01, PNorm = 68.3413, GNorm = 0.2368, lr_0 = 2.1742e-04
Validation auc = 0.952315
Validation accuracy = 0.915888
Validation prc-auc = 0.980575
Validation f1 = 0.946746
Validation mcc = 0.774113
Epoch 15
Loss = 2.2130e-01, PNorm = 68.3553, GNorm = 1.3833, lr_0 = 2.1354e-04
Validation auc = 0.954630
Validation accuracy = 0.906542
Validation prc-auc = 0.981792
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 16
Loss = 2.0258e-01, PNorm = 68.3721, GNorm = 1.3597, lr_0 = 2.0936e-04
Validation auc = 0.957407
Validation accuracy = 0.906542
Validation prc-auc = 0.983412
Validation f1 = 0.937500
Validation mcc = 0.752315
Epoch 17
Loss = 2.0436e-01, PNorm = 68.3879, GNorm = 0.7938, lr_0 = 2.0562e-04
Validation auc = 0.955093
Validation accuracy = 0.925234
Validation prc-auc = 0.981809
Validation f1 = 0.951220
Validation mcc = 0.795958
Epoch 18
Loss = 1.8543e-01, PNorm = 68.4044, GNorm = 0.4291, lr_0 = 2.0195e-04
Validation auc = 0.956944
Validation accuracy = 0.925234
Validation prc-auc = 0.983147
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 19
Loss = 1.9868e-01, PNorm = 68.4233, GNorm = 1.2140, lr_0 = 1.9800e-04
Validation auc = 0.956019
Validation accuracy = 0.925234
Validation prc-auc = 0.983172
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 20
Loss = 1.9608e-01, PNorm = 68.4404, GNorm = 0.3602, lr_0 = 1.9446e-04
Validation auc = 0.956481
Validation accuracy = 0.906542
Validation prc-auc = 0.982821
Validation f1 = 0.940476
Validation mcc = 0.743528
Epoch 21
Loss = 2.0249e-01, PNorm = 68.4580, GNorm = 1.0847, lr_0 = 1.9099e-04
Validation auc = 0.956481
Validation accuracy = 0.925234
Validation prc-auc = 0.983248
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 22
Loss = 1.9156e-01, PNorm = 68.4793, GNorm = 0.8529, lr_0 = 1.8725e-04
Validation auc = 0.957870
Validation accuracy = 0.925234
Validation prc-auc = 0.984240
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 23
Loss = 2.0090e-01, PNorm = 68.4950, GNorm = 1.0266, lr_0 = 1.8391e-04
Loss = 1.8425e-01, PNorm = 68.4966, GNorm = 0.8846, lr_0 = 1.8358e-04
Validation auc = 0.956019
Validation accuracy = 0.906542
Validation prc-auc = 0.982370
Validation f1 = 0.939759
Validation mcc = 0.742247
Epoch 24
Loss = 1.9161e-01, PNorm = 68.5131, GNorm = 0.3705, lr_0 = 1.8030e-04
Validation auc = 0.956944
Validation accuracy = 0.915888
Validation prc-auc = 0.982707
Validation f1 = 0.945455
Validation mcc = 0.769240
Epoch 25
Loss = 1.9323e-01, PNorm = 68.5287, GNorm = 1.2525, lr_0 = 1.7709e-04
Validation auc = 0.958333
Validation accuracy = 0.925234
Validation prc-auc = 0.984066
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 26
Validation auc = 0.957870
Validation accuracy = 0.925234
Validation prc-auc = 0.983710
Validation f1 = 0.950617
Validation mcc = 0.797897
Epoch 27
Loss = 7.6507e-02, PNorm = 68.5474, GNorm = 1.1231, lr_0 = 1.7424e-04
Validation auc = 0.955093
Validation accuracy = 0.906542
Validation prc-auc = 0.981843
Validation f1 = 0.939024
Validation mcc = 0.743579
Epoch 28
Loss = 1.1307e-01, PNorm = 68.5652, GNorm = 0.3112, lr_0 = 1.7424e-04
Validation auc = 0.956944
Validation accuracy = 0.915888
Validation prc-auc = 0.982710
Validation f1 = 0.944785
Validation mcc = 0.770863
Epoch 29
Loss = 2.2238e-01, PNorm = 68.5846, GNorm = 1.2739, lr_0 = 1.7424e-04
Validation auc = 0.956481
Validation accuracy = 0.906542
Validation prc-auc = 0.982727
Validation f1 = 0.939024
Validation mcc = 0.743579
Model 4 best validation auc = 0.958333 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.989771
Model 4 test accuracy = 0.975000
Model 4 test prc-auc = 0.997002
Model 4 test f1 = 0.984293
Model 4 test mcc = 0.925881
Ensemble test auc = 0.990998
Ensemble test accuracy = 0.975000
Ensemble test prc-auc = 0.997411
Ensemble test f1 = 0.984293
Ensemble test mcc = 0.925881
Fold 7
Splitting data with seed 7
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.867663
Validation accuracy = 0.878505
Validation prc-auc = 0.949927
Validation f1 = 0.929730
Validation mcc = 0.575264
Epoch 1
Loss = 2.3788e-01, PNorm = 67.4431, GNorm = 0.2486, lr_0 = 1.1868e-03
Validation auc = 0.877076
Validation accuracy = 0.906542
Validation prc-auc = 0.955469
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 2
Loss = 2.9302e-01, PNorm = 67.9933, GNorm = 0.2551, lr_0 = 8.0296e-04
Validation auc = 0.880952
Validation accuracy = 0.915888
Validation prc-auc = 0.955414
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 3
Loss = 2.2623e-01, PNorm = 68.1598, GNorm = 0.1890, lr_0 = 3.8068e-04
Validation auc = 0.881506
Validation accuracy = 0.915888
Validation prc-auc = 0.954678
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 4
Loss = 2.0568e-01, PNorm = 68.1915, GNorm = 0.2124, lr_0 = 2.6218e-04
Validation auc = 0.884275
Validation accuracy = 0.915888
Validation prc-auc = 0.955702
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 5
Loss = 2.4944e-01, PNorm = 68.2066, GNorm = 0.2110, lr_0 = 2.5751e-04
Validation auc = 0.885936
Validation accuracy = 0.915888
Validation prc-auc = 0.955294
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 6
Loss = 2.9408e-01, PNorm = 68.2183, GNorm = 0.3062, lr_0 = 2.5246e-04
Validation auc = 0.889812
Validation accuracy = 0.915888
Validation prc-auc = 0.957659
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 7
Loss = 3.1220e-01, PNorm = 68.2274, GNorm = 0.2911, lr_0 = 2.4795e-04
Validation auc = 0.891473
Validation accuracy = 0.925234
Validation prc-auc = 0.957399
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 8
Loss = 2.1208e-01, PNorm = 68.2374, GNorm = 0.2284, lr_0 = 2.4309e-04
Validation auc = 0.894795
Validation accuracy = 0.915888
Validation prc-auc = 0.958202
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 9
Loss = 2.5692e-01, PNorm = 68.2470, GNorm = 0.1993, lr_0 = 2.3876e-04
Validation auc = 0.898117
Validation accuracy = 0.915888
Validation prc-auc = 0.959309
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 10
Loss = 2.2630e-01, PNorm = 68.2563, GNorm = 0.5558, lr_0 = 2.3450e-04
Validation auc = 0.898117
Validation accuracy = 0.915888
Validation prc-auc = 0.958767
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 11
Loss = 2.3370e-01, PNorm = 68.2685, GNorm = 0.2415, lr_0 = 2.2990e-04
Validation auc = 0.902547
Validation accuracy = 0.925234
Validation prc-auc = 0.961229
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 12
Loss = 2.1506e-01, PNorm = 68.2809, GNorm = 0.2313, lr_0 = 2.2580e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.960174
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 13
Loss = 2.2115e-01, PNorm = 68.2939, GNorm = 0.2052, lr_0 = 2.2177e-04
Validation auc = 0.900886
Validation accuracy = 0.915888
Validation prc-auc = 0.960093
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 14
Loss = 2.3621e-01, PNorm = 68.3081, GNorm = 0.5974, lr_0 = 2.1742e-04
Validation auc = 0.901993
Validation accuracy = 0.925234
Validation prc-auc = 0.960329
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 15
Loss = 2.0519e-01, PNorm = 68.3225, GNorm = 0.5147, lr_0 = 2.1354e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.959452
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 16
Loss = 2.4145e-01, PNorm = 68.3385, GNorm = 0.2429, lr_0 = 2.0936e-04
Validation auc = 0.903654
Validation accuracy = 0.925234
Validation prc-auc = 0.960885
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 17
Loss = 2.1280e-01, PNorm = 68.3541, GNorm = 0.2080, lr_0 = 2.0562e-04
Validation auc = 0.904762
Validation accuracy = 0.925234
Validation prc-auc = 0.961597
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 18
Loss = 2.1112e-01, PNorm = 68.3699, GNorm = 0.3538, lr_0 = 2.0195e-04
Validation auc = 0.905869
Validation accuracy = 0.925234
Validation prc-auc = 0.961841
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 19
Loss = 2.0760e-01, PNorm = 68.3862, GNorm = 0.2119, lr_0 = 1.9800e-04
Validation auc = 0.909192
Validation accuracy = 0.943925
Validation prc-auc = 0.963353
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 20
Loss = 2.1011e-01, PNorm = 68.4030, GNorm = 0.3485, lr_0 = 1.9446e-04
Validation auc = 0.909192
Validation accuracy = 0.925234
Validation prc-auc = 0.963353
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 21
Loss = 1.9793e-01, PNorm = 68.4201, GNorm = 0.5545, lr_0 = 1.9099e-04
Validation auc = 0.911406
Validation accuracy = 0.943925
Validation prc-auc = 0.964179
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 22
Loss = 2.1230e-01, PNorm = 68.4393, GNorm = 0.3231, lr_0 = 1.8725e-04
Validation auc = 0.909745
Validation accuracy = 0.934579
Validation prc-auc = 0.963981
Validation f1 = 0.960000
Validation mcc = 0.784270
Epoch 23
Loss = 2.0615e-01, PNorm = 68.4574, GNorm = 0.2188, lr_0 = 1.8391e-04
Loss = 1.6969e-01, PNorm = 68.4593, GNorm = 0.2310, lr_0 = 1.8358e-04
Validation auc = 0.913068
Validation accuracy = 0.943925
Validation prc-auc = 0.964834
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 24
Loss = 2.0184e-01, PNorm = 68.4773, GNorm = 0.3899, lr_0 = 1.8030e-04
Validation auc = 0.910853
Validation accuracy = 0.934579
Validation prc-auc = 0.964856
Validation f1 = 0.960452
Validation mcc = 0.782568
Epoch 25
Loss = 2.1020e-01, PNorm = 68.4931, GNorm = 0.3859, lr_0 = 1.7709e-04
Validation auc = 0.911406
Validation accuracy = 0.953271
Validation prc-auc = 0.965640
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 26
Validation auc = 0.912514
Validation accuracy = 0.953271
Validation prc-auc = 0.966218
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 27
Loss = 2.4830e-01, PNorm = 68.5106, GNorm = 0.4142, lr_0 = 1.7424e-04
Validation auc = 0.914729
Validation accuracy = 0.943925
Validation prc-auc = 0.967094
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 28
Loss = 2.0536e-01, PNorm = 68.5279, GNorm = 0.3213, lr_0 = 1.7424e-04
Validation auc = 0.916944
Validation accuracy = 0.953271
Validation prc-auc = 0.967206
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 29
Loss = 1.9264e-01, PNorm = 68.5480, GNorm = 0.2515, lr_0 = 1.7424e-04
Validation auc = 0.914729
Validation accuracy = 0.953271
Validation prc-auc = 0.966832
Validation f1 = 0.971429
Validation mcc = 0.847176
Model 0 best validation auc = 0.916944 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.988953
Model 0 test accuracy = 0.966667
Model 0 test prc-auc = 0.996773
Model 0 test f1 = 0.979167
Model 0 test mcc = 0.900898
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.871539
Validation accuracy = 0.897196
Validation prc-auc = 0.949649
Validation f1 = 0.939227
Validation mcc = 0.644660
Epoch 1
Loss = 3.0577e-01, PNorm = 67.4458, GNorm = 0.2917, lr_0 = 1.1868e-03
Validation auc = 0.873200
Validation accuracy = 0.906542
Validation prc-auc = 0.946824
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 2
Loss = 2.3595e-01, PNorm = 67.9997, GNorm = 0.3372, lr_0 = 8.0296e-04
Validation auc = 0.876523
Validation accuracy = 0.915888
Validation prc-auc = 0.946558
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 3
Loss = 3.3774e-01, PNorm = 68.1711, GNorm = 0.4349, lr_0 = 3.8068e-04
Validation auc = 0.879291
Validation accuracy = 0.906542
Validation prc-auc = 0.947292
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 4
Loss = 2.6885e-01, PNorm = 68.2051, GNorm = 0.2492, lr_0 = 2.6218e-04
Validation auc = 0.881506
Validation accuracy = 0.906542
Validation prc-auc = 0.949567
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 5
Loss = 2.2451e-01, PNorm = 68.2229, GNorm = 0.2422, lr_0 = 2.5751e-04
Validation auc = 0.888151
Validation accuracy = 0.925234
Validation prc-auc = 0.951627
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 6
Loss = 2.9527e-01, PNorm = 68.2373, GNorm = 0.2269, lr_0 = 2.5246e-04
Validation auc = 0.891473
Validation accuracy = 0.925234
Validation prc-auc = 0.952496
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 7
Loss = 2.6853e-01, PNorm = 68.2510, GNorm = 0.5483, lr_0 = 2.4795e-04
Validation auc = 0.893688
Validation accuracy = 0.925234
Validation prc-auc = 0.952008
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 8
Loss = 1.9831e-01, PNorm = 68.2666, GNorm = 0.6425, lr_0 = 2.4309e-04
Validation auc = 0.894241
Validation accuracy = 0.915888
Validation prc-auc = 0.953128
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 9
Loss = 2.5568e-01, PNorm = 68.2800, GNorm = 0.2578, lr_0 = 2.3876e-04
Validation auc = 0.897010
Validation accuracy = 0.915888
Validation prc-auc = 0.953762
Validation f1 = 0.949153
Validation mcc = 0.716583
Epoch 10
Loss = 2.7793e-01, PNorm = 68.2932, GNorm = 0.5782, lr_0 = 2.3450e-04
Validation auc = 0.899225
Validation accuracy = 0.915888
Validation prc-auc = 0.953792
Validation f1 = 0.949153
Validation mcc = 0.716583
Epoch 11
Loss = 2.3375e-01, PNorm = 68.3083, GNorm = 0.8553, lr_0 = 2.2990e-04
Validation auc = 0.899779
Validation accuracy = 0.934579
Validation prc-auc = 0.955242
Validation f1 = 0.959538
Validation mcc = 0.789195
Epoch 12
Loss = 1.9826e-01, PNorm = 68.3223, GNorm = 0.2693, lr_0 = 2.2580e-04
Validation auc = 0.899225
Validation accuracy = 0.925234
Validation prc-auc = 0.954904
Validation f1 = 0.953488
Validation mcc = 0.763012
Epoch 13
Loss = 2.5413e-01, PNorm = 68.3358, GNorm = 0.4012, lr_0 = 2.2177e-04
Validation auc = 0.900332
Validation accuracy = 0.925234
Validation prc-auc = 0.955528
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 14
Loss = 2.3186e-01, PNorm = 68.3532, GNorm = 0.9966, lr_0 = 2.1742e-04
Validation auc = 0.900886
Validation accuracy = 0.934579
Validation prc-auc = 0.955643
Validation f1 = 0.960000
Validation mcc = 0.784270
Epoch 15
Loss = 2.0137e-01, PNorm = 68.3684, GNorm = 0.2461, lr_0 = 2.1354e-04
Validation auc = 0.901440
Validation accuracy = 0.943925
Validation prc-auc = 0.956737
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 16
Loss = 2.0549e-01, PNorm = 68.3859, GNorm = 0.3750, lr_0 = 2.0936e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.955767
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 17
Loss = 2.0453e-01, PNorm = 68.4019, GNorm = 0.3758, lr_0 = 2.0562e-04
Validation auc = 0.901993
Validation accuracy = 0.925234
Validation prc-auc = 0.958032
Validation f1 = 0.952941
Validation mcc = 0.772510
Epoch 18
Loss = 1.9970e-01, PNorm = 68.4183, GNorm = 0.2224, lr_0 = 2.0195e-04
Validation auc = 0.902547
Validation accuracy = 0.934579
Validation prc-auc = 0.957750
Validation f1 = 0.960452
Validation mcc = 0.782568
Epoch 19
Loss = 2.0228e-01, PNorm = 68.4340, GNorm = 0.3011, lr_0 = 1.9800e-04
Validation auc = 0.903101
Validation accuracy = 0.934579
Validation prc-auc = 0.958575
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 20
Loss = 2.0224e-01, PNorm = 68.4518, GNorm = 0.4226, lr_0 = 1.9446e-04
Validation auc = 0.903654
Validation accuracy = 0.934579
Validation prc-auc = 0.958343
Validation f1 = 0.960000
Validation mcc = 0.784270
Epoch 21
Loss = 2.1109e-01, PNorm = 68.4714, GNorm = 0.3559, lr_0 = 1.9099e-04
Validation auc = 0.905869
Validation accuracy = 0.943925
Validation prc-auc = 0.958572
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 22
Loss = 2.0421e-01, PNorm = 68.4927, GNorm = 0.7268, lr_0 = 1.8725e-04
Validation auc = 0.910299
Validation accuracy = 0.943925
Validation prc-auc = 0.959840
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 23
Loss = 1.9109e-01, PNorm = 68.5102, GNorm = 0.2600, lr_0 = 1.8391e-04
Loss = 2.3084e-01, PNorm = 68.5116, GNorm = 0.3188, lr_0 = 1.8358e-04
Validation auc = 0.909745
Validation accuracy = 0.943925
Validation prc-auc = 0.959676
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 24
Loss = 1.8925e-01, PNorm = 68.5268, GNorm = 0.4087, lr_0 = 1.8030e-04
Validation auc = 0.911960
Validation accuracy = 0.943925
Validation prc-auc = 0.961338
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 25
Loss = 1.9152e-01, PNorm = 68.5454, GNorm = 0.4405, lr_0 = 1.7709e-04
Validation auc = 0.910853
Validation accuracy = 0.962617
Validation prc-auc = 0.960508
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 26
Validation auc = 0.911406
Validation accuracy = 0.962617
Validation prc-auc = 0.961173
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 27
Loss = 2.2441e-01, PNorm = 68.5641, GNorm = 0.6241, lr_0 = 1.7424e-04
Validation auc = 0.913621
Validation accuracy = 0.943925
Validation prc-auc = 0.962225
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 28
Loss = 1.0405e-01, PNorm = 68.5820, GNorm = 0.4133, lr_0 = 1.7424e-04
Validation auc = 0.913621
Validation accuracy = 0.943925
Validation prc-auc = 0.962098
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 29
Loss = 1.7215e-01, PNorm = 68.6023, GNorm = 0.9683, lr_0 = 1.7424e-04
Validation auc = 0.916390
Validation accuracy = 0.943925
Validation prc-auc = 0.965601
Validation f1 = 0.965116
Validation mcc = 0.822259
Model 1 best validation auc = 0.916390 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.990998
Model 1 test accuracy = 0.966667
Model 1 test prc-auc = 0.997426
Model 1 test f1 = 0.978947
Model 1 test mcc = 0.900139
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.866002
Validation accuracy = 0.897196
Validation prc-auc = 0.947705
Validation f1 = 0.939891
Validation mcc = 0.649761
Epoch 1
Loss = 2.9547e-01, PNorm = 67.4018, GNorm = 0.3945, lr_0 = 1.1868e-03
Validation auc = 0.873754
Validation accuracy = 0.915888
Validation prc-auc = 0.950399
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 2
Loss = 3.5025e-01, PNorm = 67.9601, GNorm = 0.4170, lr_0 = 8.0296e-04
Validation auc = 0.880399
Validation accuracy = 0.915888
Validation prc-auc = 0.951856
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 3
Loss = 3.1863e-01, PNorm = 68.1330, GNorm = 0.2053, lr_0 = 3.8068e-04
Validation auc = 0.886489
Validation accuracy = 0.915888
Validation prc-auc = 0.954693
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 4
Loss = 3.4482e-01, PNorm = 68.1676, GNorm = 0.2782, lr_0 = 2.6218e-04
Validation auc = 0.890919
Validation accuracy = 0.915888
Validation prc-auc = 0.955943
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 5
Loss = 2.1640e-01, PNorm = 68.1860, GNorm = 0.3567, lr_0 = 2.5751e-04
Validation auc = 0.890919
Validation accuracy = 0.915888
Validation prc-auc = 0.955151
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 6
Loss = 2.5362e-01, PNorm = 68.2022, GNorm = 0.1934, lr_0 = 2.5246e-04
Validation auc = 0.897010
Validation accuracy = 0.915888
Validation prc-auc = 0.957561
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 7
Loss = 2.7139e-01, PNorm = 68.2163, GNorm = 0.2138, lr_0 = 2.4795e-04
Validation auc = 0.890365
Validation accuracy = 0.925234
Validation prc-auc = 0.954305
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 8
Loss = 2.6097e-01, PNorm = 68.2317, GNorm = 0.2638, lr_0 = 2.4309e-04
Validation auc = 0.897010
Validation accuracy = 0.915888
Validation prc-auc = 0.957392
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 9
Loss = 1.9440e-01, PNorm = 68.2476, GNorm = 0.2537, lr_0 = 2.3876e-04
Validation auc = 0.898117
Validation accuracy = 0.915888
Validation prc-auc = 0.957451
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 10
Loss = 2.6393e-01, PNorm = 68.2638, GNorm = 0.2660, lr_0 = 2.3450e-04
Validation auc = 0.900886
Validation accuracy = 0.934579
Validation prc-auc = 0.959295
Validation f1 = 0.959538
Validation mcc = 0.789195
Epoch 11
Loss = 2.2805e-01, PNorm = 68.2839, GNorm = 0.2812, lr_0 = 2.2990e-04
Validation auc = 0.900332
Validation accuracy = 0.925234
Validation prc-auc = 0.958532
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 12
Loss = 2.0566e-01, PNorm = 68.3012, GNorm = 0.4636, lr_0 = 2.2580e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.959425
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 13
Loss = 2.3262e-01, PNorm = 68.3171, GNorm = 0.4522, lr_0 = 2.2177e-04
Validation auc = 0.900886
Validation accuracy = 0.925234
Validation prc-auc = 0.959083
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 14
Loss = 1.9872e-01, PNorm = 68.3354, GNorm = 0.2539, lr_0 = 2.1742e-04
Validation auc = 0.904762
Validation accuracy = 0.934579
Validation prc-auc = 0.961932
Validation f1 = 0.960000
Validation mcc = 0.784270
Epoch 15
Loss = 2.1996e-01, PNorm = 68.3524, GNorm = 0.2896, lr_0 = 2.1354e-04
Validation auc = 0.905316
Validation accuracy = 0.934579
Validation prc-auc = 0.962066
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 16
Loss = 1.9713e-01, PNorm = 68.3754, GNorm = 0.3414, lr_0 = 2.0936e-04
Validation auc = 0.905316
Validation accuracy = 0.953271
Validation prc-auc = 0.962066
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 17
Loss = 2.0227e-01, PNorm = 68.3955, GNorm = 0.5899, lr_0 = 2.0562e-04
Validation auc = 0.906423
Validation accuracy = 0.934579
Validation prc-auc = 0.962276
Validation f1 = 0.960000
Validation mcc = 0.784270
Epoch 18
Loss = 2.1110e-01, PNorm = 68.4133, GNorm = 0.2862, lr_0 = 2.0195e-04
Validation auc = 0.906977
Validation accuracy = 0.943925
Validation prc-auc = 0.963300
Validation f1 = 0.965909
Validation mcc = 0.815145
Epoch 19
Loss = 1.9607e-01, PNorm = 68.4378, GNorm = 1.6171, lr_0 = 1.9800e-04
Validation auc = 0.910853
Validation accuracy = 0.953271
Validation prc-auc = 0.963812
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 20
Loss = 1.8158e-01, PNorm = 68.4561, GNorm = 0.6103, lr_0 = 1.9446e-04
Validation auc = 0.907530
Validation accuracy = 0.934579
Validation prc-auc = 0.963146
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 21
Loss = 1.8676e-01, PNorm = 68.4757, GNorm = 0.5948, lr_0 = 1.9099e-04
Validation auc = 0.910299
Validation accuracy = 0.934579
Validation prc-auc = 0.965594
Validation f1 = 0.960452
Validation mcc = 0.782568
Epoch 22
Loss = 1.9307e-01, PNorm = 68.4966, GNorm = 0.7578, lr_0 = 1.8725e-04
Validation auc = 0.908084
Validation accuracy = 0.934579
Validation prc-auc = 0.962897
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 23
Loss = 1.9862e-01, PNorm = 68.5186, GNorm = 0.8577, lr_0 = 1.8391e-04
Loss = 2.4035e-01, PNorm = 68.5206, GNorm = 0.8152, lr_0 = 1.8358e-04
Validation auc = 0.912514
Validation accuracy = 0.943925
Validation prc-auc = 0.964927
Validation f1 = 0.966292
Validation mcc = 0.817130
Epoch 24
Loss = 1.9427e-01, PNorm = 68.5410, GNorm = 0.6804, lr_0 = 1.8030e-04
Validation auc = 0.914175
Validation accuracy = 0.943925
Validation prc-auc = 0.965373
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 25
Loss = 1.7697e-01, PNorm = 68.5620, GNorm = 0.9232, lr_0 = 1.7709e-04
Validation auc = 0.913621
Validation accuracy = 0.953271
Validation prc-auc = 0.965198
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 26
Validation auc = 0.915836
Validation accuracy = 0.953271
Validation prc-auc = 0.966244
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 27
Loss = 2.2242e-01, PNorm = 68.5851, GNorm = 1.1552, lr_0 = 1.7424e-04
Validation auc = 0.918605
Validation accuracy = 0.943925
Validation prc-auc = 0.966864
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 28
Loss = 9.7261e-02, PNorm = 68.6068, GNorm = 1.0583, lr_0 = 1.7424e-04
Validation auc = 0.914175
Validation accuracy = 0.943925
Validation prc-auc = 0.964022
Validation f1 = 0.966292
Validation mcc = 0.817130
Epoch 29
Loss = 1.7710e-01, PNorm = 68.6319, GNorm = 0.4242, lr_0 = 1.7424e-04
Validation auc = 0.918051
Validation accuracy = 0.934579
Validation prc-auc = 0.968557
Validation f1 = 0.959064
Validation mcc = 0.796639
Model 2 best validation auc = 0.918605 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.990180
Model 2 test accuracy = 0.966667
Model 2 test prc-auc = 0.997197
Model 2 test f1 = 0.979167
Model 2 test mcc = 0.900898
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.858804
Validation accuracy = 0.915888
Validation prc-auc = 0.942049
Validation f1 = 0.949153
Validation mcc = 0.716583
Epoch 1
Loss = 2.6973e-01, PNorm = 67.4668, GNorm = 0.4159, lr_0 = 1.1868e-03
Validation auc = 0.868771
Validation accuracy = 0.906542
Validation prc-auc = 0.943125
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 2
Loss = 3.2166e-01, PNorm = 68.0163, GNorm = 0.2404, lr_0 = 8.0296e-04
Validation auc = 0.874308
Validation accuracy = 0.915888
Validation prc-auc = 0.947192
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 3
Loss = 2.7733e-01, PNorm = 68.1842, GNorm = 0.3167, lr_0 = 3.8068e-04
Validation auc = 0.879291
Validation accuracy = 0.906542
Validation prc-auc = 0.949530
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 4
Loss = 3.1469e-01, PNorm = 68.2156, GNorm = 0.2405, lr_0 = 2.6218e-04
Validation auc = 0.883721
Validation accuracy = 0.906542
Validation prc-auc = 0.952306
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 5
Loss = 2.9580e-01, PNorm = 68.2313, GNorm = 0.2766, lr_0 = 2.5751e-04
Validation auc = 0.886489
Validation accuracy = 0.906542
Validation prc-auc = 0.953212
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 6
Loss = 2.6195e-01, PNorm = 68.2437, GNorm = 0.2508, lr_0 = 2.5246e-04
Validation auc = 0.892580
Validation accuracy = 0.906542
Validation prc-auc = 0.953744
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 7
Loss = 2.8451e-01, PNorm = 68.2546, GNorm = 0.3777, lr_0 = 2.4795e-04
Validation auc = 0.894241
Validation accuracy = 0.906542
Validation prc-auc = 0.952488
Validation f1 = 0.943182
Validation mcc = 0.686406
Epoch 8
Loss = 2.3406e-01, PNorm = 68.2658, GNorm = 0.2154, lr_0 = 2.4309e-04
Validation auc = 0.898671
Validation accuracy = 0.915888
Validation prc-auc = 0.955326
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 9
Loss = 2.5142e-01, PNorm = 68.2767, GNorm = 0.4943, lr_0 = 2.3876e-04
Validation auc = 0.895903
Validation accuracy = 0.925234
Validation prc-auc = 0.952217
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 10
Loss = 2.0946e-01, PNorm = 68.2880, GNorm = 0.2146, lr_0 = 2.3450e-04
Validation auc = 0.899779
Validation accuracy = 0.915888
Validation prc-auc = 0.955228
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 11
Loss = 2.1962e-01, PNorm = 68.3017, GNorm = 0.3488, lr_0 = 2.2990e-04
Validation auc = 0.899779
Validation accuracy = 0.925234
Validation prc-auc = 0.954819
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 12
Loss = 2.4398e-01, PNorm = 68.3163, GNorm = 0.7521, lr_0 = 2.2580e-04
Validation auc = 0.899779
Validation accuracy = 0.915888
Validation prc-auc = 0.953998
Validation f1 = 0.949153
Validation mcc = 0.716583
Epoch 13
Loss = 2.5355e-01, PNorm = 68.3298, GNorm = 0.2513, lr_0 = 2.2177e-04
Validation auc = 0.898117
Validation accuracy = 0.925234
Validation prc-auc = 0.953190
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 14
Loss = 2.1403e-01, PNorm = 68.3438, GNorm = 0.5081, lr_0 = 2.1742e-04
Validation auc = 0.900886
Validation accuracy = 0.934579
Validation prc-auc = 0.955484
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 15
Loss = 2.5950e-01, PNorm = 68.3567, GNorm = 1.1113, lr_0 = 2.1354e-04
Validation auc = 0.898671
Validation accuracy = 0.915888
Validation prc-auc = 0.955810
Validation f1 = 0.949153
Validation mcc = 0.716583
Epoch 16
Loss = 2.3518e-01, PNorm = 68.3690, GNorm = 0.2978, lr_0 = 2.0936e-04
Validation auc = 0.898671
Validation accuracy = 0.925234
Validation prc-auc = 0.956539
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 17
Loss = 2.1886e-01, PNorm = 68.3823, GNorm = 0.6395, lr_0 = 2.0562e-04
Validation auc = 0.900332
Validation accuracy = 0.925234
Validation prc-auc = 0.958217
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 18
Loss = 2.2185e-01, PNorm = 68.3957, GNorm = 0.4024, lr_0 = 2.0195e-04
Validation auc = 0.900332
Validation accuracy = 0.925234
Validation prc-auc = 0.958130
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 19
Loss = 2.0467e-01, PNorm = 68.4126, GNorm = 0.2800, lr_0 = 1.9800e-04
Validation auc = 0.901993
Validation accuracy = 0.943925
Validation prc-auc = 0.958527
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 20
Loss = 2.1707e-01, PNorm = 68.4288, GNorm = 0.6905, lr_0 = 1.9446e-04
Validation auc = 0.902547
Validation accuracy = 0.943925
Validation prc-auc = 0.957890
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 21
Loss = 2.1110e-01, PNorm = 68.4411, GNorm = 0.3713, lr_0 = 1.9099e-04
Validation auc = 0.904208
Validation accuracy = 0.953271
Validation prc-auc = 0.959969
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 22
Loss = 2.0844e-01, PNorm = 68.4574, GNorm = 0.2049, lr_0 = 1.8725e-04
Validation auc = 0.904762
Validation accuracy = 0.943925
Validation prc-auc = 0.960641
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 23
Loss = 1.9382e-01, PNorm = 68.4739, GNorm = 0.3550, lr_0 = 1.8391e-04
Loss = 1.9880e-01, PNorm = 68.4755, GNorm = 0.3615, lr_0 = 1.8358e-04
Validation auc = 0.907530
Validation accuracy = 0.953271
Validation prc-auc = 0.961516
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 24
Loss = 2.0248e-01, PNorm = 68.4917, GNorm = 0.5006, lr_0 = 1.8030e-04
Validation auc = 0.908638
Validation accuracy = 0.953271
Validation prc-auc = 0.962083
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 25
Loss = 2.0092e-01, PNorm = 68.5069, GNorm = 0.8002, lr_0 = 1.7709e-04
Validation auc = 0.908638
Validation accuracy = 0.943925
Validation prc-auc = 0.962229
Validation f1 = 0.965517
Validation mcc = 0.817168
Epoch 26
Validation auc = 0.910299
Validation accuracy = 0.953271
Validation prc-auc = 0.962745
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 27
Loss = 2.2262e-01, PNorm = 68.5249, GNorm = 0.3318, lr_0 = 1.7424e-04
Validation auc = 0.910853
Validation accuracy = 0.953271
Validation prc-auc = 0.963692
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 28
Loss = 2.2386e-01, PNorm = 68.5403, GNorm = 1.1928, lr_0 = 1.7424e-04
Validation auc = 0.911406
Validation accuracy = 0.953271
Validation prc-auc = 0.964387
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 29
Loss = 1.1470e-01, PNorm = 68.5585, GNorm = 0.5598, lr_0 = 1.7424e-04
Validation auc = 0.914175
Validation accuracy = 0.953271
Validation prc-auc = 0.964732
Validation f1 = 0.971098
Validation mcc = 0.849555
Model 3 best validation auc = 0.914175 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.991408
Model 3 test accuracy = 0.966667
Model 3 test prc-auc = 0.997552
Model 3 test f1 = 0.979167
Model 3 test mcc = 0.900898
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.868217
Validation accuracy = 0.878505
Validation prc-auc = 0.948888
Validation f1 = 0.929730
Validation mcc = 0.575264
Epoch 1
Loss = 2.8225e-01, PNorm = 67.4431, GNorm = 0.3718, lr_0 = 1.1868e-03
Validation auc = 0.873754
Validation accuracy = 0.897196
Validation prc-auc = 0.950510
Validation f1 = 0.935673
Validation mcc = 0.680190
Epoch 2
Loss = 2.4176e-01, PNorm = 68.0108, GNorm = 0.2109, lr_0 = 8.0296e-04
Validation auc = 0.878738
Validation accuracy = 0.915888
Validation prc-auc = 0.951657
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 3
Loss = 2.9201e-01, PNorm = 68.1869, GNorm = 0.3153, lr_0 = 3.8068e-04
Validation auc = 0.879845
Validation accuracy = 0.906542
Validation prc-auc = 0.952221
Validation f1 = 0.941860
Validation mcc = 0.703765
Epoch 4
Loss = 2.8292e-01, PNorm = 68.2221, GNorm = 0.2340, lr_0 = 2.6218e-04
Validation auc = 0.884275
Validation accuracy = 0.915888
Validation prc-auc = 0.953538
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 5
Loss = 3.0130e-01, PNorm = 68.2412, GNorm = 0.4446, lr_0 = 2.5751e-04
Validation auc = 0.887043
Validation accuracy = 0.925234
Validation prc-auc = 0.953885
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 6
Loss = 2.1382e-01, PNorm = 68.2586, GNorm = 0.2328, lr_0 = 2.5246e-04
Validation auc = 0.891473
Validation accuracy = 0.915888
Validation prc-auc = 0.955090
Validation f1 = 0.947977
Validation mcc = 0.728835
Epoch 7
Loss = 2.8131e-01, PNorm = 68.2719, GNorm = 0.5873, lr_0 = 2.4795e-04
Validation auc = 0.890365
Validation accuracy = 0.925234
Validation prc-auc = 0.954870
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 8
Loss = 2.4616e-01, PNorm = 68.2863, GNorm = 0.1909, lr_0 = 2.4309e-04
Validation auc = 0.892027
Validation accuracy = 0.915888
Validation prc-auc = 0.955239
Validation f1 = 0.948571
Validation mcc = 0.721364
Epoch 9
Loss = 2.2286e-01, PNorm = 68.3007, GNorm = 0.2807, lr_0 = 2.3876e-04
Validation auc = 0.893134
Validation accuracy = 0.925234
Validation prc-auc = 0.955222
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 10
Loss = 2.4883e-01, PNorm = 68.3157, GNorm = 0.2295, lr_0 = 2.3450e-04
Validation auc = 0.896456
Validation accuracy = 0.925234
Validation prc-auc = 0.956113
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 11
Loss = 2.6392e-01, PNorm = 68.3329, GNorm = 0.2223, lr_0 = 2.2990e-04
Validation auc = 0.897010
Validation accuracy = 0.925234
Validation prc-auc = 0.955076
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 12
Loss = 2.1853e-01, PNorm = 68.3498, GNorm = 0.3112, lr_0 = 2.2580e-04
Validation auc = 0.896456
Validation accuracy = 0.925234
Validation prc-auc = 0.956425
Validation f1 = 0.954023
Validation mcc = 0.755593
Epoch 13
Loss = 2.2408e-01, PNorm = 68.3663, GNorm = 0.2568, lr_0 = 2.2177e-04
Validation auc = 0.895903
Validation accuracy = 0.925234
Validation prc-auc = 0.955404
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 14
Loss = 2.4165e-01, PNorm = 68.3838, GNorm = 0.7967, lr_0 = 2.1742e-04
Validation auc = 0.899225
Validation accuracy = 0.943925
Validation prc-auc = 0.957656
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 15
Loss = 2.2407e-01, PNorm = 68.4003, GNorm = 0.3258, lr_0 = 2.1354e-04
Validation auc = 0.899779
Validation accuracy = 0.925234
Validation prc-auc = 0.958134
Validation f1 = 0.954545
Validation mcc = 0.750775
Epoch 16
Loss = 2.2883e-01, PNorm = 68.4185, GNorm = 0.6766, lr_0 = 2.0936e-04
Validation auc = 0.901993
Validation accuracy = 0.953271
Validation prc-auc = 0.959559
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 17
Loss = 2.0745e-01, PNorm = 68.4381, GNorm = 0.3694, lr_0 = 2.0562e-04
Validation auc = 0.903654
Validation accuracy = 0.953271
Validation prc-auc = 0.960639
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 18
Loss = 2.0019e-01, PNorm = 68.4566, GNorm = 0.3423, lr_0 = 2.0195e-04
Validation auc = 0.905316
Validation accuracy = 0.953271
Validation prc-auc = 0.961156
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 19
Loss = 2.0167e-01, PNorm = 68.4774, GNorm = 0.5523, lr_0 = 1.9800e-04
Validation auc = 0.905869
Validation accuracy = 0.953271
Validation prc-auc = 0.960308
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 20
Loss = 2.0218e-01, PNorm = 68.4951, GNorm = 0.3167, lr_0 = 1.9446e-04
Validation auc = 0.908638
Validation accuracy = 0.953271
Validation prc-auc = 0.961108
Validation f1 = 0.971098
Validation mcc = 0.849555
Epoch 21
Loss = 1.7786e-01, PNorm = 68.5148, GNorm = 0.2207, lr_0 = 1.9099e-04
Validation auc = 0.911406
Validation accuracy = 0.943925
Validation prc-auc = 0.962818
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 22
Loss = 1.9871e-01, PNorm = 68.5299, GNorm = 0.2710, lr_0 = 1.8725e-04
Validation auc = 0.909745
Validation accuracy = 0.962617
Validation prc-auc = 0.964380
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 23
Loss = 1.8924e-01, PNorm = 68.5507, GNorm = 0.4369, lr_0 = 1.8391e-04
Loss = 2.5038e-01, PNorm = 68.5528, GNorm = 0.4318, lr_0 = 1.8358e-04
Validation auc = 0.909745
Validation accuracy = 0.953271
Validation prc-auc = 0.963637
Validation f1 = 0.971751
Validation mcc = 0.848553
Epoch 24
Loss = 1.9022e-01, PNorm = 68.5707, GNorm = 0.8542, lr_0 = 1.8030e-04
Validation auc = 0.910299
Validation accuracy = 0.934579
Validation prc-auc = 0.964434
Validation f1 = 0.959064
Validation mcc = 0.796639
Epoch 25
Loss = 1.9833e-01, PNorm = 68.5899, GNorm = 0.8287, lr_0 = 1.7709e-04
Validation auc = 0.913068
Validation accuracy = 0.962617
Validation prc-auc = 0.965262
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 26
Validation auc = 0.914175
Validation accuracy = 0.962617
Validation prc-auc = 0.965269
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 27
Loss = 1.9051e-01, PNorm = 68.6130, GNorm = 0.2808, lr_0 = 1.7424e-04
Validation auc = 0.913621
Validation accuracy = 0.962617
Validation prc-auc = 0.964702
Validation f1 = 0.977011
Validation mcc = 0.878743
Epoch 28
Loss = 1.6834e-01, PNorm = 68.6339, GNorm = 0.3497, lr_0 = 1.7424e-04
Validation auc = 0.916944
Validation accuracy = 0.943925
Validation prc-auc = 0.966652
Validation f1 = 0.965116
Validation mcc = 0.822259
Epoch 29
Loss = 1.8394e-01, PNorm = 68.6584, GNorm = 0.2498, lr_0 = 1.7424e-04
Validation auc = 0.915282
Validation accuracy = 0.925234
Validation prc-auc = 0.966622
Validation f1 = 0.952941
Validation mcc = 0.772510
Model 4 best validation auc = 0.916944 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.988134
Model 4 test accuracy = 0.975000
Model 4 test prc-auc = 0.996508
Model 4 test f1 = 0.984293
Model 4 test mcc = 0.925881
Ensemble test auc = 0.990589
Ensemble test accuracy = 0.966667
Ensemble test prc-auc = 0.997283
Ensemble test f1 = 0.979167
Ensemble test mcc = 0.900898
Fold 8
Splitting data with seed 8
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 963 | val size = 106 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.937791
Validation accuracy = 0.905660
Validation prc-auc = 0.979950
Validation f1 = 0.945055
Validation mcc = 0.669266
Epoch 1
Loss = 3.1278e-01, PNorm = 67.4530, GNorm = 0.2580, lr_0 = 1.1868e-03
Validation auc = 0.939535
Validation accuracy = 0.943396
Validation prc-auc = 0.980511
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 2
Loss = 2.4637e-01, PNorm = 68.0110, GNorm = 0.4787, lr_0 = 8.0296e-04
Validation auc = 0.937209
Validation accuracy = 0.952830
Validation prc-auc = 0.979262
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 3
Loss = 2.6134e-01, PNorm = 68.1792, GNorm = 0.2353, lr_0 = 3.8068e-04
Validation auc = 0.939535
Validation accuracy = 0.952830
Validation prc-auc = 0.979691
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 4
Loss = 2.3524e-01, PNorm = 68.2112, GNorm = 0.1945, lr_0 = 2.6218e-04
Validation auc = 0.940116
Validation accuracy = 0.952830
Validation prc-auc = 0.979604
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 5
Loss = 3.0902e-01, PNorm = 68.2269, GNorm = 0.2384, lr_0 = 2.5751e-04
Validation auc = 0.938953
Validation accuracy = 0.952830
Validation prc-auc = 0.978155
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 6
Loss = 3.1962e-01, PNorm = 68.2395, GNorm = 0.2505, lr_0 = 2.5246e-04
Validation auc = 0.937209
Validation accuracy = 0.952830
Validation prc-auc = 0.977015
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 7
Loss = 2.6157e-01, PNorm = 68.2494, GNorm = 0.3193, lr_0 = 2.4795e-04
Validation auc = 0.936628
Validation accuracy = 0.952830
Validation prc-auc = 0.976050
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 8
Loss = 2.6449e-01, PNorm = 68.2597, GNorm = 0.2846, lr_0 = 2.4353e-04
Validation auc = 0.940116
Validation accuracy = 0.952830
Validation prc-auc = 0.977120
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 9
Loss = 2.7991e-01, PNorm = 68.2721, GNorm = 0.4514, lr_0 = 2.3876e-04
Validation auc = 0.943023
Validation accuracy = 0.952830
Validation prc-auc = 0.976490
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 10
Loss = 2.5673e-01, PNorm = 68.2838, GNorm = 0.2043, lr_0 = 2.3450e-04
Validation auc = 0.942442
Validation accuracy = 0.943396
Validation prc-auc = 0.975739
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 11
Loss = 2.3474e-01, PNorm = 68.2963, GNorm = 0.3339, lr_0 = 2.2990e-04
Validation auc = 0.944767
Validation accuracy = 0.952830
Validation prc-auc = 0.976965
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 12
Loss = 2.2773e-01, PNorm = 68.3095, GNorm = 0.2585, lr_0 = 2.2580e-04
Validation auc = 0.945930
Validation accuracy = 0.952830
Validation prc-auc = 0.977276
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 13
Loss = 2.3256e-01, PNorm = 68.3219, GNorm = 0.1866, lr_0 = 2.2177e-04
Validation auc = 0.946512
Validation accuracy = 0.943396
Validation prc-auc = 0.975441
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 14
Loss = 2.1430e-01, PNorm = 68.3372, GNorm = 0.5669, lr_0 = 2.1742e-04
Validation auc = 0.947093
Validation accuracy = 0.962264
Validation prc-auc = 0.976953
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 15
Loss = 2.4173e-01, PNorm = 68.3513, GNorm = 0.4583, lr_0 = 2.1354e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.976721
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 16
Loss = 2.3229e-01, PNorm = 68.3642, GNorm = 0.4976, lr_0 = 2.0974e-04
Validation auc = 0.948256
Validation accuracy = 0.943396
Validation prc-auc = 0.975848
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 17
Loss = 2.1017e-01, PNorm = 68.3779, GNorm = 0.4886, lr_0 = 2.0562e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.975848
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 18
Loss = 2.2000e-01, PNorm = 68.3924, GNorm = 0.2736, lr_0 = 2.0195e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.975967
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 19
Loss = 2.0079e-01, PNorm = 68.4105, GNorm = 0.3306, lr_0 = 1.9800e-04
Validation auc = 0.946512
Validation accuracy = 0.952830
Validation prc-auc = 0.973720
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 20
Loss = 2.2163e-01, PNorm = 68.4231, GNorm = 0.8112, lr_0 = 1.9446e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.974733
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 21
Loss = 1.9637e-01, PNorm = 68.4372, GNorm = 0.2582, lr_0 = 1.9099e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.975948
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 22
Loss = 2.0586e-01, PNorm = 68.4545, GNorm = 0.2180, lr_0 = 1.8725e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.975796
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 23
Loss = 2.0345e-01, PNorm = 68.4714, GNorm = 0.8585, lr_0 = 1.8391e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.975017
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 24
Loss = 1.9923e-01, PNorm = 68.4870, GNorm = 0.6214, lr_0 = 1.8063e-04
Loss = 1.7688e-01, PNorm = 68.4885, GNorm = 0.5047, lr_0 = 1.8030e-04
Validation auc = 0.946512
Validation accuracy = 0.952830
Validation prc-auc = 0.972762
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 25
Loss = 1.9918e-01, PNorm = 68.5031, GNorm = 0.4886, lr_0 = 1.7709e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.972912
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 26
Loss = 1.9719e-01, PNorm = 68.5189, GNorm = 0.3633, lr_0 = 1.7424e-04
Validation auc = 0.945930
Validation accuracy = 0.962264
Validation prc-auc = 0.971490
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 27
Validation auc = 0.947674
Validation accuracy = 0.962264
Validation prc-auc = 0.971979
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 28
Loss = 2.1534e-01, PNorm = 68.5354, GNorm = 0.5610, lr_0 = 1.7424e-04
Validation auc = 0.945930
Validation accuracy = 0.971698
Validation prc-auc = 0.971490
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 29
Loss = 2.1561e-01, PNorm = 68.5501, GNorm = 1.2956, lr_0 = 1.7424e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.972266
Validation f1 = 0.977011
Validation mcc = 0.873622
Model 0 best validation auc = 0.948837 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.990589
Model 0 test accuracy = 0.958333
Model 0 test prc-auc = 0.997281
Model 0 test f1 = 0.974093
Model 0 test mcc = 0.875728
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.937209
Validation accuracy = 0.943396
Validation prc-auc = 0.978935
Validation f1 = 0.966292
Validation mcc = 0.808918
Epoch 1
Loss = 3.7312e-01, PNorm = 67.4438, GNorm = 0.2912, lr_0 = 1.1868e-03
Validation auc = 0.937791
Validation accuracy = 0.952830
Validation prc-auc = 0.979275
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 2
Loss = 3.8485e-01, PNorm = 67.9978, GNorm = 0.4444, lr_0 = 8.0296e-04
Validation auc = 0.938953
Validation accuracy = 0.952830
Validation prc-auc = 0.979386
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 3
Loss = 3.3568e-01, PNorm = 68.1698, GNorm = 0.3643, lr_0 = 3.8068e-04
Validation auc = 0.940698
Validation accuracy = 0.952830
Validation prc-auc = 0.980061
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 4
Loss = 3.2288e-01, PNorm = 68.2038, GNorm = 0.3921, lr_0 = 2.6218e-04
Validation auc = 0.937791
Validation accuracy = 0.952830
Validation prc-auc = 0.978094
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 5
Loss = 2.6108e-01, PNorm = 68.2214, GNorm = 0.3234, lr_0 = 2.5751e-04
Validation auc = 0.937209
Validation accuracy = 0.952830
Validation prc-auc = 0.975981
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 6
Loss = 2.1334e-01, PNorm = 68.2369, GNorm = 0.2302, lr_0 = 2.5246e-04
Validation auc = 0.937209
Validation accuracy = 0.952830
Validation prc-auc = 0.974963
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 7
Loss = 2.2955e-01, PNorm = 68.2504, GNorm = 0.2180, lr_0 = 2.4795e-04
Validation auc = 0.940116
Validation accuracy = 0.952830
Validation prc-auc = 0.975196
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 8
Loss = 2.3985e-01, PNorm = 68.2633, GNorm = 0.2551, lr_0 = 2.4353e-04
Validation auc = 0.943023
Validation accuracy = 0.943396
Validation prc-auc = 0.975295
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 9
Loss = 2.5489e-01, PNorm = 68.2780, GNorm = 0.4547, lr_0 = 2.3876e-04
Validation auc = 0.945349
Validation accuracy = 0.971698
Validation prc-auc = 0.976525
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 10
Loss = 2.6326e-01, PNorm = 68.2891, GNorm = 0.7693, lr_0 = 2.3450e-04
Validation auc = 0.945349
Validation accuracy = 0.952830
Validation prc-auc = 0.976525
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 11
Loss = 2.2857e-01, PNorm = 68.3031, GNorm = 0.2383, lr_0 = 2.2990e-04
Validation auc = 0.945930
Validation accuracy = 0.952830
Validation prc-auc = 0.976670
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 12
Loss = 2.5499e-01, PNorm = 68.3162, GNorm = 0.6187, lr_0 = 2.2580e-04
Validation auc = 0.945349
Validation accuracy = 0.962264
Validation prc-auc = 0.975859
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 13
Loss = 2.0876e-01, PNorm = 68.3311, GNorm = 0.2327, lr_0 = 2.2177e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.976277
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 14
Loss = 2.4388e-01, PNorm = 68.3477, GNorm = 1.1461, lr_0 = 2.1742e-04
Validation auc = 0.947674
Validation accuracy = 0.971698
Validation prc-auc = 0.976395
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 15
Loss = 2.1967e-01, PNorm = 68.3635, GNorm = 0.7160, lr_0 = 2.1354e-04
Validation auc = 0.946512
Validation accuracy = 0.943396
Validation prc-auc = 0.975414
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 16
Loss = 2.2209e-01, PNorm = 68.3760, GNorm = 0.4729, lr_0 = 2.0974e-04
Validation auc = 0.948837
Validation accuracy = 0.952830
Validation prc-auc = 0.975967
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 17
Loss = 2.1728e-01, PNorm = 68.3914, GNorm = 0.5592, lr_0 = 2.0562e-04
Validation auc = 0.948837
Validation accuracy = 0.952830
Validation prc-auc = 0.975967
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 18
Loss = 2.1391e-01, PNorm = 68.4077, GNorm = 0.6503, lr_0 = 2.0195e-04
Validation auc = 0.950000
Validation accuracy = 0.952830
Validation prc-auc = 0.977632
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 19
Loss = 2.0836e-01, PNorm = 68.4244, GNorm = 0.7484, lr_0 = 1.9800e-04
Validation auc = 0.948837
Validation accuracy = 0.943396
Validation prc-auc = 0.975967
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 20
Loss = 2.2258e-01, PNorm = 68.4397, GNorm = 0.6914, lr_0 = 1.9446e-04
Validation auc = 0.948837
Validation accuracy = 0.943396
Validation prc-auc = 0.975967
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 21
Loss = 2.0102e-01, PNorm = 68.4527, GNorm = 0.3487, lr_0 = 1.9099e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.975967
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 22
Loss = 2.0299e-01, PNorm = 68.4698, GNorm = 0.8636, lr_0 = 1.8725e-04
Validation auc = 0.951163
Validation accuracy = 0.962264
Validation prc-auc = 0.977927
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 23
Loss = 2.0340e-01, PNorm = 68.4845, GNorm = 0.2333, lr_0 = 1.8391e-04
Validation auc = 0.951163
Validation accuracy = 0.962264
Validation prc-auc = 0.977268
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 24
Loss = 1.9818e-01, PNorm = 68.5009, GNorm = 0.7277, lr_0 = 1.8063e-04
Loss = 2.2143e-01, PNorm = 68.5025, GNorm = 0.6226, lr_0 = 1.8030e-04
Validation auc = 0.950581
Validation accuracy = 0.933962
Validation prc-auc = 0.975625
Validation f1 = 0.959064
Validation mcc = 0.788723
Epoch 25
Loss = 1.9252e-01, PNorm = 68.5191, GNorm = 0.6443, lr_0 = 1.7709e-04
Validation auc = 0.951744
Validation accuracy = 0.971698
Validation prc-auc = 0.977385
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 26
Loss = 1.9676e-01, PNorm = 68.5328, GNorm = 0.8779, lr_0 = 1.7424e-04
Validation auc = 0.949419
Validation accuracy = 0.952830
Validation prc-auc = 0.972398
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 27
Validation auc = 0.951744
Validation accuracy = 0.962264
Validation prc-auc = 0.977385
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 28
Loss = 1.9761e-01, PNorm = 68.5521, GNorm = 0.6849, lr_0 = 1.7424e-04
Validation auc = 0.950000
Validation accuracy = 0.943396
Validation prc-auc = 0.974612
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 29
Loss = 2.1528e-01, PNorm = 68.5696, GNorm = 1.4494, lr_0 = 1.7424e-04
Validation auc = 0.951163
Validation accuracy = 0.962264
Validation prc-auc = 0.976523
Validation f1 = 0.977011
Validation mcc = 0.873622
Model 1 best validation auc = 0.951744 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.991408
Model 1 test accuracy = 0.950000
Model 1 test prc-auc = 0.997547
Model 1 test f1 = 0.969072
Model 1 test mcc = 0.850339
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.942442
Validation accuracy = 0.952830
Validation prc-auc = 0.982468
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 1
Loss = 2.5405e-01, PNorm = 67.3869, GNorm = 0.2659, lr_0 = 1.1868e-03
Validation auc = 0.943023
Validation accuracy = 0.952830
Validation prc-auc = 0.982390
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 2
Loss = 2.9097e-01, PNorm = 67.9431, GNorm = 0.2438, lr_0 = 8.0296e-04
Validation auc = 0.941279
Validation accuracy = 0.971698
Validation prc-auc = 0.980485
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 3
Loss = 2.1428e-01, PNorm = 68.1169, GNorm = 0.6610, lr_0 = 3.8068e-04
Validation auc = 0.937791
Validation accuracy = 0.943396
Validation prc-auc = 0.976970
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 4
Loss = 2.9854e-01, PNorm = 68.1508, GNorm = 0.5888, lr_0 = 2.6218e-04
Validation auc = 0.944767
Validation accuracy = 0.971698
Validation prc-auc = 0.980456
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 5
Loss = 1.7688e-01, PNorm = 68.1678, GNorm = 0.2289, lr_0 = 2.5751e-04
Validation auc = 0.945349
Validation accuracy = 0.943396
Validation prc-auc = 0.979114
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 6
Loss = 2.7241e-01, PNorm = 68.1831, GNorm = 0.2481, lr_0 = 2.5246e-04
Validation auc = 0.947093
Validation accuracy = 0.971698
Validation prc-auc = 0.979570
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 7
Loss = 2.3865e-01, PNorm = 68.1964, GNorm = 0.1972, lr_0 = 2.4795e-04
Validation auc = 0.945930
Validation accuracy = 0.952830
Validation prc-auc = 0.977832
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 8
Loss = 2.1192e-01, PNorm = 68.2110, GNorm = 0.3787, lr_0 = 2.4353e-04
Validation auc = 0.945930
Validation accuracy = 0.971698
Validation prc-auc = 0.977271
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 9
Loss = 2.2431e-01, PNorm = 68.2258, GNorm = 0.2877, lr_0 = 2.3876e-04
Validation auc = 0.945349
Validation accuracy = 0.952830
Validation prc-auc = 0.975138
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 10
Loss = 2.2794e-01, PNorm = 68.2399, GNorm = 0.6048, lr_0 = 2.3450e-04
Validation auc = 0.946512
Validation accuracy = 0.971698
Validation prc-auc = 0.975427
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 11
Loss = 2.3372e-01, PNorm = 68.2563, GNorm = 0.5932, lr_0 = 2.2990e-04
Validation auc = 0.948256
Validation accuracy = 0.952830
Validation prc-auc = 0.976547
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 12
Loss = 2.4783e-01, PNorm = 68.2724, GNorm = 1.3974, lr_0 = 2.2580e-04
Validation auc = 0.947093
Validation accuracy = 0.952830
Validation prc-auc = 0.976261
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 13
Loss = 2.4007e-01, PNorm = 68.2880, GNorm = 0.2565, lr_0 = 2.2177e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.976528
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 14
Loss = 1.9722e-01, PNorm = 68.3085, GNorm = 0.3920, lr_0 = 2.1742e-04
Validation auc = 0.947674
Validation accuracy = 0.971698
Validation prc-auc = 0.977021
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 15
Loss = 2.1221e-01, PNorm = 68.3260, GNorm = 0.5897, lr_0 = 2.1354e-04
Validation auc = 0.946512
Validation accuracy = 0.952830
Validation prc-auc = 0.974555
Validation f1 = 0.970760
Validation mcc = 0.849219
Epoch 16
Loss = 2.1188e-01, PNorm = 68.3437, GNorm = 0.4625, lr_0 = 2.0974e-04
Validation auc = 0.949419
Validation accuracy = 0.971698
Validation prc-auc = 0.977462
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 17
Loss = 2.2157e-01, PNorm = 68.3619, GNorm = 0.6988, lr_0 = 2.0562e-04
Validation auc = 0.949419
Validation accuracy = 0.962264
Validation prc-auc = 0.976811
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 18
Loss = 2.3538e-01, PNorm = 68.3804, GNorm = 0.3338, lr_0 = 2.0195e-04
Validation auc = 0.949419
Validation accuracy = 0.962264
Validation prc-auc = 0.976789
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 19
Loss = 2.0701e-01, PNorm = 68.4030, GNorm = 0.2783, lr_0 = 1.9800e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.975772
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 20
Loss = 2.0731e-01, PNorm = 68.4238, GNorm = 0.3305, lr_0 = 1.9446e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.976505
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 21
Loss = 1.9395e-01, PNorm = 68.4450, GNorm = 0.3045, lr_0 = 1.9099e-04
Validation auc = 0.948837
Validation accuracy = 0.952830
Validation prc-auc = 0.975948
Validation f1 = 0.970760
Validation mcc = 0.849219
Epoch 22
Loss = 1.9694e-01, PNorm = 68.4653, GNorm = 0.5554, lr_0 = 1.8725e-04
Validation auc = 0.947674
Validation accuracy = 0.962264
Validation prc-auc = 0.976321
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 23
Loss = 1.8543e-01, PNorm = 68.4822, GNorm = 0.2413, lr_0 = 1.8391e-04
Validation auc = 0.947093
Validation accuracy = 0.962264
Validation prc-auc = 0.975458
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 24
Loss = 1.9679e-01, PNorm = 68.5012, GNorm = 0.9213, lr_0 = 1.8063e-04
Loss = 1.8726e-01, PNorm = 68.5033, GNorm = 0.3084, lr_0 = 1.8030e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.975926
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 25
Loss = 1.8661e-01, PNorm = 68.5241, GNorm = 0.6152, lr_0 = 1.7709e-04
Validation auc = 0.952326
Validation accuracy = 0.962264
Validation prc-auc = 0.978188
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 26
Loss = 1.8455e-01, PNorm = 68.5453, GNorm = 1.1627, lr_0 = 1.7424e-04
Validation auc = 0.951163
Validation accuracy = 0.971698
Validation prc-auc = 0.977894
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 27
Validation auc = 0.951744
Validation accuracy = 0.971698
Validation prc-auc = 0.978645
Validation f1 = 0.982659
Validation mcc = 0.906197
Epoch 28
Loss = 9.8705e-02, PNorm = 68.5679, GNorm = 0.5717, lr_0 = 1.7424e-04
Validation auc = 0.951163
Validation accuracy = 0.971698
Validation prc-auc = 0.978495
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 29
Loss = 2.0803e-01, PNorm = 68.5878, GNorm = 1.1091, lr_0 = 1.7424e-04
Validation auc = 0.954070
Validation accuracy = 0.962264
Validation prc-auc = 0.979226
Validation f1 = 0.977011
Validation mcc = 0.873622
Model 2 best validation auc = 0.954070 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.990589
Model 2 test accuracy = 0.958333
Model 2 test prc-auc = 0.997303
Model 2 test f1 = 0.974093
Model 2 test mcc = 0.875728
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.939535
Validation accuracy = 0.943396
Validation prc-auc = 0.980986
Validation f1 = 0.966292
Validation mcc = 0.808918
Epoch 1
Loss = 3.0524e-01, PNorm = 67.4754, GNorm = 0.2607, lr_0 = 1.1868e-03
Validation auc = 0.942442
Validation accuracy = 0.952830
Validation prc-auc = 0.982334
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 2
Loss = 3.1747e-01, PNorm = 68.0307, GNorm = 0.2441, lr_0 = 8.0296e-04
Validation auc = 0.941279
Validation accuracy = 0.952830
Validation prc-auc = 0.981523
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 3
Loss = 3.1029e-01, PNorm = 68.2007, GNorm = 0.3243, lr_0 = 3.8068e-04
Validation auc = 0.941279
Validation accuracy = 0.952830
Validation prc-auc = 0.980972
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 4
Loss = 2.1531e-01, PNorm = 68.2338, GNorm = 0.2174, lr_0 = 2.6218e-04
Validation auc = 0.938953
Validation accuracy = 0.952830
Validation prc-auc = 0.979132
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 5
Loss = 3.5695e-01, PNorm = 68.2507, GNorm = 0.6109, lr_0 = 2.5751e-04
Validation auc = 0.940698
Validation accuracy = 0.952830
Validation prc-auc = 0.979464
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 6
Loss = 2.6829e-01, PNorm = 68.2650, GNorm = 0.4501, lr_0 = 2.5246e-04
Validation auc = 0.943023
Validation accuracy = 0.952830
Validation prc-auc = 0.979523
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 7
Loss = 2.4412e-01, PNorm = 68.2767, GNorm = 0.3451, lr_0 = 2.4795e-04
Validation auc = 0.945349
Validation accuracy = 0.952830
Validation prc-auc = 0.980568
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 8
Loss = 2.8372e-01, PNorm = 68.2873, GNorm = 0.4031, lr_0 = 2.4353e-04
Validation auc = 0.944767
Validation accuracy = 0.943396
Validation prc-auc = 0.978924
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 9
Loss = 2.1076e-01, PNorm = 68.3007, GNorm = 0.2458, lr_0 = 2.3876e-04
Validation auc = 0.946512
Validation accuracy = 0.952830
Validation prc-auc = 0.979814
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 10
Loss = 2.2329e-01, PNorm = 68.3148, GNorm = 0.5153, lr_0 = 2.3450e-04
Validation auc = 0.949419
Validation accuracy = 0.952830
Validation prc-auc = 0.980981
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 11
Loss = 2.5739e-01, PNorm = 68.3300, GNorm = 0.2390, lr_0 = 2.2990e-04
Validation auc = 0.949419
Validation accuracy = 0.952830
Validation prc-auc = 0.980981
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 12
Loss = 2.2675e-01, PNorm = 68.3442, GNorm = 0.2647, lr_0 = 2.2580e-04
Validation auc = 0.950000
Validation accuracy = 0.952830
Validation prc-auc = 0.979857
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 13
Loss = 2.2411e-01, PNorm = 68.3611, GNorm = 1.5746, lr_0 = 2.2177e-04
Validation auc = 0.951744
Validation accuracy = 0.971698
Validation prc-auc = 0.981548
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 14
Loss = 2.3358e-01, PNorm = 68.3771, GNorm = 0.3029, lr_0 = 2.1742e-04
Validation auc = 0.949419
Validation accuracy = 0.952830
Validation prc-auc = 0.979703
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 15
Loss = 2.3552e-01, PNorm = 68.3940, GNorm = 0.3402, lr_0 = 2.1354e-04
Validation auc = 0.951163
Validation accuracy = 0.962264
Validation prc-auc = 0.980100
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 16
Loss = 2.3678e-01, PNorm = 68.4107, GNorm = 0.6224, lr_0 = 2.0974e-04
Validation auc = 0.950000
Validation accuracy = 0.962264
Validation prc-auc = 0.978233
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 17
Loss = 2.1840e-01, PNorm = 68.4291, GNorm = 0.7676, lr_0 = 2.0562e-04
Validation auc = 0.950000
Validation accuracy = 0.952830
Validation prc-auc = 0.978233
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 18
Loss = 2.2887e-01, PNorm = 68.4471, GNorm = 0.2853, lr_0 = 2.0195e-04
Validation auc = 0.948837
Validation accuracy = 0.952830
Validation prc-auc = 0.976680
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 19
Loss = 2.0949e-01, PNorm = 68.4658, GNorm = 0.5842, lr_0 = 1.9800e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.976659
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 20
Loss = 2.1372e-01, PNorm = 68.4832, GNorm = 0.5354, lr_0 = 1.9446e-04
Validation auc = 0.949419
Validation accuracy = 0.962264
Validation prc-auc = 0.976811
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 21
Loss = 2.1216e-01, PNorm = 68.5020, GNorm = 0.4143, lr_0 = 1.9099e-04
Validation auc = 0.950000
Validation accuracy = 0.962264
Validation prc-auc = 0.976961
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 22
Loss = 1.9527e-01, PNorm = 68.5232, GNorm = 0.6711, lr_0 = 1.8725e-04
Validation auc = 0.952326
Validation accuracy = 0.952830
Validation prc-auc = 0.978202
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 23
Loss = 2.1142e-01, PNorm = 68.5427, GNorm = 0.4328, lr_0 = 1.8391e-04
Validation auc = 0.952326
Validation accuracy = 0.962264
Validation prc-auc = 0.978202
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 24
Loss = 2.1526e-01, PNorm = 68.5599, GNorm = 1.7943, lr_0 = 1.8063e-04
Loss = 2.0708e-01, PNorm = 68.5618, GNorm = 0.5658, lr_0 = 1.8030e-04
Validation auc = 0.952907
Validation accuracy = 0.952830
Validation prc-auc = 0.978345
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 25
Loss = 1.9442e-01, PNorm = 68.5803, GNorm = 0.7141, lr_0 = 1.7709e-04
Validation auc = 0.952326
Validation accuracy = 0.962264
Validation prc-auc = 0.978202
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 26
Loss = 1.9005e-01, PNorm = 68.6001, GNorm = 0.5735, lr_0 = 1.7424e-04
Validation auc = 0.952907
Validation accuracy = 0.971698
Validation prc-auc = 0.978939
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 27
Validation auc = 0.950000
Validation accuracy = 0.943396
Validation prc-auc = 0.974604
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 28
Loss = 2.8525e-01, PNorm = 68.6182, GNorm = 0.8743, lr_0 = 1.7424e-04
Validation auc = 0.950000
Validation accuracy = 0.962264
Validation prc-auc = 0.974578
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 29
Loss = 1.4198e-01, PNorm = 68.6361, GNorm = 0.4726, lr_0 = 1.7424e-04
Validation auc = 0.950581
Validation accuracy = 0.952830
Validation prc-auc = 0.975617
Validation f1 = 0.971098
Validation mcc = 0.843333
Model 3 best validation auc = 0.952907 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.990998
Model 3 test accuracy = 0.966667
Model 3 test prc-auc = 0.997434
Model 3 test f1 = 0.978947
Model 3 test mcc = 0.900139
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.945930
Validation accuracy = 0.915094
Validation prc-auc = 0.983806
Validation f1 = 0.950276
Validation mcc = 0.705617
Epoch 1
Loss = 2.6033e-01, PNorm = 67.4244, GNorm = 0.3394, lr_0 = 1.1868e-03
Validation auc = 0.946512
Validation accuracy = 0.952830
Validation prc-auc = 0.984045
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 2
Loss = 3.3065e-01, PNorm = 67.9869, GNorm = 0.2563, lr_0 = 8.0296e-04
Validation auc = 0.940698
Validation accuracy = 0.952830
Validation prc-auc = 0.980690
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 3
Loss = 3.0155e-01, PNorm = 68.1601, GNorm = 0.3389, lr_0 = 3.8068e-04
Validation auc = 0.939535
Validation accuracy = 0.952830
Validation prc-auc = 0.979427
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 4
Loss = 2.3753e-01, PNorm = 68.1932, GNorm = 0.2816, lr_0 = 2.6218e-04
Validation auc = 0.938372
Validation accuracy = 0.952830
Validation prc-auc = 0.978872
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 5
Loss = 3.1075e-01, PNorm = 68.2107, GNorm = 0.4195, lr_0 = 2.5751e-04
Validation auc = 0.941279
Validation accuracy = 0.952830
Validation prc-auc = 0.979505
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 6
Loss = 2.4487e-01, PNorm = 68.2253, GNorm = 0.2135, lr_0 = 2.5246e-04
Validation auc = 0.941279
Validation accuracy = 0.952830
Validation prc-auc = 0.978840
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 7
Loss = 2.2168e-01, PNorm = 68.2378, GNorm = 0.5356, lr_0 = 2.4795e-04
Validation auc = 0.943023
Validation accuracy = 0.952830
Validation prc-auc = 0.978948
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 8
Loss = 2.6802e-01, PNorm = 68.2515, GNorm = 0.3409, lr_0 = 2.4353e-04
Validation auc = 0.943023
Validation accuracy = 0.943396
Validation prc-auc = 0.977117
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 9
Loss = 2.3802e-01, PNorm = 68.2664, GNorm = 0.2884, lr_0 = 2.3876e-04
Validation auc = 0.948256
Validation accuracy = 0.962264
Validation prc-auc = 0.980290
Validation f1 = 0.977273
Validation mcc = 0.874325
Epoch 10
Loss = 2.1902e-01, PNorm = 68.2802, GNorm = 0.1838, lr_0 = 2.3450e-04
Validation auc = 0.948256
Validation accuracy = 0.943396
Validation prc-auc = 0.979420
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 11
Loss = 2.4141e-01, PNorm = 68.2940, GNorm = 0.2560, lr_0 = 2.2990e-04
Validation auc = 0.949419
Validation accuracy = 0.962264
Validation prc-auc = 0.980159
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 12
Loss = 2.1284e-01, PNorm = 68.3088, GNorm = 0.8509, lr_0 = 2.2580e-04
Validation auc = 0.948256
Validation accuracy = 0.952830
Validation prc-auc = 0.978409
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 13
Loss = 2.6087e-01, PNorm = 68.3245, GNorm = 0.2269, lr_0 = 2.2177e-04
Validation auc = 0.949419
Validation accuracy = 0.971698
Validation prc-auc = 0.978101
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 14
Loss = 2.0936e-01, PNorm = 68.3429, GNorm = 0.2950, lr_0 = 2.1742e-04
Validation auc = 0.948837
Validation accuracy = 0.943396
Validation prc-auc = 0.977331
Validation f1 = 0.965116
Validation mcc = 0.815116
Epoch 15
Loss = 2.4049e-01, PNorm = 68.3550, GNorm = 0.2389, lr_0 = 2.1354e-04
Validation auc = 0.948837
Validation accuracy = 0.971698
Validation prc-auc = 0.977365
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 16
Loss = 2.3175e-01, PNorm = 68.3699, GNorm = 0.8086, lr_0 = 2.0974e-04
Validation auc = 0.949419
Validation accuracy = 0.952830
Validation prc-auc = 0.978129
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 17
Loss = 2.2247e-01, PNorm = 68.3862, GNorm = 0.4101, lr_0 = 2.0562e-04
Validation auc = 0.950581
Validation accuracy = 0.952830
Validation prc-auc = 0.978383
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 18
Loss = 2.1164e-01, PNorm = 68.4028, GNorm = 0.2754, lr_0 = 2.0195e-04
Validation auc = 0.949419
Validation accuracy = 0.971698
Validation prc-auc = 0.977483
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 19
Loss = 1.9967e-01, PNorm = 68.4217, GNorm = 0.2961, lr_0 = 1.9800e-04
Validation auc = 0.948837
Validation accuracy = 0.971698
Validation prc-auc = 0.977331
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 20
Loss = 1.9412e-01, PNorm = 68.4373, GNorm = 0.5190, lr_0 = 1.9446e-04
Validation auc = 0.950000
Validation accuracy = 0.952830
Validation prc-auc = 0.977632
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 21
Loss = 2.0444e-01, PNorm = 68.4531, GNorm = 0.3285, lr_0 = 1.9099e-04
Validation auc = 0.950000
Validation accuracy = 0.971698
Validation prc-auc = 0.977614
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 22
Loss = 1.9758e-01, PNorm = 68.4729, GNorm = 0.5844, lr_0 = 1.8725e-04
Validation auc = 0.950000
Validation accuracy = 0.971698
Validation prc-auc = 0.977614
Validation f1 = 0.982857
Validation mcc = 0.906283
Epoch 23
Loss = 2.1027e-01, PNorm = 68.4884, GNorm = 0.3809, lr_0 = 1.8391e-04
Validation auc = 0.948837
Validation accuracy = 0.962264
Validation prc-auc = 0.977903
Validation f1 = 0.976744
Validation mcc = 0.876744
Epoch 24
Loss = 1.9441e-01, PNorm = 68.5039, GNorm = 0.8309, lr_0 = 1.8063e-04
Loss = 2.8722e-01, PNorm = 68.5055, GNorm = 1.4709, lr_0 = 1.8030e-04
Validation auc = 0.951163
Validation accuracy = 0.962264
Validation prc-auc = 0.977912
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 25
Loss = 1.9138e-01, PNorm = 68.5227, GNorm = 0.3801, lr_0 = 1.7709e-04
Validation auc = 0.951163
Validation accuracy = 0.962264
Validation prc-auc = 0.977912
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 26
Loss = 1.8720e-01, PNorm = 68.5402, GNorm = 0.3637, lr_0 = 1.7424e-04
Validation auc = 0.952326
Validation accuracy = 0.952830
Validation prc-auc = 0.979383
Validation f1 = 0.971098
Validation mcc = 0.843333
Epoch 27
Validation auc = 0.952907
Validation accuracy = 0.962264
Validation prc-auc = 0.979514
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 28
Loss = 2.7253e-01, PNorm = 68.5581, GNorm = 0.4245, lr_0 = 1.7424e-04
Validation auc = 0.952326
Validation accuracy = 0.962264
Validation prc-auc = 0.978188
Validation f1 = 0.977011
Validation mcc = 0.873622
Epoch 29
Loss = 1.8806e-01, PNorm = 68.5750, GNorm = 1.5815, lr_0 = 1.7424e-04
Validation auc = 0.952326
Validation accuracy = 0.952830
Validation prc-auc = 0.978214
Validation f1 = 0.971098
Validation mcc = 0.843333
Model 4 best validation auc = 0.952907 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.989362
Model 4 test accuracy = 0.966667
Model 4 test prc-auc = 0.996907
Model 4 test f1 = 0.979167
Model 4 test mcc = 0.900898
Ensemble test auc = 0.990998
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.997420
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
Fold 9
Splitting data with seed 9
Class sizes
Label 0: 21.42%, 1: 78.58%
Total size = 1,069 | train size = 962 | val size = 107 | test size = 120
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.863354
Validation accuracy = 0.915888
Validation prc-auc = 0.947825
Validation f1 = 0.949153
Validation mcc = 0.741478
Epoch 1
Loss = 2.4715e-01, PNorm = 67.4583, GNorm = 0.2022, lr_0 = 1.1868e-03
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.946114
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 2
Loss = 2.1428e-01, PNorm = 68.0137, GNorm = 0.5596, lr_0 = 8.0296e-04
Validation auc = 0.859731
Validation accuracy = 0.906542
Validation prc-auc = 0.944558
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 3
Loss = 2.5535e-01, PNorm = 68.1839, GNorm = 0.1999, lr_0 = 3.8068e-04
Validation auc = 0.860766
Validation accuracy = 0.897196
Validation prc-auc = 0.944959
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 4
Loss = 2.6192e-01, PNorm = 68.2182, GNorm = 0.2049, lr_0 = 2.6218e-04
Validation auc = 0.863872
Validation accuracy = 0.906542
Validation prc-auc = 0.946558
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 5
Loss = 1.8859e-01, PNorm = 68.2363, GNorm = 0.1912, lr_0 = 2.5751e-04
Validation auc = 0.863872
Validation accuracy = 0.906542
Validation prc-auc = 0.946590
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 6
Loss = 2.3366e-01, PNorm = 68.2520, GNorm = 0.4523, lr_0 = 2.5246e-04
Validation auc = 0.864907
Validation accuracy = 0.906542
Validation prc-auc = 0.948037
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 7
Loss = 2.6997e-01, PNorm = 68.2649, GNorm = 0.2614, lr_0 = 2.4795e-04
Validation auc = 0.865942
Validation accuracy = 0.897196
Validation prc-auc = 0.947611
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 8
Loss = 2.3566e-01, PNorm = 68.2800, GNorm = 0.2240, lr_0 = 2.4309e-04
Validation auc = 0.864389
Validation accuracy = 0.897196
Validation prc-auc = 0.945905
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 9
Loss = 1.9512e-01, PNorm = 68.2954, GNorm = 0.5396, lr_0 = 2.3876e-04
Validation auc = 0.864389
Validation accuracy = 0.897196
Validation prc-auc = 0.944530
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 10
Loss = 2.5185e-01, PNorm = 68.3114, GNorm = 0.2948, lr_0 = 2.3450e-04
Validation auc = 0.860766
Validation accuracy = 0.897196
Validation prc-auc = 0.941598
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 11
Loss = 2.0359e-01, PNorm = 68.3282, GNorm = 0.5782, lr_0 = 2.2990e-04
Validation auc = 0.869565
Validation accuracy = 0.915888
Validation prc-auc = 0.948554
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 12
Loss = 1.9704e-01, PNorm = 68.3402, GNorm = 0.2479, lr_0 = 2.2580e-04
Validation auc = 0.862319
Validation accuracy = 0.906542
Validation prc-auc = 0.944739
Validation f1 = 0.941176
Validation mcc = 0.715227
Epoch 13
Loss = 2.2980e-01, PNorm = 68.3554, GNorm = 0.7698, lr_0 = 2.2177e-04
Validation auc = 0.865942
Validation accuracy = 0.915888
Validation prc-auc = 0.946329
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 14
Loss = 2.1238e-01, PNorm = 68.3728, GNorm = 0.8478, lr_0 = 2.1742e-04
Validation auc = 0.862836
Validation accuracy = 0.906542
Validation prc-auc = 0.945041
Validation f1 = 0.941176
Validation mcc = 0.715227
Epoch 15
Loss = 1.9031e-01, PNorm = 68.3889, GNorm = 0.3420, lr_0 = 2.1354e-04
Validation auc = 0.863354
Validation accuracy = 0.915888
Validation prc-auc = 0.945400
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 16
Loss = 1.8674e-01, PNorm = 68.4083, GNorm = 1.2375, lr_0 = 2.0936e-04
Validation auc = 0.862319
Validation accuracy = 0.906542
Validation prc-auc = 0.943818
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 17
Loss = 1.8098e-01, PNorm = 68.4257, GNorm = 0.2749, lr_0 = 2.0562e-04
Validation auc = 0.860248
Validation accuracy = 0.906542
Validation prc-auc = 0.943702
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 18
Loss = 2.1673e-01, PNorm = 68.4418, GNorm = 1.0063, lr_0 = 2.0195e-04
Validation auc = 0.864907
Validation accuracy = 0.915888
Validation prc-auc = 0.946125
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 19
Loss = 2.0118e-01, PNorm = 68.4598, GNorm = 0.3235, lr_0 = 1.9800e-04
Validation auc = 0.859213
Validation accuracy = 0.897196
Validation prc-auc = 0.944738
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 20
Loss = 1.8538e-01, PNorm = 68.4801, GNorm = 0.5005, lr_0 = 1.9446e-04
Validation auc = 0.858178
Validation accuracy = 0.897196
Validation prc-auc = 0.942290
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 21
Loss = 1.9366e-01, PNorm = 68.5006, GNorm = 0.5719, lr_0 = 1.9099e-04
Validation auc = 0.858696
Validation accuracy = 0.906542
Validation prc-auc = 0.942501
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 22
Loss = 1.9656e-01, PNorm = 68.5196, GNorm = 0.3817, lr_0 = 1.8725e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.945504
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 23
Loss = 1.8509e-01, PNorm = 68.5380, GNorm = 0.3150, lr_0 = 1.8391e-04
Loss = 1.4414e-01, PNorm = 68.5401, GNorm = 0.4018, lr_0 = 1.8358e-04
Validation auc = 0.858178
Validation accuracy = 0.887850
Validation prc-auc = 0.944175
Validation f1 = 0.929412
Validation mcc = 0.657945
Epoch 24
Loss = 1.8650e-01, PNorm = 68.5603, GNorm = 0.4402, lr_0 = 1.8030e-04
Validation auc = 0.862836
Validation accuracy = 0.906542
Validation prc-auc = 0.945042
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 25
Loss = 1.8344e-01, PNorm = 68.5761, GNorm = 1.1789, lr_0 = 1.7709e-04
Validation auc = 0.866460
Validation accuracy = 0.906542
Validation prc-auc = 0.946784
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 26
Validation auc = 0.862319
Validation accuracy = 0.897196
Validation prc-auc = 0.945429
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 27
Loss = 2.6770e-01, PNorm = 68.5967, GNorm = 0.4541, lr_0 = 1.7424e-04
Validation auc = 0.858696
Validation accuracy = 0.906542
Validation prc-auc = 0.944927
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 28
Loss = 2.4780e-01, PNorm = 68.6159, GNorm = 1.0825, lr_0 = 1.7424e-04
Validation auc = 0.860248
Validation accuracy = 0.906542
Validation prc-auc = 0.946190
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 29
Loss = 1.8098e-01, PNorm = 68.6356, GNorm = 1.4710, lr_0 = 1.7424e-04
Validation auc = 0.864907
Validation accuracy = 0.897196
Validation prc-auc = 0.946833
Validation f1 = 0.936416
Validation mcc = 0.676982
Model 0 best validation auc = 0.869565 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.988134
Model 0 test accuracy = 0.950000
Model 0 test prc-auc = 0.996558
Model 0 test f1 = 0.969072
Model 0 test mcc = 0.850339
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.860766
Validation accuracy = 0.915888
Validation prc-auc = 0.945142
Validation f1 = 0.949153
Validation mcc = 0.741478
Epoch 1
Loss = 3.7795e-01, PNorm = 67.4410, GNorm = 0.3771, lr_0 = 1.1868e-03
Validation auc = 0.859731
Validation accuracy = 0.906542
Validation prc-auc = 0.944544
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 2
Loss = 3.5344e-01, PNorm = 67.9997, GNorm = 0.3132, lr_0 = 8.0296e-04
Validation auc = 0.856625
Validation accuracy = 0.897196
Validation prc-auc = 0.942454
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 3
Loss = 2.6058e-01, PNorm = 68.1712, GNorm = 0.3380, lr_0 = 3.8068e-04
Validation auc = 0.858696
Validation accuracy = 0.906542
Validation prc-auc = 0.943251
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 4
Loss = 2.2944e-01, PNorm = 68.2039, GNorm = 0.2482, lr_0 = 2.6218e-04
Validation auc = 0.861284
Validation accuracy = 0.906542
Validation prc-auc = 0.944645
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 5
Loss = 2.4269e-01, PNorm = 68.2207, GNorm = 0.3737, lr_0 = 2.5751e-04
Validation auc = 0.863872
Validation accuracy = 0.897196
Validation prc-auc = 0.945590
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 6
Loss = 2.4055e-01, PNorm = 68.2348, GNorm = 0.2475, lr_0 = 2.5246e-04
Validation auc = 0.860248
Validation accuracy = 0.906542
Validation prc-auc = 0.943283
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 7
Loss = 2.0614e-01, PNorm = 68.2479, GNorm = 0.2630, lr_0 = 2.4795e-04
Validation auc = 0.860248
Validation accuracy = 0.897196
Validation prc-auc = 0.942739
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 8
Loss = 1.9898e-01, PNorm = 68.2645, GNorm = 0.4158, lr_0 = 2.4309e-04
Validation auc = 0.860766
Validation accuracy = 0.897196
Validation prc-auc = 0.941861
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 9
Loss = 2.1189e-01, PNorm = 68.2807, GNorm = 0.6596, lr_0 = 2.3876e-04
Validation auc = 0.860248
Validation accuracy = 0.897196
Validation prc-auc = 0.938016
Validation f1 = 0.934911
Validation mcc = 0.690781
Epoch 10
Loss = 2.4137e-01, PNorm = 68.2962, GNorm = 0.2883, lr_0 = 2.3450e-04
Validation auc = 0.860766
Validation accuracy = 0.887850
Validation prc-auc = 0.938901
Validation f1 = 0.930233
Validation mcc = 0.649862
Epoch 11
Loss = 2.0425e-01, PNorm = 68.3126, GNorm = 0.6910, lr_0 = 2.2990e-04
Validation auc = 0.858178
Validation accuracy = 0.897196
Validation prc-auc = 0.938220
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 12
Loss = 1.9107e-01, PNorm = 68.3264, GNorm = 0.2946, lr_0 = 2.2580e-04
Validation auc = 0.857660
Validation accuracy = 0.897196
Validation prc-auc = 0.938507
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 13
Loss = 1.9629e-01, PNorm = 68.3384, GNorm = 0.5564, lr_0 = 2.2177e-04
Validation auc = 0.861801
Validation accuracy = 0.897196
Validation prc-auc = 0.943354
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 14
Loss = 2.2174e-01, PNorm = 68.3529, GNorm = 0.8609, lr_0 = 2.1742e-04
Validation auc = 0.859213
Validation accuracy = 0.897196
Validation prc-auc = 0.942484
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 15
Loss = 2.0380e-01, PNorm = 68.3685, GNorm = 0.6346, lr_0 = 2.1354e-04
Validation auc = 0.858696
Validation accuracy = 0.897196
Validation prc-auc = 0.942166
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 16
Loss = 1.8963e-01, PNorm = 68.3890, GNorm = 1.4097, lr_0 = 2.0936e-04
Validation auc = 0.857143
Validation accuracy = 0.897196
Validation prc-auc = 0.939116
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 17
Loss = 1.7509e-01, PNorm = 68.4021, GNorm = 0.5882, lr_0 = 2.0562e-04
Validation auc = 0.859731
Validation accuracy = 0.897196
Validation prc-auc = 0.943542
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 18
Loss = 1.9893e-01, PNorm = 68.4162, GNorm = 0.3192, lr_0 = 2.0195e-04
Validation auc = 0.856108
Validation accuracy = 0.897196
Validation prc-auc = 0.941317
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 19
Loss = 2.0647e-01, PNorm = 68.4324, GNorm = 0.4009, lr_0 = 1.9800e-04
Validation auc = 0.859731
Validation accuracy = 0.897196
Validation prc-auc = 0.943165
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 20
Loss = 1.9221e-01, PNorm = 68.4498, GNorm = 0.8372, lr_0 = 1.9446e-04
Validation auc = 0.860766
Validation accuracy = 0.915888
Validation prc-auc = 0.944500
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 21
Loss = 1.7867e-01, PNorm = 68.4660, GNorm = 0.9727, lr_0 = 1.9099e-04
Validation auc = 0.858696
Validation accuracy = 0.897196
Validation prc-auc = 0.943941
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 22
Loss = 1.7926e-01, PNorm = 68.4825, GNorm = 0.8271, lr_0 = 1.8725e-04
Validation auc = 0.858696
Validation accuracy = 0.897196
Validation prc-auc = 0.943610
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 23
Loss = 1.8029e-01, PNorm = 68.4967, GNorm = 2.4073, lr_0 = 1.8391e-04
Loss = 2.0838e-01, PNorm = 68.4981, GNorm = 0.3935, lr_0 = 1.8358e-04
Validation auc = 0.863354
Validation accuracy = 0.897196
Validation prc-auc = 0.945610
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 24
Loss = 1.9707e-01, PNorm = 68.5134, GNorm = 1.6678, lr_0 = 1.8030e-04
Validation auc = 0.861284
Validation accuracy = 0.915888
Validation prc-auc = 0.945521
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 25
Loss = 1.8211e-01, PNorm = 68.5275, GNorm = 0.8677, lr_0 = 1.7709e-04
Validation auc = 0.860766
Validation accuracy = 0.897196
Validation prc-auc = 0.944449
Validation f1 = 0.934911
Validation mcc = 0.690781
Epoch 26
Validation auc = 0.857660
Validation accuracy = 0.906542
Validation prc-auc = 0.945065
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 27
Loss = 1.3823e-01, PNorm = 68.5465, GNorm = 0.2331, lr_0 = 1.7424e-04
Validation auc = 0.859213
Validation accuracy = 0.897196
Validation prc-auc = 0.944300
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 28
Loss = 2.0082e-01, PNorm = 68.5630, GNorm = 0.3598, lr_0 = 1.7424e-04
Validation auc = 0.855590
Validation accuracy = 0.915888
Validation prc-auc = 0.944476
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 29
Loss = 1.6333e-01, PNorm = 68.5821, GNorm = 1.8546, lr_0 = 1.7424e-04
Validation auc = 0.859731
Validation accuracy = 0.897196
Validation prc-auc = 0.944502
Validation f1 = 0.936416
Validation mcc = 0.676982
Model 1 best validation auc = 0.863872 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.989771
Model 1 test accuracy = 0.958333
Model 1 test prc-auc = 0.997104
Model 1 test f1 = 0.974093
Model 1 test mcc = 0.875728
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.866977
Validation accuracy = 0.925234
Validation prc-auc = 0.945319
Validation f1 = 0.954545
Validation mcc = 0.771663
Epoch 1
Loss = 2.3959e-01, PNorm = 67.3914, GNorm = 0.3373, lr_0 = 1.1868e-03
Validation auc = 0.862836
Validation accuracy = 0.831776
Validation prc-auc = 0.943724
Validation f1 = 0.890244
Validation mcc = 0.534065
Epoch 2
Loss = 3.2176e-01, PNorm = 67.9477, GNorm = 0.4567, lr_0 = 8.0296e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.944399
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 3
Loss = 2.8240e-01, PNorm = 68.1179, GNorm = 0.4007, lr_0 = 3.8068e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.944444
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 4
Loss = 2.7397e-01, PNorm = 68.1521, GNorm = 0.3914, lr_0 = 2.6218e-04
Validation auc = 0.862319
Validation accuracy = 0.897196
Validation prc-auc = 0.943882
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 5
Loss = 2.5627e-01, PNorm = 68.1696, GNorm = 0.3202, lr_0 = 2.5751e-04
Validation auc = 0.863354
Validation accuracy = 0.906542
Validation prc-auc = 0.944502
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 6
Loss = 2.2260e-01, PNorm = 68.1847, GNorm = 0.2243, lr_0 = 2.5246e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.943156
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 7
Loss = 1.9572e-01, PNorm = 68.1986, GNorm = 0.2558, lr_0 = 2.4795e-04
Validation auc = 0.862319
Validation accuracy = 0.897196
Validation prc-auc = 0.942225
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 8
Loss = 2.4714e-01, PNorm = 68.2144, GNorm = 0.2352, lr_0 = 2.4309e-04
Validation auc = 0.863872
Validation accuracy = 0.906542
Validation prc-auc = 0.944682
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 9
Loss = 2.5016e-01, PNorm = 68.2302, GNorm = 0.2116, lr_0 = 2.3876e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.944550
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 10
Loss = 2.2921e-01, PNorm = 68.2463, GNorm = 0.3064, lr_0 = 2.3450e-04
Validation auc = 0.860248
Validation accuracy = 0.906542
Validation prc-auc = 0.941911
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 11
Loss = 2.1424e-01, PNorm = 68.2660, GNorm = 0.2648, lr_0 = 2.2990e-04
Validation auc = 0.861284
Validation accuracy = 0.897196
Validation prc-auc = 0.942322
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 12
Loss = 2.0651e-01, PNorm = 68.2856, GNorm = 0.2573, lr_0 = 2.2580e-04
Validation auc = 0.858696
Validation accuracy = 0.897196
Validation prc-auc = 0.939793
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 13
Loss = 1.9722e-01, PNorm = 68.3051, GNorm = 0.7613, lr_0 = 2.2177e-04
Validation auc = 0.860766
Validation accuracy = 0.887850
Validation prc-auc = 0.941289
Validation f1 = 0.930233
Validation mcc = 0.649862
Epoch 14
Loss = 1.9565e-01, PNorm = 68.3244, GNorm = 0.3509, lr_0 = 2.1742e-04
Validation auc = 0.862836
Validation accuracy = 0.897196
Validation prc-auc = 0.942495
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 15
Loss = 1.9061e-01, PNorm = 68.3456, GNorm = 0.3045, lr_0 = 2.1354e-04
Validation auc = 0.863872
Validation accuracy = 0.897196
Validation prc-auc = 0.942564
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 16
Loss = 2.0070e-01, PNorm = 68.3684, GNorm = 0.3847, lr_0 = 2.0936e-04
Validation auc = 0.860766
Validation accuracy = 0.906542
Validation prc-auc = 0.939997
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 17
Loss = 2.0485e-01, PNorm = 68.3882, GNorm = 0.4951, lr_0 = 2.0562e-04
Validation auc = 0.864389
Validation accuracy = 0.915888
Validation prc-auc = 0.943507
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 18
Loss = 1.7459e-01, PNorm = 68.4069, GNorm = 0.8114, lr_0 = 2.0195e-04
Validation auc = 0.859731
Validation accuracy = 0.897196
Validation prc-auc = 0.941893
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 19
Loss = 1.8865e-01, PNorm = 68.4278, GNorm = 1.0702, lr_0 = 1.9800e-04
Validation auc = 0.867495
Validation accuracy = 0.915888
Validation prc-auc = 0.945531
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 20
Loss = 1.8117e-01, PNorm = 68.4498, GNorm = 0.3636, lr_0 = 1.9446e-04
Validation auc = 0.865424
Validation accuracy = 0.897196
Validation prc-auc = 0.943815
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 21
Loss = 1.9049e-01, PNorm = 68.4733, GNorm = 0.2506, lr_0 = 1.9099e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.943405
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 22
Loss = 1.8742e-01, PNorm = 68.4976, GNorm = 0.5749, lr_0 = 1.8725e-04
Validation auc = 0.860248
Validation accuracy = 0.897196
Validation prc-auc = 0.943629
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 23
Loss = 1.8399e-01, PNorm = 68.5191, GNorm = 0.6933, lr_0 = 1.8391e-04
Loss = 1.4215e-01, PNorm = 68.5212, GNorm = 0.3293, lr_0 = 1.8358e-04
Validation auc = 0.861284
Validation accuracy = 0.897196
Validation prc-auc = 0.942823
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 24
Loss = 1.8054e-01, PNorm = 68.5419, GNorm = 0.5981, lr_0 = 1.8030e-04
Validation auc = 0.864389
Validation accuracy = 0.915888
Validation prc-auc = 0.945066
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 25
Loss = 1.9063e-01, PNorm = 68.5638, GNorm = 3.2390, lr_0 = 1.7709e-04
Validation auc = 0.866460
Validation accuracy = 0.915888
Validation prc-auc = 0.947020
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 26
Validation auc = 0.862319
Validation accuracy = 0.897196
Validation prc-auc = 0.944637
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 27
Loss = 1.3682e-01, PNorm = 68.5851, GNorm = 1.0501, lr_0 = 1.7424e-04
Validation auc = 0.861284
Validation accuracy = 0.897196
Validation prc-auc = 0.944611
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 28
Loss = 1.4997e-01, PNorm = 68.6070, GNorm = 0.9928, lr_0 = 1.7424e-04
Validation auc = 0.862836
Validation accuracy = 0.906542
Validation prc-auc = 0.945723
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 29
Loss = 1.8087e-01, PNorm = 68.6325, GNorm = 0.4756, lr_0 = 1.7424e-04
Validation auc = 0.865942
Validation accuracy = 0.906542
Validation prc-auc = 0.947770
Validation f1 = 0.942529
Validation mcc = 0.706105
Model 2 best validation auc = 0.867495 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.985679
Model 2 test accuracy = 0.950000
Model 2 test prc-auc = 0.995704
Model 2 test f1 = 0.969072
Model 2 test mcc = 0.850339
Building model 3
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.860766
Validation accuracy = 0.906542
Validation prc-auc = 0.946298
Validation f1 = 0.943820
Validation mcc = 0.710695
Epoch 1
Loss = 2.5342e-01, PNorm = 67.4883, GNorm = 0.2939, lr_0 = 1.1868e-03
Validation auc = 0.860248
Validation accuracy = 0.887850
Validation prc-auc = 0.944862
Validation f1 = 0.929412
Validation mcc = 0.657945
Epoch 2
Loss = 2.7586e-01, PNorm = 68.0462, GNorm = 0.4991, lr_0 = 8.0296e-04
Validation auc = 0.857143
Validation accuracy = 0.906542
Validation prc-auc = 0.943293
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 3
Loss = 2.6493e-01, PNorm = 68.2164, GNorm = 0.3100, lr_0 = 3.8068e-04
Validation auc = 0.856625
Validation accuracy = 0.906542
Validation prc-auc = 0.943426
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 4
Loss = 2.4168e-01, PNorm = 68.2491, GNorm = 0.2368, lr_0 = 2.6218e-04
Validation auc = 0.856625
Validation accuracy = 0.897196
Validation prc-auc = 0.943668
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 5
Loss = 2.4052e-01, PNorm = 68.2662, GNorm = 0.4528, lr_0 = 2.5751e-04
Validation auc = 0.858696
Validation accuracy = 0.906542
Validation prc-auc = 0.944722
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 6
Loss = 2.1218e-01, PNorm = 68.2804, GNorm = 0.2032, lr_0 = 2.5246e-04
Validation auc = 0.857660
Validation accuracy = 0.897196
Validation prc-auc = 0.944011
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 7
Loss = 2.2595e-01, PNorm = 68.2929, GNorm = 0.2968, lr_0 = 2.4795e-04
Validation auc = 0.857143
Validation accuracy = 0.906542
Validation prc-auc = 0.943920
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 8
Loss = 2.6256e-01, PNorm = 68.3080, GNorm = 0.2521, lr_0 = 2.4309e-04
Validation auc = 0.855590
Validation accuracy = 0.897196
Validation prc-auc = 0.942056
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 9
Loss = 2.4477e-01, PNorm = 68.3217, GNorm = 0.2349, lr_0 = 2.3876e-04
Validation auc = 0.856108
Validation accuracy = 0.906542
Validation prc-auc = 0.941321
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 10
Loss = 2.5591e-01, PNorm = 68.3352, GNorm = 0.3370, lr_0 = 2.3450e-04
Validation auc = 0.859213
Validation accuracy = 0.915888
Validation prc-auc = 0.941625
Validation f1 = 0.947977
Validation mcc = 0.737802
Epoch 11
Loss = 2.3269e-01, PNorm = 68.3531, GNorm = 0.5429, lr_0 = 2.2990e-04
Validation auc = 0.856108
Validation accuracy = 0.897196
Validation prc-auc = 0.939172
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 12
Loss = 2.0045e-01, PNorm = 68.3697, GNorm = 0.6029, lr_0 = 2.2580e-04
Validation auc = 0.855072
Validation accuracy = 0.887850
Validation prc-auc = 0.938128
Validation f1 = 0.929412
Validation mcc = 0.657945
Epoch 13
Loss = 2.3243e-01, PNorm = 68.3825, GNorm = 0.2596, lr_0 = 2.2177e-04
Validation auc = 0.856108
Validation accuracy = 0.897196
Validation prc-auc = 0.942161
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 14
Loss = 1.9301e-01, PNorm = 68.3979, GNorm = 0.2838, lr_0 = 2.1742e-04
Validation auc = 0.856108
Validation accuracy = 0.897196
Validation prc-auc = 0.941340
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 15
Loss = 2.0805e-01, PNorm = 68.4146, GNorm = 1.1848, lr_0 = 2.1354e-04
Validation auc = 0.855072
Validation accuracy = 0.915888
Validation prc-auc = 0.941062
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 16
Loss = 2.2779e-01, PNorm = 68.4317, GNorm = 1.0562, lr_0 = 2.0936e-04
Validation auc = 0.849896
Validation accuracy = 0.897196
Validation prc-auc = 0.938620
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 17
Loss = 2.0774e-01, PNorm = 68.4498, GNorm = 0.3920, lr_0 = 2.0562e-04
Validation auc = 0.849379
Validation accuracy = 0.897196
Validation prc-auc = 0.939326
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 18
Loss = 2.1112e-01, PNorm = 68.4686, GNorm = 0.4977, lr_0 = 2.0195e-04
Validation auc = 0.850932
Validation accuracy = 0.897196
Validation prc-auc = 0.939260
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 19
Loss = 1.9239e-01, PNorm = 68.4879, GNorm = 0.2963, lr_0 = 1.9800e-04
Validation auc = 0.853520
Validation accuracy = 0.906542
Validation prc-auc = 0.940810
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 20
Loss = 2.0330e-01, PNorm = 68.5029, GNorm = 0.6334, lr_0 = 1.9446e-04
Validation auc = 0.855072
Validation accuracy = 0.906542
Validation prc-auc = 0.942777
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 21
Loss = 1.9240e-01, PNorm = 68.5192, GNorm = 0.4022, lr_0 = 1.9099e-04
Validation auc = 0.848344
Validation accuracy = 0.897196
Validation prc-auc = 0.938776
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 22
Loss = 1.9254e-01, PNorm = 68.5400, GNorm = 1.2143, lr_0 = 1.8725e-04
Validation auc = 0.851449
Validation accuracy = 0.897196
Validation prc-auc = 0.939959
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 23
Loss = 1.8594e-01, PNorm = 68.5572, GNorm = 0.9671, lr_0 = 1.8391e-04
Loss = 1.8691e-01, PNorm = 68.5588, GNorm = 0.3342, lr_0 = 1.8358e-04
Validation auc = 0.851449
Validation accuracy = 0.915888
Validation prc-auc = 0.941036
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 24
Loss = 1.8872e-01, PNorm = 68.5760, GNorm = 1.2301, lr_0 = 1.8030e-04
Validation auc = 0.851449
Validation accuracy = 0.897196
Validation prc-auc = 0.940138
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 25
Loss = 1.8613e-01, PNorm = 68.5927, GNorm = 0.6914, lr_0 = 1.7709e-04
Validation auc = 0.848344
Validation accuracy = 0.897196
Validation prc-auc = 0.939921
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 26
Validation auc = 0.843685
Validation accuracy = 0.897196
Validation prc-auc = 0.937895
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 27
Loss = 1.6107e-01, PNorm = 68.6137, GNorm = 0.2813, lr_0 = 1.7424e-04
Validation auc = 0.845238
Validation accuracy = 0.897196
Validation prc-auc = 0.937976
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 28
Loss = 1.9901e-01, PNorm = 68.6300, GNorm = 0.6117, lr_0 = 1.7424e-04
Validation auc = 0.851967
Validation accuracy = 0.906542
Validation prc-auc = 0.942324
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 29
Loss = 1.7168e-01, PNorm = 68.6469, GNorm = 0.8072, lr_0 = 1.7424e-04
Validation auc = 0.851967
Validation accuracy = 0.906542
Validation prc-auc = 0.942536
Validation f1 = 0.942529
Validation mcc = 0.706105
Model 3 best validation auc = 0.860766 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 3 test auc = 0.986498
Model 3 test accuracy = 0.933333
Model 3 test prc-auc = 0.996126
Model 3 test f1 = 0.959184
Model 3 test mcc = 0.798755
Building model 4
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.25, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=1300, bias=False)
        (W_h): Linear(in_features=1300, out_features=1300, bias=False)
        (W_o): Linear(in_features=1433, out_features=1300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.25, inplace=False)
    (1): Linear(in_features=1500, out_features=1400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.25, inplace=False)
    (4): Linear(in_features=1400, out_features=1, bias=True)
  )
)
Number of parameters = 5,849,401
Moving model to cuda
Epoch 0
Validation auc = 0.868012
Validation accuracy = 0.915888
Validation prc-auc = 0.945340
Validation f1 = 0.949153
Validation mcc = 0.741478
Epoch 1
Loss = 2.7284e-01, PNorm = 67.4155, GNorm = 0.3085, lr_0 = 1.1868e-03
Validation auc = 0.867495
Validation accuracy = 0.897196
Validation prc-auc = 0.945546
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 2
Loss = 2.3151e-01, PNorm = 67.9748, GNorm = 0.2345, lr_0 = 8.0296e-04
Validation auc = 0.864389
Validation accuracy = 0.906542
Validation prc-auc = 0.945252
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 3
Loss = 2.1469e-01, PNorm = 68.1478, GNorm = 0.2139, lr_0 = 3.8068e-04
Validation auc = 0.862836
Validation accuracy = 0.906542
Validation prc-auc = 0.944822
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 4
Loss = 2.6134e-01, PNorm = 68.1821, GNorm = 0.2583, lr_0 = 2.6218e-04
Validation auc = 0.863872
Validation accuracy = 0.897196
Validation prc-auc = 0.945729
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 5
Loss = 2.0995e-01, PNorm = 68.2003, GNorm = 0.2260, lr_0 = 2.5751e-04
Validation auc = 0.862319
Validation accuracy = 0.906542
Validation prc-auc = 0.945321
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 6
Loss = 2.5368e-01, PNorm = 68.2163, GNorm = 0.2607, lr_0 = 2.5246e-04
Validation auc = 0.865424
Validation accuracy = 0.906542
Validation prc-auc = 0.946574
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 7
Loss = 2.1244e-01, PNorm = 68.2298, GNorm = 0.3067, lr_0 = 2.4795e-04
Validation auc = 0.859731
Validation accuracy = 0.906542
Validation prc-auc = 0.942794
Validation f1 = 0.941176
Validation mcc = 0.715227
Epoch 8
Loss = 2.6174e-01, PNorm = 68.2478, GNorm = 0.3566, lr_0 = 2.4309e-04
Validation auc = 0.864907
Validation accuracy = 0.915888
Validation prc-auc = 0.944226
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 9
Loss = 2.1277e-01, PNorm = 68.2624, GNorm = 0.2794, lr_0 = 2.3876e-04
Validation auc = 0.864389
Validation accuracy = 0.897196
Validation prc-auc = 0.943078
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 10
Loss = 2.4200e-01, PNorm = 68.2751, GNorm = 0.3122, lr_0 = 2.3450e-04
Validation auc = 0.862319
Validation accuracy = 0.897196
Validation prc-auc = 0.942703
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 11
Loss = 2.1107e-01, PNorm = 68.2916, GNorm = 0.4107, lr_0 = 2.2990e-04
Validation auc = 0.857660
Validation accuracy = 0.887850
Validation prc-auc = 0.940467
Validation f1 = 0.930233
Validation mcc = 0.649862
Epoch 12
Loss = 2.1973e-01, PNorm = 68.3078, GNorm = 0.8331, lr_0 = 2.2580e-04
Validation auc = 0.856625
Validation accuracy = 0.897196
Validation prc-auc = 0.937848
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 13
Loss = 2.3676e-01, PNorm = 68.3240, GNorm = 0.4654, lr_0 = 2.2177e-04
Validation auc = 0.863354
Validation accuracy = 0.915888
Validation prc-auc = 0.939079
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 14
Loss = 2.1124e-01, PNorm = 68.3389, GNorm = 0.4999, lr_0 = 2.1742e-04
Validation auc = 0.859731
Validation accuracy = 0.897196
Validation prc-auc = 0.939779
Validation f1 = 0.934911
Validation mcc = 0.690781
Epoch 15
Loss = 1.9495e-01, PNorm = 68.3536, GNorm = 0.7729, lr_0 = 2.1354e-04
Validation auc = 0.860248
Validation accuracy = 0.897196
Validation prc-auc = 0.942139
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 16
Loss = 2.1942e-01, PNorm = 68.3668, GNorm = 0.2087, lr_0 = 2.0936e-04
Validation auc = 0.863872
Validation accuracy = 0.915888
Validation prc-auc = 0.944920
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 17
Loss = 2.1073e-01, PNorm = 68.3826, GNorm = 0.2968, lr_0 = 2.0562e-04
Validation auc = 0.860766
Validation accuracy = 0.897196
Validation prc-auc = 0.942874
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 18
Loss = 2.0163e-01, PNorm = 68.3991, GNorm = 0.2929, lr_0 = 2.0195e-04
Validation auc = 0.861284
Validation accuracy = 0.897196
Validation prc-auc = 0.944509
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 19
Loss = 1.9818e-01, PNorm = 68.4181, GNorm = 1.5718, lr_0 = 1.9800e-04
Validation auc = 0.859731
Validation accuracy = 0.897196
Validation prc-auc = 0.944220
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 20
Loss = 1.9744e-01, PNorm = 68.4318, GNorm = 0.2336, lr_0 = 1.9446e-04
Validation auc = 0.856625
Validation accuracy = 0.897196
Validation prc-auc = 0.940481
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 21
Loss = 2.0440e-01, PNorm = 68.4460, GNorm = 0.2958, lr_0 = 1.9099e-04
Validation auc = 0.866977
Validation accuracy = 0.915888
Validation prc-auc = 0.946695
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 22
Loss = 1.8649e-01, PNorm = 68.4634, GNorm = 0.2998, lr_0 = 1.8725e-04
Validation auc = 0.861284
Validation accuracy = 0.906542
Validation prc-auc = 0.942947
Validation f1 = 0.941860
Validation mcc = 0.709396
Epoch 23
Loss = 1.7271e-01, PNorm = 68.4800, GNorm = 0.8362, lr_0 = 1.8391e-04
Loss = 3.3649e-01, PNorm = 68.4816, GNorm = 0.6092, lr_0 = 1.8358e-04
Validation auc = 0.861801
Validation accuracy = 0.906542
Validation prc-auc = 0.944018
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 24
Loss = 1.8267e-01, PNorm = 68.4987, GNorm = 1.0983, lr_0 = 1.8030e-04
Validation auc = 0.860248
Validation accuracy = 0.906542
Validation prc-auc = 0.944195
Validation f1 = 0.942529
Validation mcc = 0.706105
Epoch 25
Loss = 1.7338e-01, PNorm = 68.5148, GNorm = 0.4400, lr_0 = 1.7709e-04
Validation auc = 0.857143
Validation accuracy = 0.897196
Validation prc-auc = 0.942762
Validation f1 = 0.936416
Validation mcc = 0.676982
Epoch 26
Validation auc = 0.861801
Validation accuracy = 0.915888
Validation prc-auc = 0.946107
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 27
Loss = 1.3055e-01, PNorm = 68.5337, GNorm = 0.4908, lr_0 = 1.7424e-04
Validation auc = 0.857143
Validation accuracy = 0.897196
Validation prc-auc = 0.942862
Validation f1 = 0.935673
Validation mcc = 0.682851
Epoch 28
Loss = 2.6693e-01, PNorm = 68.5498, GNorm = 0.5743, lr_0 = 1.7424e-04
Validation auc = 0.858696
Validation accuracy = 0.915888
Validation prc-auc = 0.945269
Validation f1 = 0.948571
Validation mcc = 0.737540
Epoch 29
Loss = 1.9817e-01, PNorm = 68.5680, GNorm = 0.5400, lr_0 = 1.7424e-04
Validation auc = 0.862836
Validation accuracy = 0.906542
Validation prc-auc = 0.945471
Validation f1 = 0.942529
Validation mcc = 0.706105
Model 4 best validation auc = 0.868012 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 4 test auc = 0.983224
Model 4 test accuracy = 0.958333
Model 4 test prc-auc = 0.995046
Model 4 test f1 = 0.974093
Model 4 test mcc = 0.875728
Ensemble test auc = 0.988543
Ensemble test accuracy = 0.958333
Ensemble test prc-auc = 0.996707
Ensemble test f1 = 0.974093
Ensemble test mcc = 0.875728
10-fold cross validation
	Seed 0 ==> test auc = 0.990998
	Seed 0 ==> test accuracy = 0.975000
	Seed 0 ==> test prc-auc = 0.997411
	Seed 0 ==> test f1 = 0.984293
	Seed 0 ==> test mcc = 0.925881
	Seed 1 ==> test auc = 0.988953
	Seed 1 ==> test accuracy = 0.958333
	Seed 1 ==> test prc-auc = 0.996767
	Seed 1 ==> test f1 = 0.974093
	Seed 1 ==> test mcc = 0.875728
	Seed 2 ==> test auc = 0.991408
	Seed 2 ==> test accuracy = 0.958333
	Seed 2 ==> test prc-auc = 0.997534
	Seed 2 ==> test f1 = 0.974093
	Seed 2 ==> test mcc = 0.875728
	Seed 3 ==> test auc = 0.987316
	Seed 3 ==> test accuracy = 0.966667
	Seed 3 ==> test prc-auc = 0.996238
	Seed 3 ==> test f1 = 0.979167
	Seed 3 ==> test mcc = 0.900898
	Seed 4 ==> test auc = 0.992226
	Seed 4 ==> test accuracy = 0.966667
	Seed 4 ==> test prc-auc = 0.997775
	Seed 4 ==> test f1 = 0.979167
	Seed 4 ==> test mcc = 0.900898
	Seed 5 ==> test auc = 0.990589
	Seed 5 ==> test accuracy = 0.958333
	Seed 5 ==> test prc-auc = 0.997283
	Seed 5 ==> test f1 = 0.974093
	Seed 5 ==> test mcc = 0.875728
	Seed 6 ==> test auc = 0.990998
	Seed 6 ==> test accuracy = 0.975000
	Seed 6 ==> test prc-auc = 0.997411
	Seed 6 ==> test f1 = 0.984293
	Seed 6 ==> test mcc = 0.925881
	Seed 7 ==> test auc = 0.990589
	Seed 7 ==> test accuracy = 0.966667
	Seed 7 ==> test prc-auc = 0.997283
	Seed 7 ==> test f1 = 0.979167
	Seed 7 ==> test mcc = 0.900898
	Seed 8 ==> test auc = 0.990998
	Seed 8 ==> test accuracy = 0.958333
	Seed 8 ==> test prc-auc = 0.997420
	Seed 8 ==> test f1 = 0.974093
	Seed 8 ==> test mcc = 0.875728
	Seed 9 ==> test auc = 0.988543
	Seed 9 ==> test accuracy = 0.958333
	Seed 9 ==> test prc-auc = 0.996707
	Seed 9 ==> test f1 = 0.974093
	Seed 9 ==> test mcc = 0.875728
Overall test auc = 0.990262 +/- 0.001427
Overall test accuracy = 0.964167 +/- 0.006509
Overall test prc-auc = 0.997183 +/- 0.000441
Overall test f1 = 0.977655 +/- 0.003980
Overall test mcc = 0.893310 +/- 0.019596
Elapsed time = 1:45:36
